

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials &mdash; pyaerocom  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="About" href="readme.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyaerocom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#aerocom">AeroCom</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#website-and-code-documentation">Website and code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#installation-of-pyaerocom">Installation of pyaerocom</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#access-to-users-database">Access to users database</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#getting-started">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pyaerocom-api-flowchart">Pyaerocom API flowchart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#check-data-directory">Check data directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes">Reading of and working with <em>gridded</em> model data (<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> classes)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#find-model-data">Find model data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initiate-reader-class-for-the-present-day-pd-dataset">Initiate reader class for the present day (PD) dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-aerosol-optical-depth-at-550-nm">Read Aerosol optical depth at 550 nm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview-of-what-is-in-the-data">Overview of what is in the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-time-stamps">Access time stamps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting-maps">Plotting maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering">Filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-of-time">Filtering of time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-aggregation">Data aggregation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes">Reading of and working with ungridded data (<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> and <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> classes)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#caching-of-ungriddeddata">Caching of UngriddedData</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-aeronet-sun-v3-level-2-data">Read Aeronet Sun v3 level 2 data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-all-station-coordinates">Plot all station coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-of-individual-stations">Access of individual stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#you-can-also-plot-the-time-series-directly">You can also plot the time-series directly</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#colocation-of-model-and-obsdata">Colocation of model and obsdata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#colocation-with-satellite-aods-from-modis">Colocation with satellite AODs from MODIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remark-on-the-colocateddata-object">Remark on the ColocatedData object</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aerocom-default-regions-class-region">AEROCOM default regions (class <code class="docutils literal notranslate"><span class="pre">Region</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-regions-are-available">What regions are available</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-region">Create a <code class="docutils literal notranslate"><span class="pre">Region</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-example-data-and-apply-region-specific-crop">Load example data and apply region specific crop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#computing-distance-to-centre-of-region">Computing distance to centre of region</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-of-gridded-data-the-readgridded-class">Reading of gridded data - the <em>ReadGridded</em> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-reading-of-gridded-data">Remark on reading of gridded data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-instance-of-readgridded-class">Create instance of <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#other-options-for-reading">Other options for reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remark-on-time-definition">Remark on time definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-very-brief-introduction-into-the-griddeddata-class">A very brief introduction into the GriddedData class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-timeseries">Plot timeseries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-griddeddata-class">The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#read-ecmwf-osuite-aod-data">Read ECMWF OSUITE AOD data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-longitude-definition">Remark on longitude definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-attributes-of-the-griddeddata-class">Basic attributes of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apply-custom-crop-and-plot">Apply custom crop and plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="#change-resolution">Change resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#area-weighted-mean">Area weighted mean</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#more-to-come">… more to come</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-of-ungridded-observation-datasets-in-pyaerocom">Reading of ungridded observation datasets in pyaerocom</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primer-on-observation-datasets">Primer on observation datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-access">Data access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#note"><strong>NOTE</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#if-you-run-into-problems">If you run into problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-of-and-investigating-aeronet-sun-aods-version-3-level-2-data">Reading of and investigating Aeronet Sun AODs (version 3, level 2 data)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-data-id-for-aeronet-sun-version-2-level-2-daily-data">Search data ID for Aeronet Sun version 2 level 2, daily data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pick-one-or-more-variable-s-of-interest">Pick one (or more) variable(s) of interest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-the-aods-from-the-whole-database-all-available-stations-times-using-the-readungridded-class">Read the AODs from the whole database (all available stations / times) using the ReadUngridded class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-instance-of-readungridded-class">Create instance of ReadUngridded class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-the-dataset">Read the dataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-into-the-ungriddeddata-class-and-the-stationdata-class">Introduction into the UngriddedData class and the StationData class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">NOTE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-ungriddeddata-object">The <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#import-the-ungriddeddata-object-that-was-created-in-the-previous-tutorial">Import the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object that was created in the previous tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-an-overview-map-of-all-stations">Create an overview map of all stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quicklook-plotting-of-station-timeseries">Quicklook plotting of station timeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-metadata-of-the-data-files-that-were-read">Access metadata of the data files that were read</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-of-the-data">Filtering of the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-attributes-that-may-be-useful">Other attributes that may be useful</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-of-unique-station-names">List of unique station names</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stationdata-access-the-data-from-individual-stations"><code class="docutils literal notranslate"><span class="pre">StationData</span></code>: Access the data from individual stations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#option-1-get-station-data-using-the-corresponding-metadata-indices-that-match-the-station-name">Option 1. Get station data using the corresponding metadata indices that match the station name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#option-2-retrieve-station-data-using-the-station-name-directly">Option 2: Retrieve station data using the station name directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="#option-3-use-notation">Option 3: Use […] notation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lets-have-a-look-if-the-data-objects-are-really-the-same-by-plotting-the-aod-timeseries-for-the-4-different-options">Let’s have a look if the data objects are really the same (by plotting the AOD timeseries for the 4 different options):</a></li>
<li class="toctree-l4"><a class="reference internal" href="#small-detour-through-the-pandas-world">Small detour through the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> world</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting-of-timeseries-data-directly-from-stationdata-class">Plotting of timeseries data directly from StationData class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computing-trends-from-station-data">Computing trends from station data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#colocation-of-model-data-with-observations">Colocation of model data with observations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-setup-and-imports">Import setup and imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-model-data">Import of model data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-aeronet-sun-v3-data-level-2">Import of AeroNet Sun V3 data (Level 2)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot-station-coordinates">Plot station coordinates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#perform-colocation-and-plot-corresponding-scatter-plots-with-statistical-values">Perform colocation and plot corresponding scatter plots with statistical values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#monthly-world-no-mountains">2010 monthly World no mountains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-colocation">Time colocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daily-europe-no-mountains">2010 daily Europe no mountains</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#satellite-colocation">Satellite colocation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#no-daily-time-colocation">No (daily) time colocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#with-daily-time-colocation">With (daily) time colocation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#short-tutorial-showing-how-trends-can-be-computed-within-pyaerocom">Short tutorial showing how trends can be computed within pyaerocom</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-tutorials">Further tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#handling-of-time-in-pyaerocom">Handling of time in pyaerocom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-and-some-example-data">Load and some example data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#digging-into-the-time-representation-of-the-iris-cube-datatype">Digging into the time representation of the iris Cube datatype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files">Tutorial showing how to read EBAS NASA Ames files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-array">Data array</a></li>
<li class="toctree-l4"><a class="reference internal" href="#column-information">Column information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-flag-information">Access flag information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convert-object-to-pandas-dataframe">Convert object to pandas Dataframe</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ebas-file-query-and-database-browser">EBAS file query and database browser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specifying-a-request">Specifying a request</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-of-file-request-query">Execution of file request query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#browsing-the-database">Browsing the database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#custom-browsing">Custom browsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-all-files">Read all files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#merging-of-several-stationdata-objects-into-one">Merging of several StationData objects into one</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#get-list-of-all-files-containing-scattering-data-for-ebas-station-jungfraujoch">Get list of all files containing scattering data for EBAS station Jungfraujoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comment-for-convenience">Comment for convenience….</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-about-overlapping-data">What about overlapping data ??</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-prioritise-certain-stations-from-others-when-deciding-what-goes-into-overlap-and-what-into-the-final-timeseries">How to prioritise certain stations from others, when deciding what goes into overlap and what into the final timeseries?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_testsuite.html">Tests (for developers)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyaerocom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tutorials</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorials.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<p>In this section you can find example tutorial notebooks for pyaerocom.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tutorials are jupyter notebooks that were converted to restructured text.
You can find in all notebooks in the <a class="reference external" href="https://github.com/metno/pyaerocom-tutorials/tree/master/notebooks">pyaerocom-tutorials repository</a>.</p>
</div>
<div class="section" id="pyaerocom-api-flowchart">
<h2>Pyaerocom API flowchart<a class="headerlink" href="#pyaerocom-api-flowchart" title="Permalink to this headline">¶</a></h2>
<p>The following flowchart illustrates the minimal workflow to create standard output in pyaerocom based on a user query (that typically comprises a model ID and observation ID as well as one (or more) variable(s) of interest.</p>
<a class="reference internal image-reference" href="_images/pyaerocom_basic_flowchart.png"><img alt="_images/pyaerocom_basic_flowchart.png" class="align-center" src="_images/pyaerocom_basic_flowchart.png" style="width: 800px;" /></a>
<p>A user query typically comprises a model (+ experiment -&gt; model run) and an observation network, which are supposed to be compared.</p>
<p><strong>Note</strong>: the flowchart depicts a situation, where the data from the observation network is <em>ungridded</em>, that is, the data is not available in a gridded format such as NetCDF, but, for instance, in the form of column separated text files (as is the case for AERONET data, which is used as an example here and included in the test dataset).
For <cite>gridded</cite> observations (e.g. satellite data), the flowchart is equivalent but with <code class="xref py py-class docutils literal notranslate"><span class="pre">ReadGridded</span></code> class and <code class="xref py py-class docutils literal notranslate"><span class="pre">GriddedData</span></code> for the observation branch.</p>
<p>The following “Getting started” tutorial introduces the individual features displayed in the flowchart.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This notebook is meant to give a quick introduction into the main
features and workflows of
<a class="reference external" href="http://aerocom.met.no/pyaerocom/">pyaerocom</a>.</p>
<p>This includes brief introductions into the following features:</p>
<ul class="simple">
<li><p>Finding model and observation data on the AeroCom servers (method
<code class="docutils literal notranslate"><span class="pre">browse_database</span></code>).</p></li>
<li><p>Reading of <strong>gridded</strong> model data (<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class).</p></li>
<li><p>Reading of <strong>ungridded</strong> observation data (<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class).</p></li>
<li><p>Working with <strong>gridded</strong> data (<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class).</p></li>
<li><p>Working with <strong>ungridded</strong> data (<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class).</p></li>
<li><p>Retrieving and working with data from individual stations
(<code class="docutils literal notranslate"><span class="pre">StationData</span></code> class).</p></li>
<li><p><strong>Colocation</strong> of model data with all stations from an observation
network.</p></li>
</ul>
<p>It ends with a colocation of CAM53-Oslo model AODs both all-sky and
clear-sky with Aeronet Sun V3 level 2 data.</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>In order to run this notebook, you need to be connected to the
AeroCom post processing servers (PPI).</p></li>
<li><p>If you have PPI (/lustre/) mounted on your local machine you need to
update the basic data directory after importing pyaerocom as follows:
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pyaerocom</span> <span class="pre">as</span> <span class="pre">pya</span>&#160; <span class="pre">pya.const.BASEDIR</span> <span class="pre">=</span> <span class="pre">&lt;path_where_lustre_is_mounted&gt;</span></code></p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.018</span> <span class="n">s</span>
</pre></div>
</div>
<div class="section" id="check-data-directory">
<h4>Check data directory<a class="headerlink" href="#check-data-directory" title="Permalink to this headline">¶</a></h4>
<p>By default, pyaerocom assumes that the AEROCOM database can be accessed
(cf. top of flowchart), that is, it initiates all data query paths
relative to the database server path names.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">BASEDIR</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/lustre/storeA/project/aerocom&#39;</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Execution of the following lines will only work if you are
connected to the AEROCOM data server or if you have access to the
pyaerocom testdataset. The latter can be retrieved upon request (please
contact <a class="reference external" href="mailto:jonasg&#37;&#52;&#48;met&#46;no">jonasg<span>&#64;</span>met<span>&#46;</span>no</a>).</p>
</div>
</div>
<div class="section" id="reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes">
<h3>Reading of and working with <em>gridded</em> model data (<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> classes)<a class="headerlink" href="#reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes" title="Permalink to this headline">¶</a></h3>
<p>This section illustrates the reading of gridded data as well as some
features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class of <em>pyaerocom</em>. First, however, we
have to find a valid model ID for the reading (cf. flow chart).</p>
<div class="section" id="find-model-data">
<h4>Find model data<a class="headerlink" href="#find-model-data" title="Permalink to this headline">¶</a></h4>
<p>The database contains data from the CAM53-Oslo model, which is used in
the following. You can use the <code class="docutils literal notranslate"><span class="pre">browse_database</span></code> function of pyaerocom
to find model ID’s (which can be quite cryptic sometimes) using wildcard
pattern search.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;CAM53*-Oslo*UNTUNED*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PI_UNTUNED</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">NorESM_SVN_TEST</span><span class="o">/</span><span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PI_UNTUNED</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;UNTUNED&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs440aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;abs670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;airmass&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;asy3Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;bc5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;cheaqpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chegpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chepso2&#39;</span><span class="p">,</span> <span class="s1">&#39;cl3D&#39;</span><span class="p">,</span> <span class="s1">&#39;clt&#39;</span><span class="p">,</span> <span class="s1">&#39;drybc&#39;</span><span class="p">,</span> <span class="s1">&#39;drydms&#39;</span><span class="p">,</span> <span class="s1">&#39;drydust&#39;</span><span class="p">,</span> <span class="s1">&#39;dryoa&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso2&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso4&#39;</span><span class="p">,</span> <span class="s1">&#39;dryss&#39;</span><span class="p">,</span> <span class="s1">&#39;ec5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emioa&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;hus&#39;</span><span class="p">,</span> <span class="s1">&#39;landf&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddms&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso2&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;mmraerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrbc&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrdu&#39;</span><span class="p">,</span> <span class="s1">&#39;mmroa&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrso4&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrss&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;orog&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;rlds&#39;</span><span class="p">,</span> <span class="s1">&#39;rlus&#39;</span><span class="p">,</span> <span class="s1">&#39;rlut&#39;</span><span class="p">,</span> <span class="s1">&#39;rlutcs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsds&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdscs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdt&#39;</span><span class="p">,</span> <span class="s1">&#39;rsus&#39;</span><span class="p">,</span> <span class="s1">&#39;rsut&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdms&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrdms&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetbc&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdms&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdust&#39;</span><span class="p">,</span> <span class="s1">&#39;wetoa&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="s1">&#39;wetss&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">NorESM_SVN_TEST</span><span class="o">/</span><span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;UNTUNED&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs440aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;abs670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;airmass&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;asy3Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;bc5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;cheaqpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chegpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chepso2&#39;</span><span class="p">,</span> <span class="s1">&#39;cl3D&#39;</span><span class="p">,</span> <span class="s1">&#39;clt&#39;</span><span class="p">,</span> <span class="s1">&#39;drybc&#39;</span><span class="p">,</span> <span class="s1">&#39;drydms&#39;</span><span class="p">,</span> <span class="s1">&#39;drydust&#39;</span><span class="p">,</span> <span class="s1">&#39;dryoa&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso2&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso4&#39;</span><span class="p">,</span> <span class="s1">&#39;dryss&#39;</span><span class="p">,</span> <span class="s1">&#39;ec5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emioa&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;hus&#39;</span><span class="p">,</span> <span class="s1">&#39;landf&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddms&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso2&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;mmraerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrbc&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrdu&#39;</span><span class="p">,</span> <span class="s1">&#39;mmroa&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrso4&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrss&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;orog&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;rlds&#39;</span><span class="p">,</span> <span class="s1">&#39;rlus&#39;</span><span class="p">,</span> <span class="s1">&#39;rlut&#39;</span><span class="p">,</span> <span class="s1">&#39;rlutcs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsds&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdscs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdt&#39;</span><span class="p">,</span> <span class="s1">&#39;rsus&#39;</span><span class="p">,</span> <span class="s1">&#39;rsut&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdms&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrdms&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetbc&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdms&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdust&#39;</span><span class="p">,</span> <span class="s1">&#39;wetoa&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="s1">&#39;wetss&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="initiate-reader-class-for-the-present-day-pd-dataset">
<h4>Initiate reader class for the present day (PD) dataset<a class="headerlink" href="#initiate-reader-class-for-the-present-day-pd-dataset" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can have a look at the individual files and corresponding metadata
using the <code class="docutils literal notranslate"><span class="pre">file_info</span></code> attribute:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">file_info</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>345</td>
      <td>abs440aer</td>
      <td>2004</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>506</td>
      <td>abs440aer</td>
      <td>2005</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>340</td>
      <td>abs440aer</td>
      <td>2006</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>12</td>
      <td>abs440aer</td>
      <td>2007</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>685</td>
      <td>abs440aer</td>
      <td>2008</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>169</td>
      <td>wetss</td>
      <td>2007</td>
      <td>monthly</td>
      <td>Surface</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>213</td>
      <td>wetss</td>
      <td>2008</td>
      <td>monthly</td>
      <td>Surface</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>36</td>
      <td>wetss</td>
      <td>2009</td>
      <td>monthly</td>
      <td>Surface</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>129</td>
      <td>wetss</td>
      <td>2010</td>
      <td>monthly</td>
      <td>Surface</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>454</td>
      <td>wetss</td>
      <td>9999</td>
      <td>monthly</td>
      <td>Surface</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
  </tbody>
</table>
<p>808 rows × 11 columns</p>
</div><p>If this contains too much information (as is the case here), you can
also filter this attribute based on what you are interested in. E.g.:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">filter_files</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>199</td>
      <td>od550aer</td>
      <td>2004</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>414</td>
      <td>od550aer</td>
      <td>2005</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>44</td>
      <td>od550aer</td>
      <td>2006</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>333</td>
      <td>od550aer</td>
      <td>2007</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>46</td>
      <td>od550aer</td>
      <td>2008</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>679</td>
      <td>od550aer</td>
      <td>2009</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
    <tr>
      <td>352</td>
      <td>od550aer</td>
      <td>2010</td>
      <td>monthly</td>
      <td>Column</td>
      <td>CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_P...</td>
      <td>CAM53</td>
      <td>Oslo</td>
      <td>UNTUNED</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK...</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="read-aerosol-optical-depth-at-550-nm">
<h4>Read Aerosol optical depth at 550 nm<a class="headerlink" href="#read-aerosol-optical-depth-at-550-nm" title="Permalink to this headline">¶</a></h4>
<p>Import both clear-sky (<em>cs</em> in variable name) and all-sky data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">od550csaer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550csaer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both data objects are instances of class
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.griddeddata">GriddedData</a>
which is based on the
<a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">Cube</a>
class (<a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/index.html">iris
library</a>)
and features very similar functionality and more.</p>
<p>Some of these features are introduced below.</p>
</div>
<div class="section" id="overview-of-what-is-in-the-data">
<h4>Overview of what is in the data<a class="headerlink" href="#overview-of-what-is-in-the-data" title="Permalink to this headline">¶</a></h4>
<p>Simply print the object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">od550aer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pyaerocom.GriddedData: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
Grid data: Aerosol optical depth at 500nm / (1) (time: 84; latitude: 192; longitude: 288)
     Dimension coordinates:
          time                            x             -               -
          latitude                        -             x               -
          longitude                       -             -               x
     Attributes:
          Conventions: CF-1.0
          NCO: 4.3.7
          Version: $Name$
          case: 53OSLO_PD_UNTUNED
          computed: False
          concatenated: True
          data_id: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
          from_files: [&#39;/lustre/storeA/project/aerocom/aerocom2/NorESM_SVN_TEST/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550aer_Column_2004_monthly.nc&#39;,...
          history: Thu Feb  9 11:05:21 2017: ncatted -O -a units,od550aer,o,c,1 /projects/NS2345K/CAM-Oslo/DO_AEROCOM/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550aer_Column_2004_monthly.nc
Thu...
          host: hexagon-2
          initial_file: /work/shared/noresm/inputdata/atm/cam/inic/fv/cami-mam3_0000-01-01_0.9...
          logname: ihkarset
          nco_openmp_thread_number: 1
          outliers_removed: False
          reader: None
          region: None
          regridded: False
          revision_Id: $Id$
          source: CAM
          title: UNSET
          topography_file: /work/shared/noresm/inputdata/noresm-only/inputForNudging/ERA_f09f09_3...
          ts_type: monthly
          var_name_read: n/d
     Cell methods:
          mean: time
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pyaerocom.GriddedData: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
Grid data: Clear air Aerosol optical depth at 550nm / (1) (time: 84; latitude: 192; longitude: 288)
     Dimension coordinates:
          time                                      x             -               -
          latitude                                  -             x               -
          longitude                                 -             -               x
     Attributes:
          Conventions: CF-1.0
          NCO: 4.3.7
          Version: $Name$
          case: 53OSLO_PD_UNTUNED
          computed: False
          concatenated: True
          data_id: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
          from_files: [&#39;/lustre/storeA/project/aerocom/aerocom2/NorESM_SVN_TEST/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550csaer_Column_2004_monthly.nc&#39;,...
          history: Thu Feb  9 11:05:16 2017: ncatted -O -a units,od550csaer,o,c,1 /projects/NS2345K/CAM-Oslo/DO_AEROCOM/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550csaer_Column_2004_monthly.nc
Thu...
          host: hexagon-2
          initial_file: /work/shared/noresm/inputdata/atm/cam/inic/fv/cami-mam3_0000-01-01_0.9...
          logname: ihkarset
          nco_openmp_thread_number: 1
          outliers_removed: False
          reader: None
          region: None
          regridded: False
          revision_Id: $Id$
          source: CAM
          title: UNSET
          topography_file: /work/shared/noresm/inputdata/noresm-only/inputForNudging/ERA_f09f09_3...
          ts_type: monthly
          var_name_read: n/d
     Cell methods:
          mean: time
</pre></div>
</div>
</div>
<div class="section" id="access-time-stamps">
<h4>Access time stamps<a class="headerlink" href="#access-time-stamps" title="Permalink to this headline">¶</a></h4>
<p>Time stamps are represented as numerical values with respect to a
reference date and frequency, according to the CF conventions. They can
be accessed via the <code class="docutils literal notranslate"><span class="pre">time</span></code> attribute of the data class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DimCoord</span><span class="p">(</span><span class="n">array</span><span class="p">([</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">31.</span><span class="p">,</span>   <span class="mf">60.</span><span class="p">,</span>   <span class="mf">91.</span><span class="p">,</span>  <span class="mf">121.</span><span class="p">,</span>  <span class="mf">152.</span><span class="p">,</span>  <span class="mf">182.</span><span class="p">,</span>  <span class="mf">213.</span><span class="p">,</span>  <span class="mf">244.</span><span class="p">,</span>
        <span class="mf">274.</span><span class="p">,</span>  <span class="mf">305.</span><span class="p">,</span>  <span class="mf">335.</span><span class="p">,</span>  <span class="mf">366.</span><span class="p">,</span>  <span class="mf">397.</span><span class="p">,</span>  <span class="mf">425.</span><span class="p">,</span>  <span class="mf">456.</span><span class="p">,</span>  <span class="mf">486.</span><span class="p">,</span>  <span class="mf">517.</span><span class="p">,</span>
        <span class="mf">547.</span><span class="p">,</span>  <span class="mf">578.</span><span class="p">,</span>  <span class="mf">609.</span><span class="p">,</span>  <span class="mf">639.</span><span class="p">,</span>  <span class="mf">670.</span><span class="p">,</span>  <span class="mf">700.</span><span class="p">,</span>  <span class="mf">731.</span><span class="p">,</span>  <span class="mf">762.</span><span class="p">,</span>  <span class="mf">790.</span><span class="p">,</span>
        <span class="mf">821.</span><span class="p">,</span>  <span class="mf">851.</span><span class="p">,</span>  <span class="mf">882.</span><span class="p">,</span>  <span class="mf">912.</span><span class="p">,</span>  <span class="mf">943.</span><span class="p">,</span>  <span class="mf">974.</span><span class="p">,</span> <span class="mf">1004.</span><span class="p">,</span> <span class="mf">1035.</span><span class="p">,</span> <span class="mf">1065.</span><span class="p">,</span>
       <span class="mf">1096.</span><span class="p">,</span> <span class="mf">1127.</span><span class="p">,</span> <span class="mf">1155.</span><span class="p">,</span> <span class="mf">1186.</span><span class="p">,</span> <span class="mf">1216.</span><span class="p">,</span> <span class="mf">1247.</span><span class="p">,</span> <span class="mf">1277.</span><span class="p">,</span> <span class="mf">1308.</span><span class="p">,</span> <span class="mf">1339.</span><span class="p">,</span>
       <span class="mf">1369.</span><span class="p">,</span> <span class="mf">1400.</span><span class="p">,</span> <span class="mf">1430.</span><span class="p">,</span> <span class="mf">1461.</span><span class="p">,</span> <span class="mf">1492.</span><span class="p">,</span> <span class="mf">1521.</span><span class="p">,</span> <span class="mf">1552.</span><span class="p">,</span> <span class="mf">1582.</span><span class="p">,</span> <span class="mf">1613.</span><span class="p">,</span>
       <span class="mf">1643.</span><span class="p">,</span> <span class="mf">1674.</span><span class="p">,</span> <span class="mf">1705.</span><span class="p">,</span> <span class="mf">1735.</span><span class="p">,</span> <span class="mf">1766.</span><span class="p">,</span> <span class="mf">1796.</span><span class="p">,</span> <span class="mf">1827.</span><span class="p">,</span> <span class="mf">1858.</span><span class="p">,</span> <span class="mf">1886.</span><span class="p">,</span>
       <span class="mf">1917.</span><span class="p">,</span> <span class="mf">1947.</span><span class="p">,</span> <span class="mf">1978.</span><span class="p">,</span> <span class="mf">2008.</span><span class="p">,</span> <span class="mf">2039.</span><span class="p">,</span> <span class="mf">2070.</span><span class="p">,</span> <span class="mf">2100.</span><span class="p">,</span> <span class="mf">2131.</span><span class="p">,</span> <span class="mf">2161.</span><span class="p">,</span>
       <span class="mf">2192.</span><span class="p">,</span> <span class="mf">2223.</span><span class="p">,</span> <span class="mf">2251.</span><span class="p">,</span> <span class="mf">2282.</span><span class="p">,</span> <span class="mf">2312.</span><span class="p">,</span> <span class="mf">2343.</span><span class="p">,</span> <span class="mf">2373.</span><span class="p">,</span> <span class="mf">2404.</span><span class="p">,</span> <span class="mf">2435.</span><span class="p">,</span>
       <span class="mf">2465.</span><span class="p">,</span> <span class="mf">2496.</span><span class="p">,</span> <span class="mf">2526.</span><span class="p">]),</span> <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;days since 2004-01-01 00:00:00&#39;</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;gregorian&#39;</span><span class="p">),</span> <span class="n">long_name</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You may also want the time-stamps in the form of actual datetime-like
objects. These can be computed using the <code class="docutils literal notranslate"><span class="pre">time_stamps()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2004-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-03-01T00:00:00.000000&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-maps">
<h4>Plotting maps<a class="headerlink" href="#plotting-maps" title="Permalink to this headline">¶</a></h4>
<p>Maps of individual time stamps can be plotted using the quickplot_map
method.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">od550aer</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">od550csaer</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_26_0.png" src="_images/tut00_get_started_26_0.png" />
<img alt="_images/tut00_get_started_26_1.png" src="_images/tut00_get_started_26_1.png" />
</div>
<div class="section" id="filtering">
<h4>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h4>
<p>Regional filtering can be performed using the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.filter">Filter</a>
class (cf. flowchart above).</p>
<p>An overview of available default regions can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">get_all_default_region_ids</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;WORLD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUROPE&#39;</span><span class="p">,</span> <span class="s1">&#39;ASIA&#39;</span><span class="p">,</span> <span class="s1">&#39;AUSTRALIA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHINA&#39;</span><span class="p">,</span> <span class="s1">&#39;INDIA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMERICA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAMERICA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now let’s go for north Africa. Create instance of Filter class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;NAFRICA&#39;</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="p">([(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA-wMOUNTAINS&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;_region&#39;</span><span class="p">,</span>
         <span class="n">Region</span> <span class="n">NAFRICA</span> <span class="n">Region</span><span class="p">([(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lon_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lat_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lon_range_plot&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lat_range_plot&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lon_ticks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lat_ticks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])),</span>
        <span class="p">(</span><span class="s1">&#39;lon_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;lat_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;alt_range&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
</pre></div>
</div>
<p>… and apply to the two data objects (this can be done by calling the
filter with the corresponding data class as input parameter):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">od550aer</span><span class="p">)</span>
<span class="n">od550csaer_nafrica</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Applying</span> <span class="n">regional</span> <span class="n">cropping</span> <span class="ow">in</span> <span class="n">GriddedData</span> <span class="n">using</span> <span class="n">Filter</span> <span class="n">class</span><span class="o">.</span> <span class="n">Note</span> <span class="n">that</span> <span class="n">this</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">include</span> <span class="n">potential</span> <span class="n">cropping</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vertical</span> <span class="n">dimension</span><span class="o">.</span> <span class="n">Coming</span> <span class="n">soon</span><span class="o">...</span>
<span class="n">Applying</span> <span class="n">regional</span> <span class="n">cropping</span> <span class="ow">in</span> <span class="n">GriddedData</span> <span class="n">using</span> <span class="n">Filter</span> <span class="n">class</span><span class="o">.</span> <span class="n">Note</span> <span class="n">that</span> <span class="n">this</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">include</span> <span class="n">potential</span> <span class="n">cropping</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">vertical</span> <span class="n">dimension</span><span class="o">.</span> <span class="n">Coming</span> <span class="n">soon</span><span class="o">...</span>
</pre></div>
</div>
<p>Compare shapes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">500</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">84</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">42</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">57</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">500</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">84</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>As you can see, the filtered object is reduced in the longitude and
latitude dimension. Let’s plot the two new objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">od550csaer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_37_0.png" src="_images/tut00_get_started_37_0.png" />
<img alt="_images/tut00_get_started_37_1.png" src="_images/tut00_get_started_37_1.png" />
</div>
<div class="section" id="filtering-of-time">
<h4>Filtering of time<a class="headerlink" href="#filtering-of-time" title="Permalink to this headline">¶</a></h4>
<p>Filtering of time is not yet included in the Filter class but can be
easily performed from the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object directly. If you know
the indices of the time stamps you want to crop, you can simply use
numpy indexing syntax (remember that we have a 3D array containing time,
latitude and lonfgitude).</p>
<p>Let’s say we want to filter the <strong>year 2009</strong>.</p>
<p>Since the time dimension corresponds the first index in the 3D data
(time, lat, lon), and since we know, that we have monthly data from
2008-2010 (see above), we may use</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica_2009</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>
<span class="n">od550aer_nafrica_2009</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2005-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-12-01T00:00:00.000000&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>in order to extract the year 2009.</p>
<p>However, this methodology might not always be handy (imagine you have a
10 year dataset of <code class="docutils literal notranslate"><span class="pre">3hourly</span></code> sampled data and want to extract three
months in the 6th year …). In that case, you can perform the cropping
using the actual timestamps (for comparibility, let’s stick to 2009
here):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica_2009_alt</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1-1-2009&#39;</span><span class="p">,</span> <span class="s1">&#39;1-1-2010&#39;</span><span class="p">))</span>
<span class="n">od550aer_nafrica_2009</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2005-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-12-01T00:00:00.000000&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="data-aggregation">
<h4>Data aggregation<a class="headerlink" href="#data-aggregation" title="Permalink to this headline">¶</a></h4>
<p>Let’s say we want to compute yearly means for each of the 3 years. In
this case we can simply call the <code class="docutils literal notranslate"><span class="pre">downscale_time</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">downscale_time</span><span class="p">(</span><span class="s1">&#39;yearly&#39;</span><span class="p">)</span>
<span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">method</span> <span class="ow">is</span> <span class="n">deprecated</span><span class="o">.</span> <span class="n">Please</span> <span class="n">use</span> <span class="n">new</span> <span class="n">name</span> <span class="n">resample_time</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_44_1.png" src="_images/tut00_get_started_44_1.png" />
<img alt="_images/tut00_get_started_44_2.png" src="_images/tut00_get_started_44_2.png" />
<p><strong>Note</strong>: seasonal aggregation is not yet implemented in pyaerocom but
will follow soon.</p>
<p>In the following section the reading of ungridded data is illustrated
based on the example of AERONET version 3 (level 2) data. The test
dataset contains a randomly picked subset of 100 Aeronet stations.
Aeronet provides different products,</p>
</div>
</div>
<div class="section" id="reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes">
<h3>Reading of and working with ungridded data (<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> and <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> classes)<a class="headerlink" href="#reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes" title="Permalink to this headline">¶</a></h3>
<p>Ungridded data in pyaerocom refers to data that is available in the form
of <em>files per station</em> and that is not sampled in a manner that it would
make sense to translate into a rgular gridded format such as the
previously introduced <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.</p>
<p>Data from the AERONET network (that is introduced in the following), for
instance, is provided in the form of column seperated text files per
measurement station, where columns correspond to different variables and
data rows to individual time stamps. Needless to say that the time
stamps (or the covered periods) vary from station to station.</p>
<p>The basic workflow for reading of ungridded data, such as Aeronet data,
is very similar to the reading of gridded data (comprising a reading
class that handles a query and returns a data class, here
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.ungriddeddata">UngriddedData</a>
(see also flow chart above).</p>
<p>Before we can continue with the data import, some things need to be said
related to the caching of <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> objects.</p>
<div class="section" id="caching-of-ungriddeddata">
<h4>Caching of UngriddedData<a class="headerlink" href="#caching-of-ungriddeddata" title="Permalink to this headline">¶</a></h4>
<p>Reading of ungridded data is often rather time-consuming. Therefore,
pyaerocom uses a caching strategy that stores loaded instances of the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class as pickle files in a cache directory
(illustrated in the left hand side of the flowchart shown above). The
loaction of the cache directory can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHEDIR</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/home/jonasg/MyPyaerocom/_cache/jonasg&#39;</span>
</pre></div>
</div>
<p>You may change this directory if required.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Caching is active? </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Caching is active? True
</pre></div>
</div>
<div class="section" id="deactivate-activate-caching">
<h5>Deactivate / Activate caching<a class="headerlink" href="#deactivate-activate-caching" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p><strong>Note</strong>: if caching is active, make sure you have enough disk quota or
change location where the files are stored.</p>
</div>
</div>
<div class="section" id="read-aeronet-sun-v3-level-2-data">
<h4>Read Aeronet Sun v3 level 2 data<a class="headerlink" href="#read-aeronet-sun-v3-level-2-data" title="Permalink to this headline">¶</a></h4>
<p>As illustrated in the flowchart above, ungridded observation data can be
imported using the <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class. The reading class requires
an ID for the observation network that is supposed to be read. Let’s
find the right ID for these data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;Aeronet*V3*Lev2*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190511</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">SDA</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od500gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>
<span class="n">Reading</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">AP</span><span class="o">.</span> <span class="n">Error</span><span class="p">:</span> <span class="n">NetworkNotImplemented</span><span class="p">(</span><span class="s1">&#39;No reading class available yet for dataset AeronetSDAV3Lev2.AP&#39;</span><span class="p">)</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetInvV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;angabs4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190914</span>
</pre></div>
</div>
<p>It found one match and the dataset ID is <em>AeronetSunV3Lev2.daily</em>. It
also tells us what variables can be loaded via the interface.</p>
<p><strong>Note</strong>: You can safely ignore all the warnings in the output. These
are due to the fact that the testdata set does not contain all
observation networks that are available in the AEROCOM database.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>
</pre></div>
</div>
<p>Let’s read the data (you can read a single or multiple variables at the
same time). For now, we only read the AOD at 550 nm:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aeronet_data</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">aeronet_data</span><span class="p">)</span> <span class="c1">#displays data type</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">ungriddeddata</span><span class="o">.</span><span class="n">UngriddedData</span>
</pre></div>
</div>
<p>As you can see, the data object is of type <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code>. Like the
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object, also the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class has an
informative string representation (that can be printed):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">aeronet_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">meta</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span> <span class="mi">1230</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-all-station-coordinates">
<h4>Plot all station coordinates<a class="headerlink" href="#plot-all-station-coordinates" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_66_0.png" src="_images/tut00_get_started_66_0.png" />
</div>
<div class="section" id="access-of-individual-stations">
<h4>Access of individual stations<a class="headerlink" href="#access-of-individual-stations" title="Permalink to this headline">¶</a></h4>
<p>Get all station names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_station_names</span> <span class="o">=</span> <span class="n">aeronet_data</span><span class="o">.</span><span class="n">unique_station_names</span>
<span class="n">all_station_names</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1">#displays first 10 stations</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AAOT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AOE_Baotou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Ascension_Is&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Barnstable_MA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Cordoba&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Darwin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Gan_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Graciosa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Highlands_MA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_HyytialaFinland&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>For instance, to access the data for the city of Leipzig, Germany, you
can use square brackets with the station name of Leipzig:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span> <span class="o">=</span> <span class="n">aeronet_data</span><span class="p">[</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">]</span> <span class="c1"># this is fully equivalent with aeronet_data.to_station_data(&#39;Leipzig&#39;)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">stationdata</span><span class="o">.</span><span class="n">StationData</span>
</pre></div>
</div>
<p>As you can see, the returned object is of type <code class="docutils literal notranslate"><span class="pre">StationData</span></code>, which is
one further data format of pyaerocom (note that this is not displayed in
the simplified flowchart above). <code class="docutils literal notranslate"><span class="pre">StationData</span></code> may be useful for
individual stations and is an extended Python dictionary (if you are
familiar with Python).</p>
<p>You may print it to see what is in there:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">od550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
    <span class="n">apply_constraints</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">min_num_obs</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">51.352500000000006</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="mf">12.435277999999998</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">125.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">filename</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_id</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Leipzig</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">sun_photometer</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Brent_Holben</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">51.352500000000006</span>
<span class="n">longitude</span><span class="p">:</span> <span class="mf">12.435277999999998</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">125.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20190920</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">6363</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">2001</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">21</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2001</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">22</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">20</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">21</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">od550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">6363</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, this station contains a time-series of the AOD at 550
nm. If you like, you can plot this time-series:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">station_data</span><span class="o">.</span><span class="n">insert_nans_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">station_data</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f322c4732b0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_74_1.png" src="_images/tut00_get_started_74_1.png" />
<p>You can also retrieve the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> with specifying more
constraints using <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code> (e.g. in monthly resolution and
only for the year 2010). And you can overlay different curves, by
passing the axes instance returned by the plotting method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">=</span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">,</span>
                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">=</span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">,</span>
                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Leipzig AODs 2010&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;Leipzig AODs 2010&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_76_1.png" src="_images/tut00_get_started_76_1.png" />
</div>
<div class="section" id="you-can-also-plot-the-time-series-directly">
<h4>You can also plot the time-series directly<a class="headerlink" href="#you-can-also-plot-the-time-series-directly" title="Permalink to this headline">¶</a></h4>
<p>For instance, if you want to do an air-quality check for you next
bouldering trip, you may call:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">aeronet_data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Fontainebleau&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
<span class="n">ts</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">StationData</span><span class="p">([(</span><span class="s1">&#39;dtime&#39;</span><span class="p">,</span>
              <span class="n">array</span><span class="p">([</span><span class="s1">&#39;2006-01-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-02-15T00:00:00.000000000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;2006-03-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-04-15T00:00:00.000000000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;2006-05-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-06-15T00:00:00.000000000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;2006-07-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-08-15T00:00:00.000000000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;2006-09-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-10-15T00:00:00.000000000&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;2006-11-15T00:00:00.000000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-12-15T00:00:00.000000000&#39;</span><span class="p">],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;var_info&#39;</span><span class="p">,</span>
              <span class="n">BrowseDict</span><span class="p">([(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
                           <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;overlap&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;apply_constraints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;min_num_obs&#39;</span><span class="p">,</span>
                                         <span class="p">{</span><span class="s1">&#39;yearly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;monthly&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                                          <span class="s1">&#39;monthly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;daily&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
                                          <span class="s1">&#39;daily&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;hourly&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
                                          <span class="s1">&#39;hourly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minutely&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})]))])),</span>
             <span class="p">(</span><span class="s1">&#39;station_coords&#39;</span><span class="p">,</span>
              <span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.406666999999985</span><span class="p">,</span>
               <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">2.6802780000000004</span><span class="p">,</span>
               <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="mf">85.0</span><span class="p">}),</span>
             <span class="p">(</span><span class="s1">&#39;data_err&#39;</span><span class="p">,</span> <span class="n">BrowseDict</span><span class="p">()),</span>
             <span class="p">(</span><span class="s1">&#39;overlap&#39;</span><span class="p">,</span> <span class="n">BrowseDict</span><span class="p">()),</span>
             <span class="p">(</span><span class="s1">&#39;data_flagged&#39;</span><span class="p">,</span> <span class="n">BrowseDict</span><span class="p">()),</span>
             <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Fontainebleau&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;instrument_name&#39;</span><span class="p">,</span> <span class="s1">&#39;sun_photometer&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="s1">&#39;Brent_Holben&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mf">48.406666999999985</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mf">2.6802780000000004</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="mf">85.0</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_id&#39;</span><span class="p">,</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_product&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_version&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_level&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;revision_date&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;stat_merge_pref_attr&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_revision&#39;</span><span class="p">,</span> <span class="s1">&#39;20190920&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="mi">2006</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.176742</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">15</span>         <span class="n">NaN</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.252403</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.195318</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.215357</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.195586</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.224991</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.131814</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.151338</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.141222</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">0.088815</span>
              <span class="mi">2006</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span>         <span class="n">NaN</span>
              <span class="n">Name</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">plot_station_timeseries</span><span class="p">(</span><span class="s1">&#39;Fontainebleau&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                     <span class="n">start</span><span class="o">=</span><span class="mi">2006</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AOD in Fontainebleau, 2006&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;AOD in Fontainebleau, 2006&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_79_1.png" src="_images/tut00_get_started_79_1.png" />
<p>Seems like November is a good time (maybe a bit rainy though)</p>
</div>
</div>
<div class="section" id="colocation-of-model-and-obsdata">
<h3>Colocation of model and obsdata<a class="headerlink" href="#colocation-of-model-and-obsdata" title="Permalink to this headline">¶</a></h3>
<p>Now that we have different data objects loaded we can continue with
colocation. In the following, both the all-sky and the clear-sky data
from CAM53-Oslo will be colocated with the subset of Aeronet stations
that we just loaded.</p>
<p>The colocation will be performed for the year of 2010 and two scatter
plots will be created.</p>
<p>You have also the option to apply a certain filter when colocating using
a valid filter name. Here, we use global data and exclude mountain
sides.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_all_sky_glob</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">od550aer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                                                <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                                                <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">col_all_sky_glob</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">colocateddata</span><span class="o">.</span><span class="n">ColocatedData</span>
</pre></div>
</div>
<p>Let’s do the same for the clear-sky data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_clear_sky_glob</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                                                  <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                                  <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                                                  <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">col_clear_sky_glob</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">colocateddata</span><span class="o">.</span><span class="n">ColocatedData</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">col_all_sky_glob</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All sky (2010, monthly)&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_86_0.png" src="_images/tut00_get_started_86_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax2</span> <span class="o">=</span> <span class="n">col_clear_sky_glob</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Clear sky (2010, monthly)&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_87_0.png" src="_images/tut00_get_started_87_0.png" />
<p>… or for EUROPE:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">od550aer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                          <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                          <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                          <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_89_1.png" src="_images/tut00_get_started_89_1.png" />
<div class="section" id="colocation-with-satellite-aods-from-modis">
<h4>Colocation with satellite AODs from MODIS<a class="headerlink" href="#colocation-with-satellite-aods-from-modis" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sat_data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s1">&#39;MODIS6.aqua&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span>
<span class="n">sat_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">vmin</span><span class="o">=.</span><span class="mi">001</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c_under</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550aer</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_91_1.png" src="_images/tut00_get_started_91_1.png" />
<p>Colocation is straight forward as shown below. The data will be
regridded to 5x5 degrees resolution during the colocation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_modis_monthly</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_gridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="o">=</span><span class="n">od550aer</span><span class="p">,</span>
                                                            <span class="n">gridded_data_ref</span><span class="o">=</span><span class="n">sat_data</span><span class="p">,</span>
                                                            <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                            <span class="n">regrid_res_deg</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                            <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                            <span class="n">harmonise_units</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_modis_monthly</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f321c2af048</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_94_1.png" src="_images/tut00_get_started_94_1.png" />
<p>You may also change the plot style, to adapt better to the large amount
of data points here in these satellite products:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_modis_monthly</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f321c1f2be0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_96_1.png" src="_images/tut00_get_started_96_1.png" />
</div>
<div class="section" id="remark-on-the-colocateddata-object">
<h4>Remark on the ColocatedData object<a class="headerlink" href="#remark-on-the-colocateddata-object" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">ColocatedData</span></code> object has not many features and methods
implemented yet. But it builds a good basis for further analysis using
features of the underlying data-structure, which is an instance of the
<a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html">xarray.DataArray</a>
class and can be accessed via the <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute if the
<code class="docutils literal notranslate"><span class="pre">ColocatedData</span></code> object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">col_all_sky_glob</span><span class="o">.</span><span class="n">data</span>
<span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xarray</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dataarray</span><span class="o">.</span><span class="n">DataArray</span>
</pre></div>
</div>
<p>You may want to read more about it
<a class="reference external" href="http://xarray.pydata.org/en/stable/data-structures.html">here</a>.</p>
</div>
</div>
</div>
<div class="section" id="aerocom-default-regions-class-region">
<h2>AEROCOM default regions (class <code class="docutils literal notranslate"><span class="pre">Region</span></code>)<a class="headerlink" href="#aerocom-default-regions-class-region" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces how pya handles information related to default
regions (e.g. Europe, Asia, …) as used in the <a class="reference external" href="http://aerocom.met.no/cgi-bin/AEROCOM/aerocom/surfobs_annualrs.pl">AEROCOM
interface</a>.
All default regions are defined in the file
<a class="reference external" href="http://aerocom.met.no/pya/config_files.html#default-regions">regions.ini</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.019</span> <span class="n">s</span>
</pre></div>
</div>
<div class="section" id="what-regions-are-available">
<h3>What regions are available<a class="headerlink" href="#what-regions-are-available" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;WORLD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EUROPE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ASIA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AUSTRALIA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CHINA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;INDIA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NAFRICA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SAFRICA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SAMERICA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NAMERICA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>These region IDs can be used to access more information about the
regions (which is used throughout pyaerocom). For instance:</p>
</div>
<div class="section" id="create-a-region">
<h3>Create a <code class="docutils literal notranslate"><span class="pre">Region</span></code><a class="headerlink" href="#create-a-region" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">europe</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">europe</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">EUROPE</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asia</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;ASIA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asia</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">ASIA</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="load-example-data-and-apply-region-specific-crop">
<h3>Load example data and apply region specific crop<a class="headerlink" href="#load-example-data-and-apply-region-specific-crop" title="Permalink to this headline">¶</a></h3>
<p>In the following cell, we create an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>
class (hich is introduced in more detail in a later tutorial), load some
test data (from the CAMS ECMWF OSUITE dataset), crop it and plot a map
of the results over Europe.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">_init_testdata_default</span><span class="p">()</span>
<span class="n">crop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">crop</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550aer</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<img alt="_images/tut01_intro_regions_9_1.png" src="_images/tut01_intro_regions_9_1.png" />
</div>
<div class="section" id="computing-distance-to-centre-of-region">
<h3>Computing distance to centre of region<a class="headerlink" href="#computing-distance-to-centre-of-region" title="Permalink to this headline">¶</a></h3>
<p>For a given lat / lon coordinate, distances to the region centre
coordinate can be computed as:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">asia</span><span class="o">.</span><span class="n">distance_to_center</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">dc</span> <span class="c1">#km</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">3476.358401761219</span>
</pre></div>
</div>
<p>Access centre coordinate:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asia</span><span class="o">.</span><span class="n">center_coordinate</span> <span class="c1"># (lat, lon)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asia</span><span class="o">.</span><span class="n">distance_to_center</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0</span>
</pre></div>
</div>
<p>That’s it. Not much more to say about regions until now.</p>
</div>
</div>
<div class="section" id="reading-of-gridded-data-the-readgridded-class">
<h2>Reading of gridded data - the <em>ReadGridded</em> class<a class="headerlink" href="#reading-of-gridded-data-the-readgridded-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.readgridded.ReadGridded">ReadGridded</a>
class of pyaerocom, a flexible interface for importing model results
from a single model, based on variable name (e.g. <em>od550aer</em>,
<em>od550bc</em>), start / stop time stamps and temporal resolution
(e.g. <em>hourly, 3hourly, daily, monthly</em>).</p>
<p>The class is part of the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.io.readgridded">readgridded</a>
module of pyaerocom.</p>
<p>In the following, we create an instance of the the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class
and use this object to find and import data files containing the aerosol
optical depth at 550 nm (<em>od550aer</em>) from the ECMWF CAMS reanalysis
dataset (<em>ECMWF_CAMS_REAN</em>) for the years 2003-2007 and in daily
resolution. The files will be temporally merged and put into a single
instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.</p>
<p>We start with creating a reading object, that will take care of finding
the model directory for us (based on the model ID) and all valid NetCDF
files on initialisation. Use the <code class="docutils literal notranslate"><span class="pre">print</span></code> commant to preview the string
representation of <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> object, which provides useful
information about what is in there.</p>
<div class="section" id="remark-on-reading-of-gridded-data">
<h3>Remark on reading of gridded data<a class="headerlink" href="#remark-on-reading-of-gridded-data" title="Permalink to this headline">¶</a></h3>
<p>Since model data files can be large (too large for in-memory
operations), gridded data in pyaerocom (e.g. model data or satellite
data) is generally read and represented as <em>lazy data</em>. That means, that
the actual N-dimensional data array is not loaded into memory before
needed. Lazy data is represented as [dask array] as pyaerocom data
objects rely either on the Python
<a class="reference external" href="https://scitools.org.uk/iris/docs/latest/index.html">iris</a> library
or <a class="reference external" href="http://xarray.pydata.org/en/stable/index.html">xarray</a> (which
both use dask for representing lazy data and for out of core
computation). For more information on lazy data, see
e.g. <a class="reference external" href="https://scitools.org.uk/iris/docs/latest/userguide/real_and_lazy_data.html">https://scitools.org.uk/iris/docs/latest/userguide/real_and_lazy_data.html</a>.</p>
<p><strong>Example</strong>: Consider one year of daily model data in 1x1 resolution
with 30 vertical layers, stored as 64 bit floating point numbers.
Loading such a file into memory, would require a RAM of at least:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> GB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">64</span> <span class="o">*</span> <span class="p">(</span><span class="mi">360</span> <span class="o">*</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;5.7 GB&#39;</span>
</pre></div>
</div>
<p>Or the same in hourly resolution:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1"> GB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">64</span> <span class="o">*</span> <span class="p">(</span><span class="mi">360</span> <span class="o">*</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;136.2 GB&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.103</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="create-instance-of-readgridded-class">
<h3>Create instance of <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class<a class="headerlink" href="#create-instance-of-readgridded-class" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">data_id</span><span class="o">=</span><span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;REAN&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aerboa&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aertoa&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm10&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm25&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The output contains information about all variables that were found and
all corresponding years. These information is extracted from the
filenames, which have to follow the AEROCOM file naming conventions.</p>
<p><strong>Please note</strong> that at this point, no data is actually imported but
only the paths are set that contain data for this model. In order to
read one variable, call the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> function with a valid variable
name. You can check available variables using the <code class="docutils literal notranslate"><span class="pre">vars</span></code> attribute (or
by printing the string representation, as shown in the cell above).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">vars</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bscatc532aerboa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;bscatc532aertoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ec532aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ec532dryaer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od865aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcpm10&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcpm25&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;time&#39;</span><span class="p">,</span>
 <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;1-1-2003&quot;</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="s2">&quot;31-12-2007&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The returned data object is of type
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
class, which will be introduced in more detail later. This data object
is returned by the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> method and can also be accessed from the
instance of the reading class using:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;od550aer&quot;</span><span class="p">]</span>
<span class="n">d</span> <span class="ow">is</span> <span class="n">data</span> <span class="c1">#?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<p>We may also import other variables using either the above used method
<code class="docutils literal notranslate"><span class="pre">read_var</span></code> or the more general <code class="docutils literal notranslate"><span class="pre">read</span></code> method which can read single
or multiple variables on the run.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550bc</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
<span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550dust</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
<span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550oa</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
<span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550so4</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">6209</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">6209</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">6209</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">6209</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s double check if all variables have been imported.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;REAN&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aerboa&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aertoa&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm10&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm25&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>
<span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">,</span> <span class="n">Var</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">,</span> <span class="n">Var</span><span class="p">:</span> <span class="n">od550bc</span>
<span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">,</span> <span class="n">Var</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">,</span> <span class="n">Var</span><span class="p">:</span> <span class="n">od550oa</span>
<span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">,</span> <span class="n">Var</span><span class="p">:</span> <span class="n">od550so4</span>
</pre></div>
</div>
<p>In the following we continue with the <code class="docutils literal notranslate"><span class="pre">od550aer</span></code> data object that was
loaded first and that was assigned the name <code class="docutils literal notranslate"><span class="pre">data</span></code> above.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The data object is of type </span><span class="si">%s</span><span class="s2"> and contains </span><span class="si">%d</span><span class="s2"> time stamps&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The data object is of type &lt;class &#39;pyaerocom.griddeddata.GriddedData&#39;&gt; and contains 1826 time stamps
</pre></div>
</div>
<p>The returned
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
object contains 1826 time stamps. Given that the defined period of 5
years includes one leap year, we should expect that we imported data for
each day of the five years?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1826</span> <span class="o">==</span> <span class="mi">5</span><span class="o">*</span><span class="mi">365</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="section" id="other-options-for-reading">
<h4>Other options for reading<a class="headerlink" href="#other-options-for-reading" title="Permalink to this headline">¶</a></h4>
<p>The reading query can be further customised with respect to the temporal
resolution that is requested. Let’s have a look at the available AOD
data at 550 nm:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">filter_files</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>15</td>
      <td>od550aer</td>
      <td>2003</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2003.nc</td>
    </tr>
    <tr>
      <td>144</td>
      <td>od550aer</td>
      <td>2003</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2003.nc</td>
    </tr>
    <tr>
      <td>85</td>
      <td>od550aer</td>
      <td>2004</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2004.nc</td>
    </tr>
    <tr>
      <td>110</td>
      <td>od550aer</td>
      <td>2004</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2004.nc</td>
    </tr>
    <tr>
      <td>236</td>
      <td>od550aer</td>
      <td>2005</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2005.nc</td>
    </tr>
    <tr>
      <td>82</td>
      <td>od550aer</td>
      <td>2005</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2005.nc</td>
    </tr>
    <tr>
      <td>215</td>
      <td>od550aer</td>
      <td>2006</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2006.nc</td>
    </tr>
    <tr>
      <td>179</td>
      <td>od550aer</td>
      <td>2006</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2006.nc</td>
    </tr>
    <tr>
      <td>157</td>
      <td>od550aer</td>
      <td>2007</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2007.nc</td>
    </tr>
    <tr>
      <td>0</td>
      <td>od550aer</td>
      <td>2007</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2007.nc</td>
    </tr>
    <tr>
      <td>191</td>
      <td>od550aer</td>
      <td>2008</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2008.nc</td>
    </tr>
    <tr>
      <td>72</td>
      <td>od550aer</td>
      <td>2009</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2009.nc</td>
    </tr>
    <tr>
      <td>201</td>
      <td>od550aer</td>
      <td>2010</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2010.nc</td>
    </tr>
    <tr>
      <td>14</td>
      <td>od550aer</td>
      <td>2011</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2011.nc</td>
    </tr>
    <tr>
      <td>152</td>
      <td>od550aer</td>
      <td>2012</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2012.nc</td>
    </tr>
    <tr>
      <td>200</td>
      <td>od550aer</td>
      <td>2013</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2013.nc</td>
    </tr>
    <tr>
      <td>138</td>
      <td>od550aer</td>
      <td>2014</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2014.nc</td>
    </tr>
    <tr>
      <td>145</td>
      <td>od550aer</td>
      <td>2015</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2015.nc</td>
    </tr>
    <tr>
      <td>243</td>
      <td>od550aer</td>
      <td>2016</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2016.nc</td>
    </tr>
    <tr>
      <td>93</td>
      <td>od550aer</td>
      <td>2017</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2017.nc</td>
    </tr>
    <tr>
      <td>104</td>
      <td>od550aer</td>
      <td>2018</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2018.nc</td>
    </tr>
    <tr>
      <td>187</td>
      <td>od550aer</td>
      <td>2019</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>False</td>
      <td>ECMWF_CAMS_REAN.daily.od550aer.2019.nc</td>
    </tr>
  </tbody>
</table>
</div><p>As you can see, there are both daily and monthly files. The monthly,
however only covers the years 2003-2007, while the daily has data until
2018:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">filter_files</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>144</td>
      <td>od550aer</td>
      <td>2003</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2003.nc</td>
    </tr>
    <tr>
      <td>110</td>
      <td>od550aer</td>
      <td>2004</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2004.nc</td>
    </tr>
    <tr>
      <td>82</td>
      <td>od550aer</td>
      <td>2005</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2005.nc</td>
    </tr>
    <tr>
      <td>179</td>
      <td>od550aer</td>
      <td>2006</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2006.nc</td>
    </tr>
    <tr>
      <td>0</td>
      <td>od550aer</td>
      <td>2007</td>
      <td>monthly</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.monthly.od550aer.2007.nc</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">filter_files</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>15</td>
      <td>od550aer</td>
      <td>2003</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2003.nc</td>
    </tr>
    <tr>
      <td>85</td>
      <td>od550aer</td>
      <td>2004</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2004.nc</td>
    </tr>
    <tr>
      <td>236</td>
      <td>od550aer</td>
      <td>2005</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2005.nc</td>
    </tr>
    <tr>
      <td>215</td>
      <td>od550aer</td>
      <td>2006</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2006.nc</td>
    </tr>
    <tr>
      <td>157</td>
      <td>od550aer</td>
      <td>2007</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2007.nc</td>
    </tr>
    <tr>
      <td>191</td>
      <td>od550aer</td>
      <td>2008</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2008.nc</td>
    </tr>
    <tr>
      <td>72</td>
      <td>od550aer</td>
      <td>2009</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2009.nc</td>
    </tr>
    <tr>
      <td>201</td>
      <td>od550aer</td>
      <td>2010</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2010.nc</td>
    </tr>
    <tr>
      <td>14</td>
      <td>od550aer</td>
      <td>2011</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2011.nc</td>
    </tr>
    <tr>
      <td>152</td>
      <td>od550aer</td>
      <td>2012</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2012.nc</td>
    </tr>
    <tr>
      <td>200</td>
      <td>od550aer</td>
      <td>2013</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2013.nc</td>
    </tr>
    <tr>
      <td>138</td>
      <td>od550aer</td>
      <td>2014</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2014.nc</td>
    </tr>
    <tr>
      <td>145</td>
      <td>od550aer</td>
      <td>2015</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2015.nc</td>
    </tr>
    <tr>
      <td>243</td>
      <td>od550aer</td>
      <td>2016</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2016.nc</td>
    </tr>
    <tr>
      <td>93</td>
      <td>od550aer</td>
      <td>2017</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2017.nc</td>
    </tr>
    <tr>
      <td>104</td>
      <td>od550aer</td>
      <td>2018</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td>REAN</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom.ECMWF_CAMS_REAN.daily.od550aer.2018.nc</td>
    </tr>
    <tr>
      <td>187</td>
      <td>od550aer</td>
      <td>2019</td>
      <td>daily</td>
      <td></td>
      <td>ECMWF_CAMS_REAN</td>
      <td></td>
      <td></td>
      <td></td>
      <td>False</td>
      <td>False</td>
      <td>ECMWF_CAMS_REAN.daily.od550aer.2019.nc</td>
    </tr>
  </tbody>
</table>
</div><p>Now, when it comes to reading a data object, these information can be
specified as input:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_monthly</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aod_monthly</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">aod_monthly</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">aod_monthly</span><span class="o">.</span><span class="n">ts_type</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span> <span class="n">monthly</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_daily</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aod_daily</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">aod_daily</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">aod_daily</span><span class="o">.</span><span class="n">ts_type</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span> <span class="n">daily</span>
</pre></div>
</div>
<p>However, what about a situation where you write a script that processes
many models and you don’t really know, in what resolution the model data
comes, but 1. you prefer monthly where available (keyword
<code class="docutils literal notranslate"><span class="pre">flex_ts_type</span></code>), and 2. you want to have the longest available
timeseries (keyword <code class="docutils literal notranslate"><span class="pre">prefer_longer</span></code>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_inferred</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">flex_ts_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prefer_longer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aod_inferred</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">aod_inferred</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">aod_inferred</span><span class="o">.</span><span class="n">ts_type</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF_CAMS_REAN</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2019.</span><span class="n">nc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span> <span class="n">daily</span>
</pre></div>
</div>
<p>As you can see, the reading routine has automatically identified, that
the daily dataset has a better time coverage and has thus, preferred
that one over the specified ts_type of monthly.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_inferred_monthly</span> <span class="o">=</span> <span class="n">aod_inferred</span><span class="o">.</span><span class="n">resample_time</span><span class="p">(</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
<span class="n">aod_inferred_monthly</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">204</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="remark-on-time-definition">
<h4>Remark on time definition<a class="headerlink" href="#remark-on-time-definition" title="Permalink to this headline">¶</a></h4>
<p>If the time dimension is not properly defined in a NetCDF data file,
Pyaerocom can correct for this on data import by:</p>
<ol class="arabic simple">
<li><p>First checking if the time dimension in the NetCDF file is correct
according to CF convention (<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.helpers.check_time_coord">see here for details on the
implementation</a>
and if a problem is detected, then …</p></li>
<li><p>the time axis is redefined based on the year and time resolution
(<em>ts_type</em>) that is provided in the filename. The latter requires
that the file follows one of the <a class="reference external" href="http://aerocom.met.no/pyaerocom/config_files.html#file-conventions">pyaerocom file
conventions</a>.</p></li>
</ol>
</div>
<div class="section" id="a-very-brief-introduction-into-the-griddeddata-class">
<h4>A very brief introduction into the GriddedData class<a class="headerlink" href="#a-very-brief-introduction-into-the-griddeddata-class" title="Permalink to this headline">¶</a></h4>
<p>Now as a final step, we briefly introduce some of the features of the
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class by computing and plotting a time series of the
global weighted average aerosol optical density as well as the same time
series at the coordinates in the city of Leipzig, Germany.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#extract AODs at the position of Leipzig</span>
<span class="n">lon_leipzig</span> <span class="o">=</span> <span class="mf">12.44</span>
<span class="n">lat_leipzig</span> <span class="o">=</span> <span class="mf">51.35</span>

<span class="c1"># the method to_time_series is designed to handle more than one coordinate (i.e. a list of station coordinates)</span>
<span class="n">data_leipzig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_time_series</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">lat_leipzig</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="n">lon_leipzig</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">global_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_area_weighted_timeseries</span><span class="p">()</span>
<span class="n">europe_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_area_weighted_timeseries</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;EUROPE&#39;</span><span class="p">)</span>
<span class="n">india_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_area_weighted_timeseries</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;INDIA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">1826</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-timeseries">
<h4>Plot timeseries<a class="headerlink" href="#plot-timeseries" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span>  <span class="n">data_leipzig</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">global_mean</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean (global)&#39;</span><span class="p">)</span>
<span class="n">europe_mean</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean (Europe)&#39;</span><span class="p">)</span>
<span class="n">india_mean</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean (India)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">tit</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ECMWF Reanalysis (monthly averages)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Trying</span> <span class="n">to</span> <span class="n">infer</span> <span class="n">ts_type</span> <span class="ow">in</span> <span class="n">StationData</span> <span class="n">ECMWF_CAMS_REAN</span> <span class="k">for</span> <span class="n">variable</span> <span class="n">od550aer</span>
<span class="n">Trying</span> <span class="n">to</span> <span class="n">infer</span> <span class="n">ts_type</span> <span class="ow">in</span> <span class="n">StationData</span> <span class="n">ECMWF_CAMS_REAN</span> <span class="k">for</span> <span class="n">variable</span> <span class="n">od550aer</span>
<span class="n">Trying</span> <span class="n">to</span> <span class="n">infer</span> <span class="n">ts_type</span> <span class="ow">in</span> <span class="n">StationData</span> <span class="n">ECMWF_CAMS_REAN</span> <span class="k">for</span> <span class="n">variable</span> <span class="n">od550aer</span>
</pre></div>
</div>
<img alt="_images/tut02_intro_class_ReadGridded_37_1.png" src="_images/tut02_intro_class_ReadGridded_37_1.png" />
</div>
</div>
</div>
<div class="section" id="the-griddeddata-class">
<h2>The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#the-griddeddata-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces the
<a class="reference external" href="http://aerocom.met.no/pya/api.html#pya.griddeddata.GriddedData">GriddedData</a>
class of pyaerocom. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is the fundamental base
class for the analysis of model data. The underlying data type is
<a class="reference external" href="http://scitools.org.uk/iris/docs/latest/iris/iris/cube.html#iris.cube.Cube">iris.cube.Cube</a>
which was extended, for instance by allowing direct imports of netCDF
files when creating an instance of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> (i.e. by passing the
filename and specifying the variable name on initialisation). This
notebook introduces some of the features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.
Starting with some imports:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">filterwarnings</span>
<span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.017</span> <span class="n">s</span>
</pre></div>
</div>
<p>Let’s get a test file to load</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aatsr_su_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mf">3.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2008.</span><span class="n">nc</span>

<span class="n">ecmwf_osuite</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span>
</pre></div>
</div>
<p>Let’s pick out the ECMWF OSUITE test file and load the data directly
into an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class
takes either preloaded instances of the <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code> class as
input, or a valid netCDF file path. The latter requires specification of
the variable name which is then filtered from the data stored in the
netCDF file (which may contain multiple variables. The following example
imports the data for the aerosol optical density at 550 nm. The string
representation of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class (see print at end of
following code cell) was slitghtly adapted from the underlying <code class="docutils literal notranslate"><span class="pre">Cube</span></code>
object.</p>
<div class="section" id="read-ecmwf-osuite-aod-data">
<h3>Read ECMWF OSUITE AOD data<a class="headerlink" href="#read-ecmwf-osuite-aod-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fpath</span> <span class="o">=</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">][</span><span class="s2">&quot;ecmwf_osuite&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">data_id</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550aer</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_OSUITE</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                                 <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                             <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                            <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.0</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="mf">4.7</span><span class="o">.</span><span class="mi">2</span>
          <span class="n">computed</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">concatenated</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">data_id</span><span class="p">:</span> <span class="n">ECMWF_OSUITE</span>
          <span class="n">from_files</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/rename...</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncks</span> <span class="o">-</span><span class="mi">7</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">v</span> <span class="n">time_bnds</span> <span class="n">od550aer</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">orig</span><span class="o">.</span><span class="n">nc</span>
<span class="n">Tue</span><span class="o">...</span>
          <span class="n">history_of_appended_files</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">15</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">Appended</span> <span class="n">file</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">/</span><span class="n">renamed</span><span class="o">//</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550bc</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">invalid_units</span><span class="p">:</span> <span class="o">~</span>
          <span class="n">is_at_stations</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
          <span class="n">outliers_removed</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">reader</span><span class="p">:</span> <span class="kc">None</span>
          <span class="n">region</span><span class="p">:</span> <span class="kc">None</span>
          <span class="n">regridded</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
          <span class="n">var_name</span><span class="p">:</span> <span class="n">od550aer</span>
          <span class="n">var_name_read</span><span class="p">:</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
          <span class="n">vert_code</span><span class="p">:</span>
          <span class="n">year</span><span class="p">:</span> <span class="mi">2018</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
</div>
<div class="section" id="remark-on-longitude-definition">
<h3>Remark on longitude definition<a class="headerlink" href="#remark-on-longitude-definition" title="Permalink to this headline">¶</a></h3>
<div class="alert alert-block alert-info docutils container">
<p>If the longitudes in the original NetCDF file are defined as:</p>
<div class="math notranslate nohighlight">
\[0 \leq\,\text{lon}\,\leq360\]</div>
<p>then, pyaerocom converts automatically to:</p>
<div class="math notranslate nohighlight">
\[-180\leq\,\text{lon}\,\leq180\]</div>
<p>when an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is created (see print
statment above <em>Rolling longitudes to -180 -&gt; 180 definition</em>). This
is, for instance, the case for the ECMWF OSUITE data files.</p>
</div>
</div>
<div class="section" id="basic-attributes-of-the-griddeddata-class">
<h3>Basic attributes of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#basic-attributes-of-the-griddeddata-class" title="Permalink to this headline">¶</a></h3>
<p>In the following cells, some of the most important attributes are
introduced. These are mostly reimplementations of the underlying
<code class="docutils literal notranslate"><span class="pre">iris.Cube</span></code> data object, which is stored in and can be accessed via
the <code class="docutils literal notranslate"><span class="pre">GriddedData.cube</span></code> attribute. For instance the attribute
<code class="docutils literal notranslate"><span class="pre">GriddedData.longitude</span></code> will access
<code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;longitude&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">GriddedData.latitude</span></code> will
return <code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;latitude&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData.time</span></code>
will return the time dimension array
(<code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;time&quot;)</span></code>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">data_id</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;ECMWF_OSUITE&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">var_name</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;od550aer&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">units</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">ts_type</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;daily&#39;</span>
</pre></div>
</div>
<p>Side note: the unit is obviously not specified in this dataset, which is
part of the game, unfortunately, when working with external data…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">DimCoord</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">179.60000610351562</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">DimCoord</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">DimCoord</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">364.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tstamps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tstamps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tstamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>If you do not specify the variable type, an Exception is raised, that
will get you some information about what variables are available in the
file (if the file is readable using the <code class="docutils literal notranslate"><span class="pre">iris.load</span></code> method).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pya</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NetcdfError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s2">&quot;Could not load single cube from /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc. Please specify var_name. Input file contains the following variables: [&#39;od550aer&#39;, &#39;od550dust&#39;, &#39;od550bc&#39;, &#39;od550so4&#39;, &#39;od550oa&#39;]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, if you parse an invalid variable name, you will get some hint.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Blaaa&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This also did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">also</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s1">&#39;Variable Blaaa not available in file /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can have a quick look at the data using the class-own quickplot
method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_over</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_26_0.png" src="_images/tut04_intro_class_GriddedData_26_0.png" />
<p>Why not load some of the other variables…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550bc&quot;</span><span class="p">,</span> <span class="n">data_id</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_so4</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550so4&quot;</span><span class="p">,</span> <span class="n">data_id</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550bc</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
<span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550so4</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<p>… and plot them as well</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bc</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_30_0.png" src="_images/tut04_intro_class_GriddedData_30_0.png" />
</div>
<div class="section" id="apply-custom-crop-and-plot">
<h3>Apply custom crop and plot<a class="headerlink" href="#apply-custom-crop-and-plot" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_so4_cropped</span> <span class="o">=</span> <span class="n">data_so4</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">lon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                                 <span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>

<span class="n">data_so4_cropped</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="s1">&#39;25-2-2018&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_32_0.png" src="_images/tut04_intro_class_GriddedData_32_0.png" />
</div>
<div class="section" id="change-resolution">
<h3>Change resolution<a class="headerlink" href="#change-resolution" title="Permalink to this headline">¶</a></h3>
<p>Downscale to 2x2 resolution:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">data_lowres</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">lats</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<p>And plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span><span class="n">data_lowres</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_36_0.png" src="_images/tut04_intro_class_GriddedData_36_0.png" />
</div>
<div class="section" id="area-weighted-mean">
<h3>Area weighted mean<a class="headerlink" href="#area-weighted-mean" title="Permalink to this headline">¶</a></h3>
<p>Retrieve area weighted mean from data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_area_weighted_timeseries</span><span class="p">()</span>
<span class="n">area_mean</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Trying</span> <span class="n">to</span> <span class="n">infer</span> <span class="n">ts_type</span> <span class="ow">in</span> <span class="n">StationData</span> <span class="n">ECMWF_OSUITE</span> <span class="k">for</span> <span class="n">variable</span> <span class="n">od550aer</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_38_1.png" src="_images/tut04_intro_class_GriddedData_38_1.png" />
<div class="section" id="more-to-come">
<h4>… more to come<a class="headerlink" href="#more-to-come" title="Permalink to this headline">¶</a></h4>
<p>This tutorial is not yet completed as the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is
currently under development.</p>
</div>
</div>
</div>
<div class="section" id="reading-of-ungridded-observation-datasets-in-pyaerocom">
<h2>Reading of ungridded observation datasets in pyaerocom<a class="headerlink" href="#reading-of-ungridded-observation-datasets-in-pyaerocom" title="Permalink to this headline">¶</a></h2>
<div class="section" id="primer-on-observation-datasets">
<h3>Primer on observation datasets<a class="headerlink" href="#primer-on-observation-datasets" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Observation data is often provided ungridded in the form of ASCII
text files that contain both the data and relevant metadata.</p></li>
<li><p>In <strong>pyaerocom</strong> such datasets are referred to as <strong>ungridded data</strong>
since it is sparse observations at different locations and at
different times.</p></li>
<li><p>The format of the files can be very different between different
observation networks but is usually the same for all data files that
belong to one network.</p></li>
<li><p>The data files are often provided <strong>per station</strong>, that is, <strong>one
data file</strong> contains data (i.e. time-series data of one or more
variables and metadata such as <em>station name, latitude, longitude,
altitude, PI</em> <strong>from a single station</strong></p>
<ul>
<li><p>Other than model data (which often follows certain file standards,
e.g. NetCDF files and naming conventions,
e.g. <a class="reference external" href="http://cfconventions.org/">CF-conventions</a></p></li>
</ul>
</li>
<li><p>For some databases, there is exactly one file per station (containing
all available data from that station). This is the case in the
example dataset shown below (Aeronet Sun version 3 level2 daily
data). However, the general case is that there may be more than one
file per station (the <a class="reference external" href="http://ebas.nilu.no/">EBAS</a> database is
such an example, where there can be multiple data files per station,
<a class="reference external" href="https://pyaerocom.met.no/tutorials.html#merging-of-several-stationdata-objects-into-one">see this
notebook</a>
for an example of how complicated it may get).</p></li>
</ul>
</div>
<div class="section" id="data-access">
<h3>Data access<a class="headerlink" href="#data-access" title="Permalink to this headline">¶</a></h3>
<p>Both the model and the observation datasets related to the AeroCom
project are stored on internal servers at the Norwegian Meteorological
Institute (METNO). On import, pyaerocom automatically checks if it can
access the METNO servers containing the data.</p>
<p>The data directory of each dataset can be accessed via an <em>unique ID</em>
for the dataset. These ID’s can be a little cryptic sometimes and parts
of this tutorial show, how to find the data you search for, regardless
whether you know the exact pyaerocom ID or not.</p>
<p>For instance, below we are going to work with AERONET Sun photometer
data, using the version 3, level 2 daily data product. The corresponding
ID for this dataset in pyaerocom is <strong>AeronetSunV3Lev2.daily</strong>.</p>
</div>
<div class="section" id="note">
<h3><strong>NOTE</strong><a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<p><strong>This notebook requires access to the AeroCom database and will not
work if you do not have access to the AeroCom servers at METNO</strong></p>
</div>
<div class="section" id="if-you-run-into-problems">
<h3>If you run into problems<a class="headerlink" href="#if-you-run-into-problems" title="Permalink to this headline">¶</a></h3>
<p>Please <a class="reference external" href="https://github.com/metno/pyaerocom/issues">create an issue</a>
if you run into problems or have suggestions for improvements.</p>
</div>
<div class="section" id="reading-of-and-investigating-aeronet-sun-aods-version-3-level-2-data">
<h3>Reading of and investigating Aeronet Sun AODs (version 3, level 2 data)<a class="headerlink" href="#reading-of-and-investigating-aeronet-sun-aods-version-3-level-2-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.018</span> <span class="n">s</span>
</pre></div>
</div>
<p>Check version of pyaerocom:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">__version__</span> <span class="c1">#0.8.0.dev6</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;0.8.0rc4&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="search-data-id-for-aeronet-sun-version-2-level-2-daily-data">
<h3>Search data ID for Aeronet Sun version 2 level 2, daily data<a class="headerlink" href="#search-data-id-for-aeronet-sun-version-2-level-2-daily-data" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">browse_database</span></code> method helps you to find model or observation
datasets.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;Aeronet*Sun*V3*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">AP</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev1</span><span class="o">.</span><span class="mf">5.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190511</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">AP</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">AP</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190511</span>
</pre></div>
</div>
<p>You can see that there are three matches that can be read. The attribute
<code class="docutils literal notranslate"><span class="pre">dataset_name</span></code> specifies the ID that we are looking for that is
required to read the data.</p>
<p>Below, we are interested in the following dataset:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_ID</span> <span class="o">=</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="pick-one-or-more-variable-s-of-interest">
<h3>Pick one (or more) variable(s) of interest<a class="headerlink" href="#pick-one-or-more-variable-s-of-interest" title="Permalink to this headline">¶</a></h3>
<p>From the output above, you can also see which variables the individual
datasets provide. The variable names follow AeroCom conventions and you
can find more information (e.g. CF standard names) about each variable
<a class="reference external" href="https://pyaerocom.met.no/config_files.html#variables">here</a>.</p>
<p>In the following we will import the aerosol optical depth data at 550 nm
(<code class="docutils literal notranslate"><span class="pre">od550aer</span></code>)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VAR_TO_READ</span> <span class="o">=</span> <span class="s1">&#39;od550aer&#39;</span> <span class="c1"># you can also use a list of supported variables if you like, e.g. (od550aer, od440aer)</span>
</pre></div>
</div>
</div>
<div class="section" id="read-the-aods-from-the-whole-database-all-available-stations-times-using-the-readungridded-class">
<h3>Read the AODs from the whole database (all available stations / times) using the ReadUngridded class<a class="headerlink" href="#read-the-aods-from-the-whole-database-all-available-stations-times-using-the-readungridded-class" title="Permalink to this headline">¶</a></h3>
<p>Since the dataformats are usually specific for each observation dataset
/ network, each supported dataset has it’s own reading routine in
pyaerocom. The individual reading routines can be found in the
<code class="docutils literal notranslate"><span class="pre">pyaerocom.io</span></code> module. For instance, the class</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_aeronet_sunv3</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span>
</pre></div>
</div>
<p>contains the reading methods for the Aeronet Sun version 3 dataset that
we are interested in.</p>
<p>However in order to make life easier for everyone, all implemented
<em>individual reading routines</em> for <em>each individual dataset</em> are
registered in the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=readungridded#pyaerocom.io.readungridded.ReadUngridded">ReadUngridded</a>
factory class, which has registered these <em>individual reading routines</em>
(this works, becuase the invididual reading routines are all based on
the same API
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=readungridded#pyaerocom.io.readungriddedbase.ReadUngriddedBase">template</a>).</p>
<p>Here, <em>registered</em> means, that the <em>dataset ID</em> of one network is linked
with the corresponding reading class.</p>
<p>Having said that, it means that calling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span><span class="p">(</span><span class="n">vars_to_read</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will give you exactly the same result as calling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">dataset_to_read</span><span class="o">=</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span>
                            <span class="n">vars_to_read</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The returned data object is an instance of the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=ungriddeddata#pyaerocom.ungriddeddata.UngriddedData">UngriddedData</a>
class which is the pyaerocom standard object for ungridded data and
which is designed to hold a whole dataset of observation records
(i.e. data from all stations).</p>
</div>
<div class="section" id="create-instance-of-readungridded-class">
<h3>Create instance of ReadUngridded class<a class="headerlink" href="#create-instance-of-readungridded-class" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20190920</span>
</pre></div>
</div>
<p>You may also check, which other datasets are supported by the
<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span><span class="o">.</span><span class="n">supported_datasets</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AeronetInvV3Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetInvV3Lev1.5.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetInvV2Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetInvV2Lev1.5.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSDAV2Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSDAV3Lev1.5.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSDAV3Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV2Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV2Lev2.AP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV3Lev1.5.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV3Lev1.5.AP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AeronetSunV3Lev2.AP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EARLINET&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EBASMC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DMS_AMS_CVO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="read-the-dataset">
<h3>Read the dataset<a class="headerlink" href="#read-the-dataset" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">read</span></code> method loops over all files that exist for this dataset and
reads them into one data object (<code class="docutils literal notranslate"><span class="pre">data</span></code>) which contains the whole
dataset.</p>
<p><strong>NOTE</strong>: this can take a while as it has to read ~1000 files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="n">VAR_TO_READ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">meta</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span> <span class="mi">1230</span>
</pre></div>
</div>
<p>That’s it! That is all that is required to import an ungridded dataset.</p>
<p>The data object that is returned by the <code class="docutils literal notranslate"><span class="pre">read</span></code> method is an instance
of the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=ungriddeddata#pyaerocom.ungriddeddata.UngriddedData">pyaerocom.UngriddedData</a>
class.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object provides an interface that can be used to
work with the data and further analyse it.</p>
<p>From the output above, you can see that this datasets contains 1199
<em>meta-blocks</em>, that is, one meta block per data file that was read.
Since for this database, each station has exactly one datafile, this
means that each meta-block corresponds to one station.</p>
<p>The next tutorial is based on this tutorial and will introduce the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class and furthermore, the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> class.</p>
<p>However, before ending this tutorial without a plot, let’s have a
glimpse at the features of the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object that we just
created:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut05_intro_ungridded_reading_22_0.png" src="_images/tut05_intro_ungridded_reading_22_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_timeseries</span><span class="p">(</span><span class="s1">&#39;Solar*&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut05_intro_ungridded_reading_23_0.png" src="_images/tut05_intro_ungridded_reading_23_0.png" />
<p>Finally, store the data object so that it can be used in the next
tutorial:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">store</span> data
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Stored</span> <span class="s1">&#39;data&#39;</span> <span class="p">(</span><span class="n">UngriddedData</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="introduction-into-the-ungriddeddata-class-and-the-stationdata-class">
<h2>Introduction into the UngriddedData class and the StationData class<a class="headerlink" href="#introduction-into-the-ungriddeddata-class-and-the-stationdata-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces 2 of the most relevant data objects that exist
in pyaerocom:</p>
<p><strong>``UngriddedData``</strong></p>
<ul class="simple">
<li><p>Designed to hold a whole database of observations, that is,
timeseries data for multiple variables from multiple stations around
the globe.</p></li>
<li><p>Supports also 3D variables (e.g. timeseries of lidar profiles).</p></li>
<li><p>Usually, one instance of this data object contains a single network,
but it can also contain more than one network.</p></li>
</ul>
<p><strong>``StationData``</strong></p>
<ul class="simple">
<li><p>Data object that contains data <strong>from a single station</strong>.</p></li>
<li><p>Includes metadata and variable timeseries data.</p></li>
<li><p>Arbitrary number of variables supported.</p></li>
</ul>
<div class="section" id="id1">
<h3>NOTE<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This notebook is currently under development and gives only a brief and
incomplete introduction into the two data objects.</p>
</div>
<div class="section" id="the-ungriddeddata-object">
<h3>The <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object<a class="headerlink" href="#the-ungriddeddata-object" title="Permalink to this headline">¶</a></h3>
<p>The first part of the tutorial shows some features of the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object.</p>
<div class="section" id="import-the-ungriddeddata-object-that-was-created-in-the-previous-tutorial">
<h4>Import the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object that was created in the previous tutorial<a class="headerlink" href="#import-the-ungriddeddata-object-that-was-created-in-the-previous-tutorial" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="c1"># read the data from the storage</span>
<span class="o">%</span><span class="k">store</span> -r data

<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.027</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UngriddedData</span> <span class="o">&lt;</span><span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">];</span> <span class="nb">vars</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">];</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">];</span><span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">1230</span>
</pre></div>
</div>
</div>
<div class="section" id="create-an-overview-map-of-all-stations">
<h4>Create an overview map of all stations<a class="headerlink" href="#create-an-overview-map-of-all-stations" title="Permalink to this headline">¶</a></h4>
<p>Before digging a little deeper into the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object, let’s
get an overview of the bigger picture:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plots all stations as red dots</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="c1"># add all stations that contain AOD data in 2010 in green</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
                                   <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                   <span class="n">stop</span><span class="o">=</span><span class="mi">2011</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_4_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_4_0.png" />
<p>As you can see, you can specify additional input parameters, e.g. to
display only stations that contain variable data or to specify a time
interval.</p>
<p>In any case, it is always good to know about the help function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on method plot_station_coordinates in module pyaerocom.ungriddeddata:

plot_station_coordinates(var_name=None, filter_name=None, start=None, stop=None, ts_type=None, color='r', marker='o', markersize=8, fontsize_base=10, <a href="#id2"><span class="problematic" id="id3">**</span></a>kwargs) method of pyaerocom.ungriddeddata.UngriddedData instance
    Plot station coordinates on a map

    All input parameters are optional and may be used to add constraints
    related to which stations are plotted. Default is all stations of all
    times.

    Parameters
    ----------

    var_name : <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional
        name of variable to be retrieved
    filter_name : <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional
        name of filter (e.g. EUROPE-noMOUNTAINS)
    start
        start time (optional)
    stop
        stop time (optional). If start time is provided and stop time not,
        then only the corresponding year inferred from start time will be
        considered
    ts_type : <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional
        temporal resolution
    color : str
        color of stations on map
    marker : str
        marker type of stations
    markersize : int
        size of station markers
    fontsize_base : int
        basic fontsize
    <a href="#id4"><span class="problematic" id="id5">**</span></a>kwargs
        Addifional keyword args passed to
        <code class="xref py py-func docutils literal notranslate"><span class="pre">pyaerocom.plot.plot_coordinates()</span></code>

    Returns
    -------
    axes
        matplotlib axes instance</pre>
</div>
<div class="section" id="quicklook-plotting-of-station-timeseries">
<h4>Quicklook plotting of station timeseries<a class="headerlink" href="#quicklook-plotting-of-station-timeseries" title="Permalink to this headline">¶</a></h4>
<p>Time series of individual stations can be plotted as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_timeseries</span><span class="p">(</span><span class="n">station_name</span><span class="o">=</span><span class="s1">&#39;Granada&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_8_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_8_0.png" />
</div>
<div class="section" id="access-metadata-of-the-data-files-that-were-read">
<h4>Access metadata of the data files that were read<a class="headerlink" href="#access-metadata-of-the-data-files-that-were-read" title="Permalink to this headline">¶</a></h4>
<p>Look into the metadata of the different files. Metadata can be accessed
via the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> attribute, and there is one metadatadictionary for
each file that was read:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1230</span>
</pre></div>
</div>
<p>Access metadata of first file (index 0):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;var_info&#39;</span><span class="p">,</span>
              <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)]))])),</span>
             <span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mf">45.3139</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mf">12.508299999999998</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">,</span> <span class="s1">&#39;AAOT&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="s1">&#39;Brent_Holben&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_id&#39;</span><span class="p">,</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;variables&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]),</span>
             <span class="p">(</span><span class="s1">&#39;instrument_name&#39;</span><span class="p">,</span> <span class="s1">&#39;sun_photometer&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_revision&#39;</span><span class="p">,</span> <span class="s1">&#39;20190920&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering-of-the-data">
<h4>Filtering of the data<a class="headerlink" href="#filtering-of-the-data" title="Permalink to this headline">¶</a></h4>
<p>So far, you can filter <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> objects by common metadata
attributes. For instance:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filter_by_meta</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">longitude</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="n">altitude</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">meta</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span> <span class="mi">164</span>
<span class="n">Filters</span> <span class="n">that</span> <span class="n">were</span> <span class="n">applied</span><span class="p">:</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20191012154631</span>
    <span class="n">latitude</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">longitude</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
    <span class="n">altitude</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_15_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_15_0.png" />
</div>
<div class="section" id="other-attributes-that-may-be-useful">
<h4>Other attributes that may be useful<a class="headerlink" href="#other-attributes-that-may-be-useful" title="Permalink to this headline">¶</a></h4>
<p>Access all station names and print the first 4:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">station_name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stat_names</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AAOT&#39;</span><span class="p">,</span> <span class="s1">&#39;AOE_Baotou&#39;</span><span class="p">,</span> <span class="s1">&#39;ARM_Ascension_Is&#39;</span><span class="p">,</span> <span class="s1">&#39;ARM_Barnstable_MA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Essentially, what <code class="docutils literal notranslate"><span class="pre">data.station_name</span></code> does is, it iterates over all
metadata-dictionaries (that are stored in <code class="docutils literal notranslate"><span class="pre">data.metadata</span></code>, and are
organised <em>per file that was read</em>) and extracts the <code class="docutils literal notranslate"><span class="pre">station_name</span></code>
attribute and appends it to a list which is then returned by the method.</p>
<p>Hence, the list of station names corresponds to the list of
metadata-blocks / files that are stored in the data object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">stat_names</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1230</span>
</pre></div>
</div>
<p>In a similar manner, you can access coordinates latitude, longitude and
altitude arrays for all files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lons</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">longitude</span>
<span class="n">lons</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">12.508299999999998</span><span class="p">,</span>
 <span class="mf">109.62879999999998</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">14.349805999999996</span><span class="p">,</span>
 <span class="o">-</span><span class="mf">70.29006100000001</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span>
<span class="n">lats</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">45.3139</span><span class="p">,</span> <span class="mf">40.851699999999994</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.966963999999998</span><span class="p">,</span> <span class="mf">41.669588999999995</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">altitude</span>
<span class="n">alts</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">1314.0</span><span class="p">,</span> <span class="mf">341.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="list-of-unique-station-names">
<h4>List of unique station names<a class="headerlink" href="#list-of-unique-station-names" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, some databases provide more than one data file per
station. Since the ungridded reading (see previous) tutorial is done
<em>per data file</em>, this means that their can be more than one
metadata-block per station (not the case here, though). In any case, you
can get a list of unique station names using:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">unique_station_names</span>
<span class="n">unique_names</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AAOT&#39;</span><span class="p">,</span> <span class="s1">&#39;AOE_Baotou&#39;</span><span class="p">,</span> <span class="s1">&#39;ARM_Ascension_Is&#39;</span><span class="p">,</span> <span class="s1">&#39;ARM_Barnstable_MA&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stationdata-access-the-data-from-individual-stations">
<h3><code class="docutils literal notranslate"><span class="pre">StationData</span></code>: Access the data from individual stations<a class="headerlink" href="#stationdata-access-the-data-from-individual-stations" title="Permalink to this headline">¶</a></h3>
<p>As you could see above the metadata dictionaries in the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class for each file do only contain the associated
metadata. For the sake of performance the actual data arrays are all
stored in one big 2D numpy array (which does not need to bother you too
much) which is accessible in the <code class="docutils literal notranslate"><span class="pre">_data</span></code> attribute of the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object (if you like to dive into it).</p>
<p><strong>In most cases that concern model evaluation, the observation data is
analysed station-by-station. For this purpose the StationData class was
designed, which is introduced below.</strong></p>
<p>Starting from an instance of the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object, the
individual station data (i.e. time series of one or more variables +
metadata) can be accessed using the method:</p>
<p><a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=to_station_data#pyaerocom.ungriddeddata.UngriddedData.to_station_data">UngriddedData.to_station_data</a></p>
<p>or using the square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> which is equivalent to the former as
it is only a wrapper for <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code>. This meants, calling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UngriddedData</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>will give you the same output as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UngriddedData</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>that is, the data associated with the first file that was read (i.e. the
first metadata-block in the object) into the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object
(see previous tutorial for details regarding the reading of ungridded
observation networks).</p>
<p>To specify the station, you can either use the metadata index of the
corresponding data file (<code class="docutils literal notranslate"><span class="pre">meta_idx=9</span></code>, for 10th file) <strong>or</strong> you can
specify the station name or a wildcard specifying the station name.</p>
<p>The method returns a
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=stationdata#pyaerocom.stationdata.StationData">pyaerocom.StationData</a>
object, which is a dictionary-like object which contains data vectors
and time-stamps as well as metadata.</p>
<p>Below we will illustrate the several options to access station data (and
show that they contain the same data):</p>
<div class="section" id="option-1-get-station-data-using-the-corresponding-metadata-indices-that-match-the-station-name">
<h4>Option 1. Get station data using the corresponding metadata indices that match the station name<a class="headerlink" href="#option-1-get-station-data-using-the-corresponding-metadata-indices-that-match-the-station-name" title="Permalink to this headline">¶</a></h4>
<p>Find index (or indices) that match the station name:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find_station_meta_indices</span><span class="p">(</span><span class="s1">&#39;Granada&#39;</span><span class="p">)</span>
<span class="n">index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">497.0</span><span class="p">]</span>
</pre></div>
</div>
<p>The result shows that there is one file that matches this station name
(as we would expect for AERONET data) and the corresponding metadata
index is 488.</p>
<p>To access the data, you can use the method <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code>. It helps
to have a look into the options of this method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on method to_station_data in module pyaerocom.ungriddeddata:

to_station_data(meta_idx, vars_to_convert=None, start=None, stop=None, freq=None, merge_if_multi=True, merge_pref_attr=None, merge_sort_by_largest=True, insert_nans=False, <a href="#id6"><span class="problematic" id="id7">**</span></a>kwargs) method of pyaerocom.ungriddeddata.UngriddedData instance
    Convert data from one station to <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code>

    Todo
    ----
    - Review for retrieval of profile data (e.g. Lidar data)

    Parameters
    ----------
    meta_idx : float
        index of station or name of station.
    vars_to_convert : <code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional
        variables that are supposed to be converted. If None, use all
        variables that are available for this station
    start
        start time, optional (if not None, input must be convertible into
        pandas.Timestamp)
    stop
        stop time, optional (if not None, input must be convertible into
        pandas.Timestamp)
    freq : str
        pandas frequency string (e.g. 'D' for daily, 'M' for month end) or
        valid pyaerocom ts_type
    merge_if_multi : bool
        if True and if data request results in multiple instances of
        StationData objects, then these are attempted to be merged into one
        <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code> object using <code class="xref py py-func docutils literal notranslate"><span class="pre">merge_station_data()</span></code>
    merge_pref_attr
        only relevant for merging of multiple matches: preferred attribute
        that is used to sort the individual StationData objects by relevance.
        Needs to be available in each of the individual StationData objects.
        For details cf. <code class="xref py py-attr docutils literal notranslate"><span class="pre">pref_attr</span></code> in docstring of
        <code class="xref py py-func docutils literal notranslate"><span class="pre">merge_station_data()</span></code>. Example could be <cite>revision_date</cite>. If
        None, then the stations will be sorted based on the number of
        available data points (if <code class="xref py py-attr docutils literal notranslate"><span class="pre">merge_sort_by_largest</span></code> is True,
        which is default).
    merge_sort_by_largest : bool
        only relevant for merging of multiple matches: cf. prev. attr. and
        docstring of <code class="xref py py-func docutils literal notranslate"><span class="pre">merge_station_data()</span></code> method.
    insert_nans : bool
        if True, then the retrieved <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code> objects are filled
        with NaNs

    Returns
    -------
    StationData or list
        StationData object(s) containing results. list is only returned if
        input for meta_idx is station name and multiple matches are
        detected for that station (e.g. data from different instruments),
        else single instance of StationData. All variable time series are
        inserted as pandas Series</pre>
<p>So the first input argument takes either the metadata index, or the name
of the station. Here we use the metadata index option using the index
that we just retrieved:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="n">meta_idx</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">insert_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">granada_opt1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">stationdata</span><span class="o">.</span><span class="n">StationData</span>
</pre></div>
</div>
<p>The returned data type is an instance of the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=stationdata#pyaerocom.stationdata.StationData">pyaerocom.StationData</a>
class.</p>
<p><strong>NOTE:</strong> if there is more than one index match for one station
(i.e. <code class="docutils literal notranslate"><span class="pre">data.find_station_meta_indices('Granada')</span></code> returns more than
one match), then, using Option 1, you would need to call
<code class="docutils literal notranslate"><span class="pre">to_station_data</span></code> for each of the index matches. Alternatively you
could use either of the following methods, which automatically merge the
individual <code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects into one, in case of multiple matches
for that station name.</p>
<p>Let’s have a quick look at the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object (it is a
dictionary-like object and simple to use):</p>
</div>
<div class="section" id="option-2-retrieve-station-data-using-the-station-name-directly">
<h4>Option 2: Retrieve station data using the station name directly<a class="headerlink" href="#option-2-retrieve-station-data-using-the-station-name-directly" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Granada&#39;</span><span class="p">,</span> <span class="n">insert_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Other than option 1, in case of multiple meta-index matches, this method
automatically merges the individual data objects.</p>
</div>
<div class="section" id="option-3-use-notation">
<h4>Option 3: Use […] notation<a class="headerlink" href="#option-3-use-notation" title="Permalink to this headline">¶</a></h4>
<p>This is a wrapper for the method <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code> so you may use
meta-index or station name for access.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt3_1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">granada_opt3_2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Granada&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="lets-have-a-look-if-the-data-objects-are-really-the-same-by-plotting-the-aod-timeseries-for-the-4-different-options">
<h4>Let’s have a look if the data objects are really the same (by plotting the AOD timeseries for the 4 different options):<a class="headerlink" href="#lets-have-a-look-if-the-data-objects-are-really-the-same-by-plotting-the-aod-timeseries-for-the-4-different-options" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Option 1&#39;</span><span class="p">,</span> <span class="n">tit</span><span class="o">=</span><span class="s1">&#39;Method: UngriddedData.to_station_data()&#39;</span><span class="p">)</span>
<span class="n">granada_opt2</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Option 2&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># plot the results from the [] access option into a new figure (don&#39;t pass ax)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt3_1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Option 3.1 (using meta-index)&#39;</span><span class="p">,</span>
                                    <span class="n">tit</span><span class="o">=</span><span class="s1">&#39;Method: UngriddedData[]&#39;</span><span class="p">)</span>
<span class="n">granada_opt3_2</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Option 3.2 (using station name)&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f26edf9d898</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_41_1.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_41_1.png" />
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_41_2.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_41_2.png" />
<p>Looks good. Let’s explore the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object a little more (you
can print it and it will get you a nice overview):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">granada_opt1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">od550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
    <span class="n">apply_constraints</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">min_num_obs</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">37.163999999999994</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.6049999999999995</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">680.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">filename</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_id</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Granada</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">sun_photometer</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Brent_Holben</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">37.163999999999994</span>
<span class="n">longitude</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.6049999999999995</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">680.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20190920</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">5087</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">2004</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">30</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2004</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">02</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">03</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">od550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">5087</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object contains both metadata
(e.g. <code class="docutils literal notranslate"><span class="pre">PI</span></code>) and data vectors which can be either 1D numpy arrays or
python lists (e.g. <code class="docutils literal notranslate"><span class="pre">dtime</span></code>) or <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> objects
(e.g. variable <code class="docutils literal notranslate"><span class="pre">od550aer</span></code>). All attributes can be accessed and
manipulated either using dictionary style access (i.e. <code class="docutils literal notranslate"><span class="pre">[]</span></code> notation),
or using the <code class="docutils literal notranslate"><span class="pre">.</span></code> operator.</p>
<p>Here some examples:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get longitude using &quot;[]&quot; notation</span>
<span class="n">granada_opt1</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">3.6049999999999995</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get longitude using &quot;.&quot; notation</span>
<span class="n">granada_opt1</span><span class="o">.</span><span class="n">longitude</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">3.6049999999999995</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># assign longitude using &quot;.&quot; notation and display new value (again using &quot;[]&quot; notation)</span>
<span class="n">granada_opt1</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">granada_opt1</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">42</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt1</span><span class="p">[</span><span class="s1">&#39;station_name&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Granada&#39;</span>
</pre></div>
</div>
<p>Get station name:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt1</span><span class="o">.</span><span class="n">station_name</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Granada&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="small-detour-through-the-pandas-world">
<h4>Small detour through the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> world<a class="headerlink" href="#small-detour-through-the-pandas-world" title="Permalink to this headline">¶</a></h4>
<p>As you can see in the output above, the time-series data in the
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> object is an instance of the <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_data</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">od550aer</span>
<span class="nb">type</span><span class="p">(</span><span class="n">aod_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: pyaerocom relies on pandas, so if you are not familiar with
the pandas library, it is a good advice to make yourself familiar with
it (especially if you are interested in timeseries analysis). See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html">here
for a short introduction into
pandas</a>.</p>
<p>Anyways, you should know about the 2 basic datatypes of pandas which
are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">pandas.Series</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame%20.html">pandas.DataFrame</a></p></li>
</ul>
<p>Both objects are very similar in their handling and the <code class="docutils literal notranslate"><span class="pre">Series</span></code> class
can be imagined as a <em>single column</em> of the <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code> object which
is a table-like object that has columns (e.g. variables) and rows
(e.g. time-stamps). It is hence, easy to go back and forth between the
two objects.</p>
<p>Anyways, here is some examples what you can do with an instance of the
<code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> object that we just accessed from the
<code class="docutils literal notranslate"><span class="pre">pyaerocom.StationData</span></code> object from Granada (and which we named
<code class="docutils literal notranslate"><span class="pre">aod_data</span></code>).</p>
<p>First, you can get a basic clue about the data by using the <code class="docutils literal notranslate"><span class="pre">describe</span></code>
method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">count</span>    <span class="mf">3010.000000</span>
<span class="n">mean</span>        <span class="mf">0.137759</span>
<span class="n">std</span>         <span class="mf">0.103330</span>
<span class="nb">min</span>         <span class="mf">0.015534</span>
<span class="mi">25</span><span class="o">%</span>         <span class="mf">0.070969</span>
<span class="mi">50</span><span class="o">%</span>         <span class="mf">0.108200</span>
<span class="mi">75</span><span class="o">%</span>         <span class="mf">0.171291</span>
<span class="nb">max</span>         <span class="mf">1.278507</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Second, you may plot it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_data</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_56_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_56_0.png" />
<p>Third, you may extract subsets using <em>fancy indexing</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_data_march2010</span> <span class="o">=</span> <span class="n">aod_data</span><span class="p">[</span><span class="s1">&#39;2010-3-1&#39;</span><span class="p">:</span><span class="s1">&#39;2010-4-1&#39;</span><span class="p">]</span>
<span class="n">aod_data_march2010</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_58_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_58_0.png" />
<p>Or fourth, resample to another frequency:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_data_monthly</span> <span class="o">=</span> <span class="n">aod_data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">aod_data_monthly</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_60_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_60_0.png" />
<p>Or fifth, resample to lower frequency, but require a minimum number of
observations per period:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_with_count</span> <span class="o">=</span> <span class="n">aod_data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="n">monthly_with_count</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2004-12-31</td>
      <td>0.056462</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2005-01-31</td>
      <td>0.081300</td>
      <td>28</td>
    </tr>
    <tr>
      <td>2005-02-28</td>
      <td>0.111567</td>
      <td>24</td>
    </tr>
    <tr>
      <td>2005-03-31</td>
      <td>0.156312</td>
      <td>17</td>
    </tr>
    <tr>
      <td>2005-04-30</td>
      <td>0.154527</td>
      <td>26</td>
    </tr>
  </tbody>
</table>
</div><p>Now, here you see an example, where <code class="docutils literal notranslate"><span class="pre">pandas</span></code> automatically converted
our Series (which is single variable) to a DataFrame (which is a table),
since we told the resampler above, to aggregate monthly mean and monthly
count.</p>
<p>Now let’s say we require at least 15 observations (here, days, since our
original dataset is in daily resolution) per month:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invalid_mask</span> <span class="o">=</span> <span class="n">monthly_with_count</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">15</span>
<span class="n">monthly_with_count</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">][</span><span class="n">invalid_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">aod_monthly_min15d</span> <span class="o">=</span> <span class="n">monthly_with_count</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="n">aod_monthly_min15d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2004</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span>         <span class="n">NaN</span>
<span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">31</span>    <span class="mf">0.081300</span>
<span class="mi">2005</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span>    <span class="mf">0.111567</span>
<span class="mi">2005</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">31</span>    <span class="mf">0.156312</span>
<span class="mi">2005</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">30</span>    <span class="mf">0.154527</span>
<span class="n">Freq</span><span class="p">:</span> <span class="n">M</span><span class="p">,</span> <span class="n">Name</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Now plot both the monthly timeseries from above without constraint and
the one with constraint:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">aod_data_monthly</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly without constraint&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">aod_monthly_min15d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;x-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly (at least 15 days per month)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_66_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_66_0.png" />
<p>As you can see, there is quite some months missing when applying the
filter.</p>
<p>You may also be intersted in a climatology:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_monthly_climatology</span> <span class="o">=</span> <span class="n">aod_data_monthly</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">aod_data_monthly</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">aod_monthly_climatology</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>     <span class="mf">0.091885</span>
<span class="mi">2</span>     <span class="mf">0.125760</span>
<span class="mi">3</span>     <span class="mf">0.114174</span>
<span class="mi">4</span>     <span class="mf">0.132566</span>
<span class="mi">5</span>     <span class="mf">0.146915</span>
<span class="mi">6</span>     <span class="mf">0.164997</span>
<span class="mi">7</span>     <span class="mf">0.174380</span>
<span class="mi">8</span>     <span class="mf">0.192138</span>
<span class="mi">9</span>     <span class="mf">0.146022</span>
<span class="mi">10</span>    <span class="mf">0.115006</span>
<span class="mi">11</span>    <span class="mf">0.091344</span>
<span class="mi">12</span>    <span class="mf">0.082346</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>And do the same for the monthly data with minimum 15 days per month that
we created above:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aod_monthly_climatology_min15d</span> <span class="o">=</span> <span class="n">aod_monthly_min15d</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">aod_monthly_min15d</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">aod_monthly_climatology_min15d</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>     <span class="mf">0.093066</span>
<span class="mi">2</span>     <span class="mf">0.130359</span>
<span class="mi">3</span>     <span class="mf">0.119908</span>
<span class="mi">4</span>     <span class="mf">0.136720</span>
<span class="mi">5</span>     <span class="mf">0.145820</span>
<span class="mi">6</span>     <span class="mf">0.164751</span>
<span class="mi">7</span>     <span class="mf">0.184243</span>
<span class="mi">8</span>     <span class="mf">0.183453</span>
<span class="mi">9</span>     <span class="mf">0.141699</span>
<span class="mi">10</span>    <span class="mf">0.111532</span>
<span class="mi">11</span>    <span class="mf">0.072294</span>
<span class="mi">12</span>    <span class="mf">0.089056</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">aod_monthly_climatology</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly climatology (no constraint)&#39;</span><span class="p">)</span>
<span class="n">aod_monthly_climatology_min15d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly climatology (min 15 days/month)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f26f70c0f28</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_72_1.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_72_1.png" />
<p>That was enough of a detour into the pandas world. As you shall see
below, some of these pandas features are also provided in the pyaerocom
data objects (e.g. resampling) and more will follow soon!</p>
</div>
<div class="section" id="plotting-of-timeseries-data-directly-from-stationdata-class">
<h4>Plotting of timeseries data directly from <a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=stationdata#pyaerocom.stationdata.StationData">StationData</a> class<a class="headerlink" href="#plotting-of-timeseries-data-directly-from-stationdata-class" title="Permalink to this headline">¶</a></h4>
<p>Let’s come back to the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object. Below are some more
examples that show how you can plot the timeseries directly from the
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> object. This includes to do a resampling out of the box
when plotting:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;yearly&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_75_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_75_0.png" />
<p>The resampling of the timeseries in the plotting method is done
automatically (if input <code class="docutils literal notranslate"><span class="pre">ts_type</span></code> is provided).</p>
<p>Currently, this does not apply additional constraints such as a minimum
number of available observations when downsampling (like we showed
above). From the yearly data (green dots) you can see clearly that this
can be an issue, especially for the first and the last year.</p>
<p>In order to account for it, you may to the following:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to monthly with at least 5 days per month</span>
<span class="n">od550aer_monthly</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">resample_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">min_num_obs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># assign to our StationData</span>
<span class="n">granada_opt1</span><span class="p">[</span><span class="s1">&#39;od550aer_monthly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">od550aer_monthly</span>

<span class="c1"># convert to yearly with at least 6 months per year</span>
<span class="n">od550aer_yearly_constrained</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">resample_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer_monthly&#39;</span><span class="p">,</span> <span class="s1">&#39;yearly&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">min_num_obs</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the result with the yearly product plotted above:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">od550aer_yearly_constrained</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;od550aer (yearly constrained)&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">granada_opt1</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;yearly&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_79_0.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_79_0.png" />
</div>
<div class="section" id="computing-trends-from-station-data">
<h4>Computing trends from station data<a class="headerlink" href="#computing-trends-from-station-data" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt1</span><span class="o">.</span><span class="n">compute_trend</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start_year</span><span class="o">=</span><span class="mi">2005</span><span class="p">,</span> <span class="n">stop_year</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;pval&#39;</span><span class="p">:</span> <span class="mf">0.005380307706696595</span><span class="p">,</span>
 <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0019984909545023464</span><span class="p">,</span>
 <span class="s1">&#39;m_err&#39;</span><span class="p">:</span> <span class="mf">0.0006859706833670536</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
 <span class="s1">&#39;y_mean&#39;</span><span class="p">:</span> <span class="mf">0.13274217888172632</span><span class="p">,</span>
 <span class="s1">&#39;y_min&#39;</span><span class="p">:</span> <span class="mf">0.11068644396371304</span><span class="p">,</span>
 <span class="s1">&#39;y_max&#39;</span><span class="p">:</span> <span class="mf">0.15450395909117362</span><span class="p">,</span>
 <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3972849007872112</span><span class="p">,</span>
 <span class="s1">&#39;slp_err&#39;</span><span class="p">:</span> <span class="mf">0.48509627152652673</span><span class="p">,</span>
 <span class="s1">&#39;reg0&#39;</span><span class="p">:</span> <span class="mf">0.14302673373028105</span><span class="p">,</span>
 <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;slp_2005&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3972849007872112</span><span class="p">,</span>
 <span class="s1">&#39;slp_2005_err&#39;</span><span class="p">:</span> <span class="mf">0.48509627152652673</span><span class="p">,</span>
 <span class="s1">&#39;reg0_2005&#39;</span><span class="p">:</span> <span class="mf">0.14302673373028105</span><span class="p">,</span>
 <span class="s1">&#39;yoffs&#39;</span><span class="p">:</span> <span class="mf">0.21297391713786318</span><span class="p">,</span>
 <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;2005-2020&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">granada_opt1</span><span class="o">.</span><span class="n">trends</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f26f45f7080</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_intro_UngriddedData_and_StationData_classes_82_1.png" src="_images/tut06_intro_UngriddedData_and_StationData_classes_82_1.png" />
</div>
</div>
</div>
<div class="section" id="colocation-of-model-data-with-observations">
<h2>Colocation of model data with observations<a class="headerlink" href="#colocation-of-model-data-with-observations" title="Permalink to this headline">¶</a></h2>
<p>This notebook gives an introduction into collocation of gridded data
with observations. Here, the 550 nm AODs of the ECMWF CAMS reanalysis
model are compared with global daily AeroNet Sun V2 (Level 2) data for
the year 2010. The collocated data will be analysed and visualised in
monthly resolution. The analysis results will be plotted in the form of
the well known Aerocom loglog scatter plots as can be found in the
online interface (see
e.g. <a class="reference external" href="http://aerocom.met.no/cgi-bin/aerocom/surfobs_annualrs.pl">here</a>).</p>
<div class="section" id="import-setup-and-imports">
<h3>Import setup and imports<a class="headerlink" href="#import-setup-and-imports" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>

<span class="n">YEAR</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">VAR</span> <span class="o">=</span> <span class="s2">&quot;od550aer&quot;</span>
<span class="n">TS_TYPE</span> <span class="o">=</span> <span class="s2">&quot;daily&quot;</span>
<span class="n">MODEL_ID</span> <span class="o">=</span> <span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span>
<span class="n">OBS_ID</span> <span class="o">=</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.029</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="import-of-model-data">
<h3>Import of model data<a class="headerlink" href="#import-of-model-data" title="Permalink to this headline">¶</a></h3>
<p>Create reader instance for model data and print overview of what is in
there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">MODEL_ID</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;REAN&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aerboa&#39;</span><span class="p">,</span> <span class="s1">&#39;bscatc532aertoa&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec532dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm10&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcpm25&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Since we are only interested in a single year we can use the method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_data</span> <span class="o">=</span> <span class="n">model_reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">VAR</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">YEAR</span><span class="p">)</span>
<span class="c1">#model_data = read_result[VAR][YEAR]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                             <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                         <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                        <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.6</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="s2">&quot;4.5.4&quot;</span>
          <span class="n">computed</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">concatenated</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">data_id</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
          <span class="n">from_files</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom-users-database/ECMWF/ECMWF_CA...</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">May</span> <span class="mi">26</span> <span class="mi">21</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">48</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncecat</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">u</span> <span class="n">time</span> <span class="o">-</span><span class="n">n</span> <span class="mi">365</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span> <span class="n">CAMS_REAN_001</span><span class="o">.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
          <span class="n">outliers_removed</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">reader</span><span class="p">:</span> <span class="kc">None</span>
          <span class="n">region</span><span class="p">:</span> <span class="kc">None</span>
          <span class="n">regridded</span><span class="p">:</span> <span class="kc">False</span>
          <span class="n">ts_type</span><span class="p">:</span> <span class="n">daily</span>
          <span class="n">var_name_read</span><span class="p">:</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">step</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_7_0.png" src="_images/tut07_intro_colocation_7_0.png" />
</div>
<div class="section" id="import-of-aeronet-sun-v3-data-level-2">
<h3>Import of AeroNet Sun V3 data (Level 2)<a class="headerlink" href="#import-of-aeronet-sun-v3-data-level-2" title="Permalink to this headline">¶</a></h3>
<p>Import Aeronet data and apply filter that selects only stations that are
located at altitudes between 0 and 1000 m.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">OBS_ID</span><span class="p">,</span> <span class="p">[</span><span class="n">VAR</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">])</span>
<span class="n">obs_data</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">filter_by_meta</span><span class="p">(</span><span class="n">altitude</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">meta</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span> <span class="mi">2068</span>
<span class="n">Filters</span> <span class="n">that</span> <span class="n">were</span> <span class="n">applied</span><span class="p">:</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20191012154650</span>
    <span class="n">altitude</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="plot-station-coordinates">
<h4>Plot station coordinates<a class="headerlink" href="#plot-station-coordinates" title="Permalink to this headline">¶</a></h4>
<p>First, plot all stations that are available at all times (as red dots),
then (on top of that in green), plot all stations that provide AODs in
2010.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">obs_data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                                       <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All stations&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">obs_data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                       <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">,</span>
                                       <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Aeronet V3 stations&#39;</span><span class="p">,</span>
                                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1">#just pass the GeoAxes instance that was created in the first call</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Input</span> <span class="n">filters</span> <span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]}</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">unchanged</span> <span class="n">data</span> <span class="nb">object</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_11_1.png" src="_images/tut07_intro_colocation_11_1.png" />
</div>
</div>
<div class="section" id="perform-colocation-and-plot-corresponding-scatter-plots-with-statistical-values">
<h3>Perform colocation and plot corresponding scatter plots with statistical values<a class="headerlink" href="#perform-colocation-and-plot-corresponding-scatter-plots-with-statistical-values" title="Permalink to this headline">¶</a></h3>
<div class="section" id="monthly-world-no-mountains">
<h4>2010 monthly World no mountains<a class="headerlink" href="#monthly-world-no-mountains" title="Permalink to this headline">¶</a></h4>
<p>Colocate 2010 data in monthly resolution using (cf. green dots in
station plot above).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UngriddedData</span> <span class="o">&lt;</span><span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">];</span> <span class="nb">vars</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">];</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">];</span><span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">2068</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                       <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Input</span> <span class="n">filters</span> <span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]}</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">unchanged</span> <span class="n">data</span> <span class="nb">object</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">252</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.117588</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="mf">0.222138</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.132128</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="mf">0.429762</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.132236</span><span class="p">,</span> <span class="mf">0.195057</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="mf">0.261765</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="mf">0.37905</span> <span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.189948</span><span class="p">,</span> <span class="mf">0.140062</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.016372</span><span class="p">,</span> <span class="mf">0.204337</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.150408</span><span class="p">,</span> <span class="mf">0.190089</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.035838</span><span class="p">,</span> <span class="mf">0.257806</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.159844</span><span class="p">,</span> <span class="mf">0.178564</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.022606</span><span class="p">,</span> <span class="mf">0.239393</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.147172</span><span class="p">,</span> <span class="mf">0.138039</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.015231</span><span class="p">,</span> <span class="mf">0.19986</span> <span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
    <span class="n">var_units</span>     <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U1</span> <span class="s1">&#39;1&#39;</span> <span class="s1">&#39;1&#39;</span>
    <span class="n">ts_type_src</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U5</span> <span class="s1">&#39;daily&#39;</span> <span class="s1">&#39;daily&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span> <span class="o">...</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ARM_Darwin&#39;</span> <span class="o">...</span> <span class="s1">&#39;Zinder_Airport&#39;</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">12.43</span> <span class="mf">37.97</span> <span class="mf">15.35</span> <span class="o">...</span> <span class="mf">62.45</span> <span class="mf">13.78</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.9</span> <span class="mf">23.72</span> <span class="o">-</span><span class="mf">1.479</span> <span class="o">...</span> <span class="o">-</span><span class="mf">114.4</span> <span class="mf">8.99</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">29.9</span> <span class="mf">130.0</span> <span class="mf">305.0</span> <span class="o">...</span> <span class="mf">300.0</span> <span class="mf">220.8</span> <span class="mf">456.0</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>        <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>           <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>            <span class="n">monthly</span>
    <span class="n">filter_name</span><span class="p">:</span>        <span class="n">WORLD</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>        <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>
    <span class="n">start_str</span><span class="p">:</span>          <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>           <span class="mi">20101231</span>
    <span class="n">var_units</span><span class="p">:</span>          <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="n">vert_scheme</span><span class="p">:</span>        <span class="kc">None</span>
    <span class="n">data_level</span><span class="p">:</span>         <span class="mi">3</span>
    <span class="n">revision_ref</span><span class="p">:</span>       <span class="mi">20190920</span>
    <span class="n">from_files</span><span class="p">:</span>         <span class="p">[</span><span class="s1">&#39;aerocom.ECMWF_CAMS_REAN.daily.od550aer.2010.nc&#39;</span><span class="p">]</span>
    <span class="n">from_files_ref</span><span class="p">:</span>     <span class="kc">None</span>
    <span class="n">stations_ignored</span><span class="p">:</span>   <span class="kc">None</span>
    <span class="n">colocate_time</span><span class="p">:</span>      <span class="kc">False</span>
    <span class="n">apply_constraints</span><span class="p">:</span>  <span class="kc">True</span>
    <span class="n">min_num_obs</span><span class="p">:</span>        <span class="p">{</span><span class="s1">&#39;yearly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;monthly&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="s1">&#39;monthly&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;daily&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span> <span class="s1">&#39;...</span>
    <span class="n">outliers_removed</span><span class="p">:</span>   <span class="kc">True</span>
    <span class="n">region</span><span class="p">:</span>             <span class="n">WORLD</span>
    <span class="n">lon_range</span><span class="p">:</span>          <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>          <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>          <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_16_0.png" src="_images/tut07_intro_colocation_16_0.png" />
</div>
<div class="section" id="time-colocation">
<h4>Time colocation<a class="headerlink" href="#time-colocation" title="Permalink to this headline">¶</a></h4>
<p>The above colocation was performed based on monthly means, both from
model and obs, at each station. However, if you look closely in the
output you can see that both datasets are provided in daily resolution.
You may colocate on a daily basis using the input argument
<code class="docutils literal notranslate"><span class="pre">colocate_time</span></code>, in which case the model monthly means correspond to
the mean value from the days where there were observations. This can
(and most likely will) give you different results, since the
observations may miss some days in the month, which is disregarded in
the above monthly colocation routine:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc_alt</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                           <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">,</span>
                                                           <span class="n">colocate_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Input</span> <span class="n">filters</span> <span class="p">{</span><span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="s1">&#39;altitude&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]}</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">unchanged</span> <span class="n">data</span> <span class="nb">object</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc_alt</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_19_0.png" src="_images/tut07_intro_colocation_19_0.png" />
<p>The result shows, that time colocation yields better results, with lower
biases (NMB and MNMB) and higher correlation, etc.</p>
<p>However, in reality and in particular in large model intercomparison
studies (involving many variables and model outputs) the model
diagnostics output files are submitted in monthly resolution, which does
not allow to perform these time colocation on a daily basis.</p>
<p>Note also, that the model data used here is the CAMS reanalysis dataset
which assimilates AERONET AODs. It is therefore not surprising, that the
results look so shiny.</p>
</div>
<div class="section" id="daily-europe-no-mountains">
<h4>2010 daily Europe no mountains<a class="headerlink" href="#daily-europe-no-mountains" title="Permalink to this headline">¶</a></h4>
<p>Now perform colocation only over Europe. Starting with a station plot.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                  <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Aeronet V3 stations&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_22_0.png" src="_images/tut07_intro_colocation_22_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc_eur</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span>
                                                       <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc_eur</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">83</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.078648</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.086522</span><span class="p">,</span> <span class="mf">0.015151</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.075447</span><span class="p">,</span> <span class="mf">0.03005</span> <span class="p">],</span>
        <span class="p">[</span><span class="mf">0.067198</span><span class="p">,</span> <span class="mf">0.043074</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.103671</span><span class="p">,</span> <span class="mf">0.042999</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.242585</span><span class="p">,</span> <span class="mf">0.186407</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.053797</span><span class="p">,</span> <span class="mf">0.011344</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.079498</span><span class="p">,</span> <span class="mf">0.122098</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.027066</span><span class="p">,</span> <span class="mf">0.019639</span><span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
    <span class="n">var_units</span>     <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U1</span> <span class="s1">&#39;1&#39;</span> <span class="s1">&#39;1&#39;</span>
    <span class="n">ts_type_src</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U5</span> <span class="s1">&#39;daily&#39;</span> <span class="s1">&#39;daily&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="o">...</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ATHENS-NOA&#39;</span> <span class="s1">&#39;Andenes&#39;</span> <span class="o">...</span> <span class="s1">&#39;Yekaterinburg&#39;</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">37.97</span> <span class="mf">69.28</span> <span class="mf">44.66</span> <span class="o">...</span> <span class="mf">51.77</span> <span class="mf">41.15</span> <span class="mf">57.04</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">23.72</span> <span class="mf">16.01</span> <span class="o">-</span><span class="mf">1.163</span> <span class="o">...</span> <span class="mf">24.92</span> <span class="mf">59.54</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.0</span> <span class="mf">379.0</span> <span class="mf">11.0</span> <span class="o">...</span> <span class="mf">160.0</span> <span class="mf">54.0</span> <span class="mf">300.0</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>        <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>           <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>            <span class="n">daily</span>
    <span class="n">filter_name</span><span class="p">:</span>        <span class="n">EUROPE</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>        <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>
    <span class="n">start_str</span><span class="p">:</span>          <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>           <span class="mi">20101231</span>
    <span class="n">var_units</span><span class="p">:</span>          <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">]</span>
    <span class="n">vert_scheme</span><span class="p">:</span>        <span class="kc">None</span>
    <span class="n">data_level</span><span class="p">:</span>         <span class="mi">3</span>
    <span class="n">revision_ref</span><span class="p">:</span>       <span class="mi">20190920</span>
    <span class="n">from_files</span><span class="p">:</span>         <span class="p">[</span><span class="s1">&#39;aerocom.ECMWF_CAMS_REAN.daily.od550aer.2010.nc&#39;</span><span class="p">]</span>
    <span class="n">from_files_ref</span><span class="p">:</span>     <span class="kc">None</span>
    <span class="n">stations_ignored</span><span class="p">:</span>   <span class="kc">None</span>
    <span class="n">colocate_time</span><span class="p">:</span>      <span class="kc">False</span>
    <span class="n">apply_constraints</span><span class="p">:</span>  <span class="kc">False</span>
    <span class="n">min_num_obs</span><span class="p">:</span>        <span class="kc">None</span>
    <span class="n">outliers_removed</span><span class="p">:</span>   <span class="kc">True</span>
    <span class="n">region</span><span class="p">:</span>             <span class="n">EUROPE</span>
    <span class="n">lon_range</span><span class="p">:</span>          <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>          <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>          <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc_eur</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_24_0.png" src="_images/tut07_intro_colocation_24_0.png" />
</div>
</div>
<div class="section" id="satellite-colocation">
<h3>Satellite colocation<a class="headerlink" href="#satellite-colocation" title="Permalink to this headline">¶</a></h3>
<p>Below, the same is done for satellite colocation using AODs from the
MODIS instrument onboard the Aqua satellite (Collection 6).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;MODIS6*aqua&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">MODIS6</span><span class="o">.</span><span class="mi">1</span><span class="n">aqua</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">SATELLITE</span><span class="o">-</span><span class="n">DATA</span><span class="o">/</span><span class="n">MODIS6</span><span class="o">.</span><span class="mi">1</span><span class="n">aqua</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MODIS6.1aqua&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Data</span> <span class="n">ID</span><span class="p">:</span> <span class="n">MODIS6</span><span class="o">.</span><span class="n">aqua</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">SATELLITE</span><span class="o">-</span><span class="n">DATA</span><span class="o">/</span><span class="n">MODIS6</span><span class="o">.</span><span class="n">aqua</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">experiments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MODIS6.aqua&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">frequencies</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modis_aods</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s1">&#39;MODIS6.aqua&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">)</span>
<span class="n">modis_aods</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550aer</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Thickness</span> <span class="n">at</span> <span class="mf">0.55</span> <span class="n">microns</span> <span class="k">for</span> <span class="n">both</span> <span class="n">Ocean</span> <span class="p">(</span><span class="n">best</span><span class="p">)</span> <span class="ow">and</span> <span class="n">Land</span> <span class="p">(</span><span class="n">corrected</span><span class="p">):</span> <span class="n">Mean</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">180</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">360</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now the satellite data comes gridded, like the model data. Thus, we use
the gridded / gridded colocation routine rather than the gridded /
ungridded that we used above when using AERONET station data.</p>
<div class="section" id="no-daily-time-colocation">
<h4>No (daily) time colocation<a class="headerlink" href="#no-daily-time-colocation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coldata_modis</span> <span class="o">=</span>  <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_gridded</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span>
                                                         <span class="n">modis_aods</span><span class="p">,</span>
                                                         <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                         <span class="n">regrid_res_deg</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                         <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                         <span class="n">colocate_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coldata_modis</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_31_0.png" src="_images/tut07_intro_colocation_31_0.png" />
</div>
<div class="section" id="with-daily-time-colocation">
<h4>With (daily) time colocation<a class="headerlink" href="#with-daily-time-colocation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coldata_modis_alt</span> <span class="o">=</span>  <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_gridded</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span>
                                                         <span class="n">modis_aods</span><span class="p">,</span>
                                                         <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                         <span class="n">regrid_res_deg</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                         <span class="n">remove_outliers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                         <span class="n">colocate_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">lower</span> <span class="n">lim</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span>
<span class="n">Setting</span> <span class="n">od550aer</span> <span class="n">outlier</span> <span class="n">upper</span> <span class="n">lim</span><span class="p">:</span> <span class="mf">10.00</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coldata_modis_alt</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/tut07_intro_colocation_34_0.png" src="_images/tut07_intro_colocation_34_0.png" />
</div>
</div>
</div>
<div class="section" id="short-tutorial-showing-how-trends-can-be-computed-within-pyaerocom">
<h2>Short tutorial showing how trends can be computed within pyaerocom<a class="headerlink" href="#short-tutorial-showing-how-trends-can-be-computed-within-pyaerocom" title="Permalink to this headline">¶</a></h2>
<p>Details regarding the trends computation routine can be found here
(methods section):</p>
<p><a class="reference external" href="https://aerocom-trends.met.no/">https://aerocom-trends.met.no/</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.018</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsdata</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">obsdata</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UngriddedData</span> <span class="o">&lt;</span><span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">];</span> <span class="nb">vars</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">];</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">];</span><span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">1230</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trends_engine</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">trends_helpers</span><span class="o">.</span><span class="n">TrendsEngine</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leipzig</span> <span class="o">=</span> <span class="n">obsdata</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">)</span>
<span class="n">leipzig</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f854a48f390</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut08_trends_computation_4_1.png" src="_images/tut08_trends_computation_4_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trend_info</span> <span class="o">=</span> <span class="n">leipzig</span><span class="o">.</span><span class="n">compute_trend</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">trend_info</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;pval&#39;</span><span class="p">:</span> <span class="mf">0.07433498084899375</span><span class="p">,</span>
 <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.003086717318214402</span><span class="p">,</span>
 <span class="s1">&#39;m_err&#39;</span><span class="p">:</span> <span class="mf">0.001221428677173954</span><span class="p">,</span>
 <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
 <span class="s1">&#39;y_mean&#39;</span><span class="p">:</span> <span class="mf">0.1770474435541329</span><span class="p">,</span>
 <span class="s1">&#39;y_min&#39;</span><span class="p">:</span> <span class="mf">0.1434634180318197</span><span class="p">,</span>
 <span class="s1">&#39;y_max&#39;</span><span class="p">:</span> <span class="mf">0.24099296150814278</span><span class="p">,</span>
 <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5142800744263278</span><span class="p">,</span>
 <span class="s1">&#39;slp_err&#39;</span><span class="p">:</span> <span class="mf">0.6112855317780068</span><span class="p">,</span>
 <span class="s1">&#39;reg0&#39;</span><span class="p">:</span> <span class="mf">0.20384058209203992</span><span class="p">,</span>
 <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;slp_2001&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4916916844764267</span><span class="p">,</span>
 <span class="s1">&#39;slp_2001_err&#39;</span><span class="p">:</span> <span class="mf">0.603290719703447</span><span class="p">,</span>
 <span class="s1">&#39;reg0_2001&#39;</span><span class="p">:</span> <span class="mf">0.20692729941025434</span><span class="p">,</span>
 <span class="s1">&#39;yoffs&#39;</span><span class="p">:</span> <span class="mf">0.3026155362749008</span><span class="p">,</span>
 <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;2001-2018&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>These results are stored in the station data object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leipzig</span><span class="o">.</span><span class="n">trends</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
              <span class="o">&lt;</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">trends_helpers</span><span class="o">.</span><span class="n">TrendsEngine</span> <span class="n">at</span> <span class="mh">0x7f8549fc0940</span><span class="o">&gt;</span><span class="p">)])</span>
</pre></div>
</div>
<p>The actual trends result data can be accessed via the instance of the
<code class="docutils literal notranslate"><span class="pre">TrendsEngine</span></code> class that is stored in the <code class="docutils literal notranslate"><span class="pre">trends</span></code> attribute of the
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leipzig</span><span class="o">.</span><span class="n">trends</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">results</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
              <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;2001-2018&#39;</span><span class="p">,</span>
                            <span class="p">{</span><span class="s1">&#39;pval&#39;</span><span class="p">:</span> <span class="mf">0.07433498084899375</span><span class="p">,</span>
                             <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.003086717318214402</span><span class="p">,</span>
                             <span class="s1">&#39;m_err&#39;</span><span class="p">:</span> <span class="mf">0.001221428677173954</span><span class="p">,</span>
                             <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                             <span class="s1">&#39;y_mean&#39;</span><span class="p">:</span> <span class="mf">0.1770474435541329</span><span class="p">,</span>
                             <span class="s1">&#39;y_min&#39;</span><span class="p">:</span> <span class="mf">0.1434634180318197</span><span class="p">,</span>
                             <span class="s1">&#39;y_max&#39;</span><span class="p">:</span> <span class="mf">0.24099296150814278</span><span class="p">,</span>
                             <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="s1">&#39;slp&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5142800744263278</span><span class="p">,</span>
                             <span class="s1">&#39;slp_err&#39;</span><span class="p">:</span> <span class="mf">0.6112855317780068</span><span class="p">,</span>
                             <span class="s1">&#39;reg0&#39;</span><span class="p">:</span> <span class="mf">0.20384058209203992</span><span class="p">,</span>
                             <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="s1">&#39;slp_2001&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4916916844764267</span><span class="p">,</span>
                             <span class="s1">&#39;slp_2001_err&#39;</span><span class="p">:</span> <span class="mf">0.603290719703447</span><span class="p">,</span>
                             <span class="s1">&#39;reg0_2001&#39;</span><span class="p">:</span> <span class="mf">0.20692729941025434</span><span class="p">,</span>
                             <span class="s1">&#39;yoffs&#39;</span><span class="p">:</span> <span class="mf">0.3026155362749008</span><span class="p">,</span>
                             <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="s1">&#39;2001-2018&#39;</span><span class="p">})]))])</span>
</pre></div>
</div>
<p>Here, the first layer corresponds to the season, and the second layer
corresponds to the period.</p>
<p>Plotting the trend can be done by using the plotting method of the
<code class="docutils literal notranslate"><span class="pre">TrendsEngine</span></code> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leipzig</span><span class="o">.</span><span class="n">trends</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut08_trends_computation_11_0.png" src="_images/tut08_trends_computation_11_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv</span> <span class="o">=</span> <span class="n">obsdata</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Solar_Village&#39;</span><span class="p">)</span>
<span class="n">sv</span><span class="o">.</span><span class="n">compute_trend</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">sv</span><span class="o">.</span><span class="n">trends</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut08_trends_computation_13_0.png" src="_images/tut08_trends_computation_13_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv</span> <span class="o">=</span> <span class="n">obsdata</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Ispra&#39;</span><span class="p">)</span>
<span class="n">sv</span><span class="o">.</span><span class="n">compute_trend</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">sv</span><span class="o">.</span><span class="n">trends</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/tut08_trends_computation_14_0.png" src="_images/tut08_trends_computation_14_0.png" />
</div>
<div class="section" id="further-tutorials">
<h2>Further tutorials<a class="headerlink" href="#further-tutorials" title="Permalink to this headline">¶</a></h2>
<div class="section" id="handling-of-time-in-pyaerocom">
<h3>Handling of time in pyaerocom<a class="headerlink" href="#handling-of-time-in-pyaerocom" title="Permalink to this headline">¶</a></h3>
<p><strong>NOTE</strong>: the topics of this notebook are not necessarily required for
using <em>pyaerocom</em>. It The
<a class="reference external" href="http://aerocom.met.no/pya/api.html#module-pya.griddeddata">GriddedData</a>
class of <em>pyaerocom</em> was introduced in a previous tutorial.</p>
<p>Here, we illustrate how <em>pyaerocom</em> handles time. In particular, how
<em>pyaerocom</em> performs the conversion of CF conform numerical time stamps
with a defined unit (i.e. basedate and calendar, see
e.g. <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">here</a>
for details) into datetime-like objects that can be interpreted by tools
such as <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>.</p>
<p>The easiest way to work with time stamps in model data is, to simply
work on the internal numerical indices, avoiding the necessity to
convert them into actual datetime objects. However, sometimes (e.g. if
we want to extract and analyse a time-series of global average Aerosol
optical densities), we wish to use third party libraries such as Pandas,
which require the timestamps to be datetime-like objects.</p>
<p>This notebook illustrates how time is handled in the iris module,
particularly in the
<a class="reference external" href="http://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">Cube</a>
class, which is the basic data representation object in the <em>pya</em>
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. In particular, it emphazises some peculiarities
that can lead to complications and finally shows, how <em>pya</em> circumvents
these issues. We shall see, that this does not only reduce the risk of
conversion Errors, but even results in a quite significant performance
boost when converting from numerical CF timestamps to
<code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code> time stamps.</p>
<div class="section" id="load-and-some-example-data">
<h4>Load and some example data<a class="headerlink" href="#load-and-some-example-data" title="Permalink to this headline">¶</a></h4>
<p>Get and load test data file using the new pya interface (the underlying
datatype of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> is <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">fpath_ecmwf</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;ecmwf_osuite&#39;</span><span class="p">]</span>
<span class="n">fpath_aatsr</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;aatsr_su_v4.3&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.023</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ecmwf</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_ecmwf</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_aatsr</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_aatsr</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;AATSR&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">unit</span> <span class="n">unknown</span> <span class="ow">in</span> <span class="n">cube</span> <span class="n">od550aer</span> <span class="k">with</span> <span class="n">value</span> <span class="s2">&quot;1&quot;</span>
</pre></div>
</div>
<p>Note that, if the longitudes are defined on a 0 -&gt; 360 degree grid, they
are automatically converted to -180 -&gt; 180 (the case of the ECMWF data).</p>
</div>
<div class="section" id="digging-into-the-time-representation-of-the-iris-cube-datatype">
<h4>Digging into the time representation of the iris Cube datatype<a class="headerlink" href="#digging-into-the-time-representation-of-the-iris-cube-datatype" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is based on the <code class="docutils literal notranslate"><span class="pre">iris.Cube</span></code> object, which
can be accessed via the <code class="docutils literal notranslate"><span class="pre">grid</span></code> attribute. In the following, some
features of the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> class are introduced.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube_ecmwf</span> <span class="o">=</span> <span class="n">data_ecmwf</span><span class="o">.</span><span class="n">grid</span>
<span class="n">cube_aatsr</span> <span class="o">=</span> <span class="n">data_aatsr</span><span class="o">.</span><span class="n">grid</span>
</pre></div>
</div>
<div class="section" id="peculiarities-of-time-handling-when-using-the-cube-interface">
<h5>Peculiarities of time handling when using the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> interface<a class="headerlink" href="#peculiarities-of-time-handling-when-using-the-cube-interface" title="Permalink to this headline">¶</a></h5>
<p>Starting with how time is handled. The time is represented as numerical
value relative to a basic date and frequency unit and in the optimum
case, also the specification of a calendar, according to the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">NetCDF CF
conventions</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf</span> <span class="o">=</span> <span class="n">cube_ecmwf</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ECMWF</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
<span class="n">times_aatsr</span><span class="o">=</span> <span class="n">cube_aatsr</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AATSR</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_aatsr</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">gregorian</span>

<span class="n">AATSR</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">julian</span>
</pre></div>
</div>
<p>Note that the AATSR data is defined using a Julian calendar. The actual
time objects are instances of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class of the iris
package.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">times_aatsr</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;iris.coords.DimCoord&#39;&gt; &lt;class &#39;iris.coords.DimCoord&#39;&gt;
</pre></div>
</div>
<p>Now, if we want to convert these numerically represented time stamps
into datetime-like objects that, for instance, the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library
understands, we have several options. The first one, which is the most
obvious one, is using the provided iris interface which does the
conversion for us, that is, using the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method (with the
corresponding <code class="docutils literal notranslate"><span class="pre">index</span></code>) of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class in combination with
the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator method. However, as we shall see below, this is
not only the slowest solution but it is also prone to errors in case the
calendar is not standard (e.g. Julian).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_ecmwf</span> <span class="o">=</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="n">t0_aatsr</span> <span class="o">=</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp ECMWF </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp AATSR </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>First time stamp ECMWF 2018-01-01 00:00:00 (data type: &lt;class &#39;cftime._cftime.real_datetime&#39;&gt;)
First time stamp AATSR 2008-01-01 00:00:00 (data type: &lt;class &#39;cftime._cftime.DatetimeJulian&#39;&gt;)
</pre></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method returns different datatypes,
dependent on the CF unit convention, that is, a standard Python
<code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> object, if the calendar is Gregorian, and a
<code class="docutils literal notranslate"><span class="pre">netcdftime._netcdftime.DatetimeJulian</span></code> object in case of a Julian
calendar. Problem here is, that the former is understood by pandas,
while the latter is not.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">t0_ecmwf_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">t0_aatsr_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert input [2008-01-01 00:00:00] of type &lt;class &#39;cftime._cftime.DatetimeJulian&#39;&gt; to Timestamp&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Nontheless, numpy is easier in that sense, since it understands both
datatypes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">t0_ecmwf_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="n">t0_aatsr_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t0_ecmwf_np</span><span class="p">,</span> <span class="n">t0_aatsr_np</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>Fair enough, but however, in the end we want to ensure to have a
conversion method ready that handles any calendar, and that is
considerably fast. We just saw, that <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> works for both
datetime formats that we get when calling the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> object that holds the time stamps. However, keep in mind,
that whenever <code class="docutils literal notranslate"><span class="pre">cell</span></code> is called, it performs a conversion of the
numeric value into either <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> or, for non-standard
calendars, into a datetime object from the
<a class="reference external" href="https://github.com/Unidata/cftime">cftime</a> package. So, either way,
when using the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method we have to iterate over all indices to
convert the numerical values into datetime-like objects. The latter may
be done using the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="n">times_aatsr_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="c1">#display first two</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">times_aatsr_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">real_datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">real_datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="p">[</span><span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
</pre></div>
</div>
<p>This worked, but however, is it fast?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>204 ms ± 29.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>154 ms ± 10.4 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>The answer is: No, it is not fast, and furthermore, the latter datatype
will not be accepted by pandas as a valid datetime object. We can,
however, convert the datapoints to numpy datetime64 objects during the
conversion (if we want).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>151 ms ± 5.57 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>157 ms ± 9.68 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>That looks okay, since it does not lead to a notable decrease in the
performance and ensures, that pandas will understand the datatype.
However, about 100ms for conversion of 365 dates is rather slow.</p>
</div>
<div class="section" id="other-options-to-convert-timestamps">
<h5>Other options to convert timestamps<a class="headerlink" href="#other-options-to-convert-timestamps" title="Permalink to this headline">¶</a></h5>
<p>Above we saw how we can convert the numerical timestamps into an array
of numpy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects (which is what we want in the end). As
we shall see below, the conversion can be significantly accelarated if
we do not use the iris interface provided by the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method
and the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator, but rather directly use the underlying
<code class="docutils literal notranslate"><span class="pre">cftime</span></code> library (that iris uses).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">points</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>8.27 ms ± 1.63 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>This is quite an improvement. But if we dig a little deeper, we can
boost this even more, as we shall see in the following. Basically, what
it does is accessing the base date that is encrypted in the unit, i.e.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
</pre></div>
</div>
<p>and based on this base date, and the encrypted temporal resolution (here
<em>day</em>) uses the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.14.0/reference/arrays.datetime.html">pure numpy datetime
functionality</a>
to convert the stuff. For this, we have to test if the first sub string
(here <em>day</em>) is valid according to the CF standard, which we do using
some features from the <code class="docutils literal notranslate"><span class="pre">netCDF4</span></code> package and by defining a function,
that translates the numerical timestamps into <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects
based on the information encoded in the units string(e.g. <em>day since
2018-01-01 00:00:00.00000000 UTC</em>) and the corresponding calendar
(e.g. “gregorian”). THis function is included in <strong>pyaerocom</strong> and can
be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaerocom.helpers</span> <span class="kn">import</span> <span class="n">cftime_to_datetime64</span> <span class="k">as</span> <span class="n">pya_tconversion</span>
<span class="n">help</span><span class="p">(</span><span class="n">pya_tconversion</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on function cftime_to_datetime64 in module pyaerocom.helpers:

cftime_to_datetime64(times, cfunit=None, calendar=None)
    Convert numerical timestamps with epoch to numpy datetime64

    This method was designed to enhance the performance of datetime conversions
    and is based on the corresponding information provided in the cftime
    package (<a class="reference external" href="https://github.com/Unidata/cftime/blob/master/cftime/_cftime.pyx">see here</a>). Particularly, this object does, what the <code class="xref py py-func docutils literal notranslate"><span class="pre">num2date()</span></code>
    therein does, but faster, in case the time stamps are not defined on a non
    standard calendar.

    Parameters
    ----------
    times : <code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">iris.coords.DimCoord</span></code>
        array containing numerical time stamps (relative to basedate of
        <code class="docutils literal notranslate"><span class="pre">cfunit</span></code>). Can also be a single number.
    cfunit : <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Unit</span></code>, optional
        CF unit string (e.g. day since 2018-01-01 00:00:00.00000000 UTC) or
        unit. Required if <cite>times</cite> is not an instance of
        <code class="xref py py-class docutils literal notranslate"><span class="pre">iris.coords.DimCoord</span></code>
    calendar : <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional
        string specifying calendar (only required if <code class="docutils literal notranslate"><span class="pre">cfunit</span></code> is of type
        <code class="docutils literal notranslate"><span class="pre">str</span></code>).

    Returns
    -------
    ndarray
        numpy array containing timestamps as datetime64 objects

    Raises
    ------
    ValueError
        if cfunit is <code class="docutils literal notranslate"><span class="pre">str</span></code> and calendar is not provided or invalid, or if
        the cfunit string is invalid

    Example
    -------

    &gt;&gt;&gt; cfunit_str = 'day since 2018-01-01 00:00:00.00000000 UTC'
    &gt;&gt;&gt; cftime_to_datetime64(10, cfunit_str, &quot;gregorian&quot;)
    array(['2018-01-11T00:00:00.000000'], dtype='datetime64[us]')</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">pya_tconversion</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>410 µs ± 9 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>For the AATSR data, the method is slower, since here, the slower
<code class="docutils literal notranslate"><span class="pre">num2date</span></code> method is used.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">pya_tconversion</span><span class="p">(</span><span class="n">times_aatsr</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>9.06 ms ± 2.02 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>Now this is an improvement. Starting with around 100ms when using the
iris interface (i.e. iterating over <code class="docutils literal notranslate"><span class="pre">cells</span></code> of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code>), for
conversion of 365 time stamps, we ended up with the order of 10
microseconds. And at the same time the new method ensures that we have
them in a format that also pandas understands.</p>
<p>The method is also the standard conversion method in the
<code class="docutils literal notranslate"><span class="pre">GriddedData.time_stamps()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">data_ecmwf</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>459 µs ± 16.2 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">data_aatsr</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>7.99 ms ± 53.3 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tutorial-showing-how-to-read-ebas-nasa-ames-files">
<h3>Tutorial showing how to read EBAS NASA Ames files<a class="headerlink" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files" title="Permalink to this headline">¶</a></h3>
<p>This low-level tutorial shows how to read an EBAS NASA Ames file using
the class
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=ebasnasaamesfile#pyaerocom.io.ebas_nasa_ames.EbasNasaAmesFile">EbasNasaAmesFile</a>
of pyaerocom and how to access the import data and metadata.</p>
<p><strong>NOTE</strong>: variable names and names of metadata attributes below use the
EBAS conventions and <strong>not the AeroCom naming conventions</strong>, since the
purpose of the <code class="docutils literal notranslate"><span class="pre">EbasNasaAmesFile</span></code> reading routine is to solely import
the content of the original data files (provided by EBAS) into a python
interface. If you intend to use EBAS data for AeroCom purposes
(e.g. model intercomparison), please use the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=readebas#pyaerocom.io.read_ebas.ReadEbas">ReadEbas</a>
routine (or the
<a class="reference external" href="https://pyaerocom.met.no/api.html?highlight=readebas#module-pyaerocom.io.readungridded">ReadUngridded</a>
factory class) which is doing the mapping to AeroCom naming conventions.</p>
<p>Please see
<a class="reference external" href="https://ebas-submit.nilu.no/Submit-Data/Getting-started">here</a> for
information related to the EBAS NASA Ames file format.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.023</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ebasdir</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">EBASMC_DATA_DIR</span>
<span class="n">ebasdir</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EBASMultiColumn/data/data/&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">DE0043G*2010*nephelometer*lev2.nas&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ebasdir</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No. of files found: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">No</span><span class="o">.</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EBASMultiColumn/data/data/DE0043G.20100201000000.20150304123917.nephelometer..pm10.11mo.1h.DE09L_TSI_Neph_3563.DE09L_scatt_NEPH.lev2.nas&#39;</span>
</pre></div>
</div>
<p>Read the first file that was found:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">only_head</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>          <span class="c1">#set True if you only want to import header</span>
                             <span class="n">replace_invalid_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#replace invalid values with NaNs</span>
                             <span class="n">convert_timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1">#compute datetime64 timestamps from numerical values</span>
                             <span class="n">decode_flags</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>        <span class="c1">#decode all flags (e.g. 0.111222333 -&gt; 111 222 333)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasNasaAmesFile</span>
<span class="o">--------------------------</span>

<span class="n">num_head_lines</span><span class="p">:</span> <span class="mi">91</span>
<span class="n">num_head_fmt</span><span class="p">:</span> <span class="mi">1001</span>
<span class="n">data_originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
<span class="n">sponsor_organisation</span><span class="p">:</span> <span class="n">DE09L</span><span class="p">,</span> <span class="n">Deutscher</span> <span class="n">Wetterdienst</span><span class="p">,</span> <span class="n">DWD</span><span class="p">,</span> <span class="n">Met</span><span class="o">.</span> <span class="n">Obs</span><span class="o">.</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="p">,</span> <span class="mi">82283</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="n">Germany</span>
<span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
<span class="n">project_association</span><span class="p">:</span> <span class="n">ACTRIS</span> <span class="n">EMEP</span> <span class="n">GAW</span><span class="o">-</span><span class="n">WDCA</span>
<span class="n">vol_num</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">vol_totnum</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">ref_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">04</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">freq</span><span class="p">:</span> <span class="mf">0.041667</span>
<span class="n">descr_time_unit</span><span class="p">:</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">file</span> <span class="n">reference</span> <span class="n">point</span>
<span class="n">num_cols_dependent</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">mul_factors</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">23</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">]</span>
<span class="n">vals_invalid</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">23</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mf">9999.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">9999.999999</span><span class="p">,</span> <span class="mf">10.00</span><span class="p">]</span>
<span class="n">descr_first_col</span><span class="p">:</span> <span class="n">end_time</span> <span class="n">of</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">file</span> <span class="n">reference</span> <span class="n">point</span>

   <span class="n">Column</span> <span class="n">variable</span> <span class="n">definitions</span>
   <span class="o">-------------------------------</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">hPa</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">relative_humidity</span><span class="p">,</span> <span class="n">unit</span><span class="o">=%</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">no</span> <span class="n">unit</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>

   <span class="n">EBAS</span> <span class="n">meta</span> <span class="n">data</span>
   <span class="o">------------------</span>
<span class="n">decode_flags</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">data_definition</span><span class="p">:</span> <span class="n">EBAS_1</span><span class="o">.</span><span class="mi">1</span>
<span class="n">set_type_code</span><span class="p">:</span> <span class="n">TU</span>
<span class="n">timezone</span><span class="p">:</span> <span class="n">UTC</span>
<span class="n">file_name</span><span class="p">:</span> <span class="n">DE0043G</span><span class="o">.</span><span class="mf">20100201000000.20150304123917</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">pm10</span><span class="o">.</span><span class="mi">11</span><span class="n">mo</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">DE09L_TSI_Neph_3563</span><span class="o">.</span><span class="n">DE09L_scatt_NEPH</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
<span class="n">file_creation</span><span class="p">:</span> <span class="mi">20191001143946</span>
<span class="n">startdate</span><span class="p">:</span> <span class="mi">20100201000000</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="mi">20150304123917</span>
<span class="n">version</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">version_description</span><span class="p">:</span> <span class="n">initial</span> <span class="n">revision</span>
<span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">period_code</span><span class="p">:</span> <span class="mi">11</span><span class="n">mo</span>
<span class="n">resolution_code</span><span class="p">:</span> <span class="mi">1</span><span class="n">h</span>
<span class="n">sample_duration</span><span class="p">:</span> <span class="mi">1</span><span class="n">h</span>
<span class="n">orig</span><span class="o">.</span><span class="n">_time_res</span><span class="o">.</span><span class="p">:</span> <span class="mi">10</span><span class="n">mn</span>
<span class="n">station_code</span><span class="p">:</span> <span class="n">DE0043G</span>
<span class="n">platform_code</span><span class="p">:</span> <span class="n">DE0043S</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
<span class="n">station_wdca</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">GAWADE__HPB</span>
<span class="n">station_gaw</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">HPB</span>
<span class="n">station_gaw</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
<span class="n">station_land_use</span><span class="p">:</span> <span class="n">Grassland</span>
<span class="n">station_setting</span><span class="p">:</span> <span class="n">Mountain</span>
<span class="n">station_gaw_type</span><span class="p">:</span> <span class="n">G</span>
<span class="n">station_wmo_region</span><span class="p">:</span> <span class="mi">6</span>
<span class="n">station_latitude</span><span class="p">:</span> <span class="mf">47.8014984131</span>
<span class="n">station_longitude</span><span class="p">:</span> <span class="mf">11.0096197128</span>
<span class="n">station_altitude</span><span class="p">:</span> <span class="mf">985.0</span> <span class="n">m</span>
<span class="n">measurement_height</span><span class="p">:</span> <span class="mf">15.0</span> <span class="n">m</span>
<span class="n">regime</span><span class="p">:</span> <span class="n">IMG</span>
<span class="n">component</span><span class="p">:</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">matrix</span><span class="p">:</span> <span class="n">pm10</span>
<span class="n">laboratory_code</span><span class="p">:</span> <span class="n">DE09L</span>
<span class="n">instrument_type</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">TSI_Neph_3563</span>
<span class="n">instrument_manufacturer</span><span class="p">:</span> <span class="n">TSI</span>
<span class="n">instrument_model</span><span class="p">:</span> <span class="mi">3563</span>
<span class="n">method_ref</span><span class="p">:</span> <span class="n">DE09L_scatt_NEPH</span>
<span class="n">standard_method</span><span class="p">:</span> <span class="n">cal</span><span class="o">-</span><span class="n">gas</span><span class="o">=</span><span class="n">CO2</span><span class="o">+</span><span class="n">AIR_truncation</span><span class="o">-</span><span class="n">correction</span><span class="o">=</span><span class="n">Anderson1998</span>
<span class="n">inlet_type</span><span class="p">:</span> <span class="n">Impactor</span><span class="o">--</span><span class="n">direct</span>
<span class="n">inlet_description</span><span class="p">:</span> <span class="n">PM10</span> <span class="n">at</span> <span class="n">ambient</span> <span class="n">humidity</span> <span class="n">inlet</span><span class="p">,</span> <span class="n">Digitel</span><span class="p">,</span> <span class="n">flow</span> <span class="mi">170</span> <span class="n">l</span><span class="o">/</span><span class="nb">min</span>
<span class="n">humidity</span><span class="o">/</span><span class="n">temperature_control</span><span class="p">:</span> <span class="n">Nafion</span> <span class="n">dryer</span>
<span class="n">volume_std</span><span class="o">.</span><span class="n">_temperature</span><span class="p">:</span> <span class="mf">273.15</span> <span class="n">K</span>
<span class="n">volume_std</span><span class="o">.</span><span class="n">_pressure</span><span class="p">:</span> <span class="mf">1013.25</span> <span class="n">hPa</span>
<span class="n">detection_limit</span><span class="p">:</span> <span class="mf">0.3</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">detection_limit_expl</span><span class="o">.</span><span class="p">:</span> <span class="n">Determined</span> <span class="n">only</span> <span class="n">by</span> <span class="n">instrument</span> <span class="n">counting</span> <span class="n">statistics</span><span class="p">,</span> <span class="n">no</span> <span class="n">detection</span> <span class="n">limit</span> <span class="n">flag</span> <span class="n">used</span>
<span class="n">measurement_uncertainty</span><span class="p">:</span> <span class="mf">0.3</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">measurement_uncertainty_expl</span><span class="o">.</span><span class="p">:</span> <span class="n">Determined</span> <span class="n">only</span> <span class="n">by</span> <span class="n">instrument</span> <span class="n">counting</span> <span class="n">statistics</span><span class="p">,</span> <span class="n">no</span> <span class="n">detection</span> <span class="n">limit</span> <span class="n">flag</span> <span class="n">used</span>
<span class="n">zero</span><span class="o">/</span><span class="n">negative_values</span><span class="p">:</span> <span class="n">Zero</span> <span class="n">values</span> <span class="n">may</span> <span class="n">appear</span> <span class="n">due</span> <span class="n">to</span> <span class="n">statistical</span> <span class="n">variations</span> <span class="n">at</span> <span class="n">very</span> <span class="n">low</span> <span class="n">concentrations</span>
<span class="n">originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>
<span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>
<span class="n">acknowledgement</span><span class="p">:</span> <span class="n">Request</span> <span class="n">acknowledgement</span> <span class="n">details</span> <span class="kn">from</span> <span class="nn">data</span> <span class="n">originator</span>
<span class="n">comment</span><span class="p">:</span> <span class="n">Angstrom</span><span class="o">-</span><span class="n">based</span> <span class="n">Anderson</span> <span class="o">&amp;</span> <span class="n">Ogren</span> <span class="mi">1998</span> <span class="n">corr</span> <span class="n">used</span> <span class="k">for</span> <span class="n">truncation</span> <span class="n">correction</span>

   <span class="n">Data</span>
   <span class="o">--------</span>
<span class="p">[[</span><span class="mf">3.10000000e+01</span> <span class="mf">3.10416660e+01</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">9.99000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.10416670e+01</span> <span class="mf">3.10833330e+01</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">9.99000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.10833330e+01</span> <span class="mf">3.11249990e+01</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">9.99000000e-01</span><span class="p">]</span>
 <span class="o">...</span>
 <span class="p">[</span><span class="mf">3.64875000e+02</span> <span class="mf">3.64916666e+02</span> <span class="mf">9.04000000e+02</span> <span class="o">...</span> <span class="mf">1.35433110e+01</span>
  <span class="mf">1.62446480e+01</span> <span class="mf">1.00000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.64916667e+02</span> <span class="mf">3.64958333e+02</span> <span class="mf">9.04000000e+02</span> <span class="o">...</span> <span class="mf">1.13367710e+01</span>
  <span class="mf">1.42932090e+01</span> <span class="mf">1.00000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.64958333e+02</span> <span class="mf">3.64999999e+02</span> <span class="mf">9.03000000e+02</span> <span class="o">...</span> <span class="mf">1.13635590e+01</span>
  <span class="mf">1.40839410e+01</span> <span class="mf">1.00000000e-01</span><span class="p">]]</span>
<span class="n">Colnum</span><span class="p">:</span> <span class="mi">24</span>
<span class="n">Timestamps</span><span class="p">:</span> <span class="mi">8016</span>
</pre></div>
</div>
<p>The NASA Ames files are strucured in the same way as they are
represented by in the instance of the EbasNasaAmesFile class.</p>
<ul class="simple">
<li><p>A header with global metadata</p></li>
<li><p>One row that specifies multiplication factors for each data column
(<code class="docutils literal notranslate"><span class="pre">mul_factors</span></code>)</p></li>
<li><p>One row that specifies NaN-equivalent values for each data column
(<code class="docutils literal notranslate"><span class="pre">vals_invalid</span></code>)</p></li>
<li><p>A number of rows specifying metainformation for each data column in
the file (i.e. 12 rows, if the data has 12 columns)</p></li>
<li><p>Dataset specific metadata</p></li>
<li><p>Data block: rows are timestamps, columns are different columns
specified in the header (cf. 2 points above)</p>
<ul>
<li><p>Represented by 2D numpy array (<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute) where first
index is row and second index is column</p></li>
</ul>
</li>
</ul>
<p>For details related to the file format <a class="reference external" href="https://ebas-submit.nilu.no/Submit-Data/Data-Reporting/Templates/Category/Aerosol/Aerosol-Optical-Depth">see
here</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">8016</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="data-array">
<h4>Data array<a class="headerlink" href="#data-array" title="Permalink to this headline">¶</a></h4>
<p>The data is imported as a 2D numpy array which is accessible via the
<code class="docutils literal notranslate"><span class="pre">data</span></code> attribute:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">3.10000000e+01</span><span class="p">,</span> <span class="mf">3.10416660e+01</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
                   <span class="n">nan</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="mf">9.99000000e-01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.10416670e+01</span><span class="p">,</span> <span class="mf">3.10833330e+01</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
                   <span class="n">nan</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="mf">9.99000000e-01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.10833330e+01</span><span class="p">,</span> <span class="mf">3.11249990e+01</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
                   <span class="n">nan</span><span class="p">,</span>            <span class="n">nan</span><span class="p">,</span> <span class="mf">9.99000000e-01</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="mf">3.64875000e+02</span><span class="p">,</span> <span class="mf">3.64916666e+02</span><span class="p">,</span> <span class="mf">9.04000000e+02</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
        <span class="mf">1.35433110e+01</span><span class="p">,</span> <span class="mf">1.62446480e+01</span><span class="p">,</span> <span class="mf">1.00000000e-01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.64916667e+02</span><span class="p">,</span> <span class="mf">3.64958333e+02</span><span class="p">,</span> <span class="mf">9.04000000e+02</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
        <span class="mf">1.13367710e+01</span><span class="p">,</span> <span class="mf">1.42932090e+01</span><span class="p">,</span> <span class="mf">1.00000000e-01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.64958333e+02</span><span class="p">,</span> <span class="mf">3.64999999e+02</span><span class="p">,</span> <span class="mf">9.03000000e+02</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
        <span class="mf">1.13635590e+01</span><span class="p">,</span> <span class="mf">1.40839410e+01</span><span class="p">,</span> <span class="mf">1.00000000e-01</span><span class="p">]])</span>
</pre></div>
</div>
<p>The first index corresponds to the individual measurements (rows in
file) and the second index corresponds to the individual columns that
are stored in the file.</p>
</div>
<div class="section" id="column-information">
<h4>Column information<a class="headerlink" href="#column-information" title="Permalink to this headline">¶</a></h4>
<p>Detailed information about each column can be accessed via the
<code class="docutils literal notranslate"><span class="pre">var_defs</span></code> attribute, the first two columns are always the start and
stop timestamps:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span>
</pre></div>
</div>
<p>After the start / stop columns follow the individual data columns.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">hPa</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">relative_humidity</span><span class="p">,</span> <span class="n">unit</span><span class="o">=%</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">instrument</span><span class="p">,</span> <span class="n">detection_limit</span><span class="o">=</span><span class="p">,</span> <span class="n">detection_limit_expl</span><span class="o">.=</span><span class="p">,</span> <span class="n">measurement_uncertainty</span><span class="o">=</span><span class="p">,</span> <span class="n">measurement_uncertainty_expl</span><span class="o">.=</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="n">arithmetic</span> <span class="n">mean</span><span class="p">,</span>
</pre></div>
</div>
<p>In addition to the data columns in the files (such as time stamps, or
measured values of a certain variable) there is <strong>at least one</strong> flag
column in the data array and each data column has assigned one flag
column (cf. output above where the index of the flag column for each
data column is provided <code class="docutils literal notranslate"><span class="pre">flag_col=23</span></code>, i.e. column 23 is the flag
column assigned to each of the 5 data columns that were displayed
exemplary above:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">var_defs</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">no</span> <span class="n">unit</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flag_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">is_var</span></code> attribute specifies, whether this column contains actual
variable data or if it is a flag column. A NASA Ames file can have one
or more flag columns that can be used to identify valid or invalid
measurments. Each flag in a flag column comprises a floating point
number that has encoded up to 3 3-digit numerical flags which are
specified here:</p>
<p><a class="reference external" href="https://github.com/metno/pyaerocom/blob/master/pyaerocom/data/ebas_flags.csv">https://github.com/metno/pyaerocom/blob/master/pyaerocom/data/ebas_flags.csv</a></p>
<p>More info about the flags follows below. You can see, that the column 4
printed above has assigned column 12 (index 11) as flag column.</p>
<p>If you want to see an overview of all available columns in the file you
may use the following command:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">print_col_info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Column</span> <span class="mi">0</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">starttime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>

<span class="n">Column</span> <span class="mi">1</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">endtime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>

<span class="n">Column</span> <span class="mi">2</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">pressure</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">hPa</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
<span class="n">matrix</span><span class="p">:</span> <span class="n">instrument</span>
<span class="n">detection_limit</span><span class="p">:</span>
<span class="n">detection_limit_expl</span><span class="o">.</span><span class="p">:</span>
<span class="n">measurement_uncertainty</span><span class="p">:</span>
<span class="n">measurement_uncertainty_expl</span><span class="o">.</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">3</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">relative_humidity</span>
<span class="n">unit</span><span class="p">:</span> <span class="o">%</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
<span class="n">matrix</span><span class="p">:</span> <span class="n">instrument</span>
<span class="n">detection_limit</span><span class="p">:</span>
<span class="n">detection_limit_expl</span><span class="o">.</span><span class="p">:</span>
<span class="n">measurement_uncertainty</span><span class="p">:</span>
<span class="n">measurement_uncertainty_expl</span><span class="o">.</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">4</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">temperature</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">K</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
<span class="n">matrix</span><span class="p">:</span> <span class="n">instrument</span>
<span class="n">detection_limit</span><span class="p">:</span>
<span class="n">detection_limit_expl</span><span class="o">.</span><span class="p">:</span>
<span class="n">measurement_uncertainty</span><span class="p">:</span>
<span class="n">measurement_uncertainty_expl</span><span class="o">.</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">5</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">6</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">7</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">8</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">9</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">10</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">11</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">12</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">13</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">14</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">15</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">16</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">17</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">18</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">19</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">20</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>

<span class="n">Column</span> <span class="mi">21</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">15.87</span>

<span class="n">Column</span> <span class="mi">22</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="mi">23</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>
<span class="n">statistics</span><span class="p">:</span> <span class="n">percentile</span><span class="p">:</span><span class="mf">84.13</span>

<span class="n">Column</span> <span class="mi">23</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">no</span> <span class="n">unit</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">flag_col</span><span class="p">:</span> <span class="kc">None</span>
</pre></div>
</div>
<p>You can see that all variable columns were assigned the same flag
column, since there is only one flag column at the end (index 23). This
would be different if there were multiple flag columns (e.g. one for
each variable).</p>
</div>
<div class="section" id="access-flag-information">
<h4>Access flag information<a class="headerlink" href="#access-flag-information" title="Permalink to this headline">¶</a></h4>
<p>You can access the flags for each column using the <code class="docutils literal notranslate"><span class="pre">flag_col_info</span></code>
attribute of the file (and the key of the respective flag column, that
you want to access, here-&gt;11).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">flag_col_info</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
<span class="n">flagcol</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_nasa_ames</span><span class="o">.</span><span class="n">EbasFlagCol</span> <span class="n">at</span> <span class="mh">0x7fc83276e320</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The raw flags can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">raw_data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.999</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.1</span>  <span class="p">,</span> <span class="mf">0.1</span>  <span class="p">,</span> <span class="mf">0.1</span>  <span class="p">])</span>
</pre></div>
</div>
<p>And the processed flags are in stored in a (Nx3) numpy array where N is
the total number of timestamps.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">decoded</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="mi">100</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">100</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">100</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>For instance, access the flags of the 5 timestamp:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">decoded</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>This timestamp contains 1 (of the possible up to 3) flags: 999.</p>
<p>Validity of a combination of the flags can be directly accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">valid</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<p>This flag (999) evaluates to an invalid measurement. Looking into <a class="reference external" href="https://github.com/metno/pyaerocom/blob/master/pyaerocom/data/ebas_flags.csv">the
flag definition
file</a>
we see that these two flags have the following meaning:</p>
<ul class="simple">
<li><p>999,‘Missing measurement, unspecified reason’,‘M’</p></li>
</ul>
<p>where the last string specifies if this flag is valid (V) or invalid (I)
or missing (M).</p>
</div>
<div class="section" id="convert-object-to-pandas-dataframe">
<h4>Convert object to pandas Dataframe<a class="headerlink" href="#convert-object-to-pandas-dataframe" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>starttime_days</th>
      <th>endtime_days</th>
      <th>pressure_hPa_instrument_arithmetic mean</th>
      <th>relative_humidity_%_instrument_arithmetic mean</th>
      <th>temperature_K_instrument_arithmetic mean</th>
      <th>aerosol_light_backscattering_coefficient_1/Mm_450.0nm_arithmetic mean</th>
      <th>aerosol_light_backscattering_coefficient_1/Mm_450.0nm_percentile:15.87</th>
      <th>aerosol_light_backscattering_coefficient_1/Mm_450.0nm_percentile:84.13</th>
      <th>aerosol_light_backscattering_coefficient_1/Mm_550.0nm_arithmetic mean</th>
      <th>aerosol_light_backscattering_coefficient_1/Mm_550.0nm_percentile:15.87</th>
      <th>...</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_450.0nm_arithmetic mean</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_450.0nm_percentile:15.87</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_450.0nm_percentile:84.13</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_550.0nm_arithmetic mean</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_550.0nm_percentile:15.87</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_550.0nm_percentile:84.13</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_700.0nm_arithmetic mean</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_700.0nm_percentile:15.87</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_700.0nm_percentile:84.13</th>
      <th>numflag_no unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010-02-01 00:29:59</td>
      <td>31.000000</td>
      <td>31.041666</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.999</td>
    </tr>
    <tr>
      <td>2010-02-01 01:29:59</td>
      <td>31.041667</td>
      <td>31.083333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.999</td>
    </tr>
    <tr>
      <td>2010-02-01 02:29:59</td>
      <td>31.083333</td>
      <td>31.124999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.999</td>
    </tr>
    <tr>
      <td>2010-02-01 03:29:59</td>
      <td>31.125000</td>
      <td>31.166666</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.999</td>
    </tr>
    <tr>
      <td>2010-02-01 04:29:59</td>
      <td>31.166667</td>
      <td>31.208333</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.999</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div><div class="section" id="you-may-also-apply-selection-constraints-when-converting-to-a-dataframe">
<h5>You may also apply selection constraints when converting to a DataFrame<a class="headerlink" href="#you-may-also-apply-selection-constraints-when-converting-to-a-dataframe" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scattering</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;arithmetic mean&#39;</span><span class="p">)</span>
<span class="n">scattering</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aerosol_light_scattering_coefficient_1/Mm_450.0nm_arithmetic mean</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_550.0nm_arithmetic mean</th>
      <th>aerosol_light_scattering_coefficient_1/Mm_700.0nm_arithmetic mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2010-02-01 00:29:59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2010-02-01 01:29:59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2010-02-01 02:29:59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2010-02-01 03:29:59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2010-02-01 04:29:59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2010-12-31 19:29:59</td>
      <td>29.312950</td>
      <td>19.707840</td>
      <td>13.09690</td>
    </tr>
    <tr>
      <td>2010-12-31 20:29:59</td>
      <td>28.166000</td>
      <td>19.270330</td>
      <td>11.51522</td>
    </tr>
    <tr>
      <td>2010-12-31 21:29:59</td>
      <td>36.854919</td>
      <td>25.116589</td>
      <td>14.89398</td>
    </tr>
    <tr>
      <td>2010-12-31 22:29:59</td>
      <td>30.724499</td>
      <td>21.249210</td>
      <td>12.81499</td>
    </tr>
    <tr>
      <td>2010-12-31 23:29:59</td>
      <td>28.431919</td>
      <td>20.387381</td>
      <td>12.72375</td>
    </tr>
  </tbody>
</table>
<p>8016 rows × 3 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scattering</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7fc832781358</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/add02_read_ebas_nasa_ames_40_1.png" src="_images/add02_read_ebas_nasa_ames_40_1.png" />
</div>
</div>
</div>
<div class="section" id="ebas-file-query-and-database-browser">
<h3>EBAS file query and database browser<a class="headerlink" href="#ebas-file-query-and-database-browser" title="Permalink to this headline">¶</a></h3>
<p>The previous tutorial showed how to read EBAS NASA Ames files and gave
insights into the structure of these files. However, this did not
include the specification of an actual data request (for instance: get
data from all stations in the arctic that contain measurements of the
AOD between 2010 and 2016).</p>
<p>In this tutorial, we show, how such requests can be specified easily in
pyaerocom and how the database can be browsed for instance by variable
name, type of instrument, location or other relevant parameters.</p>
<p>The notebook is categorised as follows:</p>
<ul class="simple">
<li><p>Defining a request</p></li>
<li><p>Retrieve all files for a request</p></li>
<li><p>Browse the database</p></li>
</ul>
<div class="section" id="specifying-a-request">
<h4>Specifying a request<a class="headerlink" href="#specifying-a-request" title="Permalink to this headline">¶</a></h4>
<p>Request parameters can be specified using the <code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class.
E.g.:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_file_index</span><span class="o">.</span><span class="n">EbasSQLRequest</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;pressure&#39;</span><span class="p">),</span>
                                                  <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span>
                                                  <span class="n">stop_date</span><span class="o">=</span><span class="s2">&quot;2011-01-01&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.020</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">datalevel</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also output the actual SQL query string:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The request class is an extended dictionary and can thus be used like a
dictionary:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">instrument_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;nephelometer&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">datalevel</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="execution-of-file-request-query">
<h4>Execution of file request query<a class="headerlink" href="#execution-of-file-request-query" title="Permalink to this headline">¶</a></h4>
<p>Now that we have defined which files we would like to look into, we can
execute the query and retrieve all files that match our specifications.
This can be done with the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasFileIndex</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found:</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Request:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span><span class="mi">78</span>
<span class="n">Request</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">datalevel</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="browsing-the-database">
<h4>Browsing the database<a class="headerlink" href="#browsing-the-database" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class provides some convenience function that
allow to browse meta information for a given request. These are
illustrated in the following:</p>
<p>For instance, we can check, what variables could actually be retrieved
in the request:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_variables</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or what matrices the data contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_matrices</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;instrument&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm10&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm1&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or which station coordinates (lon, lat) the dataset contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">23.583333</span><span class="p">,</span> <span class="mf">42.166667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">79.783839</span><span class="p">,</span> <span class="mf">44.231006</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">122.9576034546</span><span class="p">,</span> <span class="mf">50.059299469</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">104.986864</span><span class="p">,</span> <span class="mf">54.353743</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.985</span><span class="p">,</span> <span class="mf">46.5475</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.0096197128</span><span class="p">,</span> <span class="mf">47.8014984131</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.93386</span><span class="p">,</span> <span class="mf">51.53014</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.97964</span><span class="p">,</span> <span class="mf">47.4165</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">8.266</span><span class="p">,</span> <span class="o">-</span><span class="mf">70.666</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">16.4994</span><span class="p">,</span> <span class="mf">28.309</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.605</span><span class="p">,</span> <span class="mf">37.164</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.733333</span><span class="p">,</span> <span class="mf">37.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.35</span><span class="p">,</span> <span class="mf">41.766667</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.964886</span><span class="p">,</span> <span class="mf">45.772223</span><span class="p">),</span> <span class="p">(</span><span class="mf">25.666667</span><span class="p">,</span> <span class="mf">35.316667</span><span class="p">),</span> <span class="p">(</span><span class="mf">19.583333</span><span class="p">,</span> <span class="mf">46.966667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">9.89944</span><span class="p">,</span> <span class="mf">53.32583</span><span class="p">),</span> <span class="p">(</span><span class="mf">77.151389</span><span class="p">,</span> <span class="mf">28.427778</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.633333</span><span class="p">,</span> <span class="mf">45.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.7</span><span class="p">,</span> <span class="mf">44.183333</span><span class="p">),</span> <span class="p">(</span><span class="mf">126.3300018311</span><span class="p">,</span> <span class="mf">36.5383338928</span><span class="p">),</span> <span class="p">(</span><span class="mf">126.17</span><span class="p">,</span> <span class="mf">33.28</span><span class="p">),</span> <span class="p">(</span><span class="mf">4.926389</span><span class="p">,</span> <span class="mf">51.970278</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.252</span><span class="p">,</span> <span class="mf">58.38853</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.88668</span><span class="p">,</span> <span class="mf">78.90715</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.533333</span><span class="p">,</span> <span class="o">-</span><span class="mf">72.016667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">65.618</span><span class="p">,</span> <span class="mf">18.381</span><span class="p">),</span> <span class="p">(</span><span class="mf">13.15</span><span class="p">,</span> <span class="mf">56.016667</span><span class="p">),</span> <span class="p">(</span><span class="mf">120.87</span><span class="p">,</span> <span class="mf">23.47</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9841</span><span class="p">,</span> <span class="mf">35.9731</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.1288</span><span class="p">,</span> <span class="mf">36.0778</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.6832</span><span class="p">,</span> <span class="mf">34.3405</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">88.36667</span><span class="p">,</span> <span class="mf">40.05</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">83.9416</span><span class="p">,</span> <span class="mf">35.6334</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.8</span><span class="p">,</span> <span class="mf">31.9506</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.3889</span><span class="p">,</span> <span class="mf">32.0097</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">155.5761566162</span><span class="p">,</span> <span class="mf">19.5362300873</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">86.148</span><span class="p">,</span> <span class="mf">37.1317</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">68.2608</span><span class="p">,</span> <span class="mf">44.3772</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">113.9958</span><span class="p">,</span> <span class="mf">48.5103</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">114.2158</span><span class="p">,</span> <span class="mf">39.005</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">81.7</span><span class="p">,</span> <span class="mf">36.2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">103.1772</span><span class="p">,</span> <span class="mf">29.3022</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">78.4358</span><span class="p">,</span> <span class="mf">38.5225</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">122.1243</span><span class="p">,</span> <span class="mf">46.7582</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">97.484999</span><span class="p">,</span> <span class="mf">36.605</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">24.7999992371</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.9969482422</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">124.1510009766</span><span class="p">,</span> <span class="mf">41.0541000366</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">105.5457</span><span class="p">,</span> <span class="mf">40.2783</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9692</span><span class="p">,</span> <span class="mf">35.1406</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">77.04</span><span class="p">,</span> <span class="mf">38.9</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.7958</span><span class="p">,</span> <span class="mf">34.9139</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.48968</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.35348</span><span class="p">)]</span>
</pre></div>
</div>
<p>Now, let’s narrow this down:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.88668</span><span class="p">,</span> <span class="mf">78.90715</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">)]</span>
</pre></div>
</div>
<p>Print all station names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_station_names</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-browsing">
<h4>Custom browsing<a class="headerlink" href="#custom-browsing" title="Permalink to this headline">¶</a></h4>
<p>The previous browsing methods (e.g. <code class="docutils literal notranslate"><span class="pre">contains_coordinates()</span></code>,
<code class="docutils literal notranslate"><span class="pre">contains_matrices</span></code>, <code class="docutils literal notranslate"><span class="pre">contains_variables</span></code>) are all just simple
wrappers for the general query method <code class="docutils literal notranslate"><span class="pre">make_query_str</span></code> of the
<code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class, that is then called by the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code>
class using the method <code class="docutils literal notranslate"><span class="pre">execute_request</span></code>). Thus, if needed, you may
define your own request simply by using the provided interface. Here an
example using the request constraints specified above. Let’s say we want
to retrieve a list of station names and their coordinates (lon, lat,
alt). This can be done by calling (we store the results in a list named
<code class="docutils literal notranslate"><span class="pre">station_info</span></code>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_str</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;station_name&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_longitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_latitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_altitude&quot;</span><span class="p">))</span>

<span class="n">station_info</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">query_str</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">station_info</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">,</span> <span class="mf">210.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,</span> <span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">,</span> <span class="mf">181.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,</span> <span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">,</span> <span class="mf">565.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,</span> <span class="mf">11.88668</span><span class="p">,</span> <span class="mf">78.90715</span><span class="p">,</span> <span class="mf">474.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that the results for each station are stored in tuples in
the order of the request.</p>
</div>
<div class="section" id="read-all-files">
<h4>Read all files<a class="headerlink" href="#read-all-files" title="Permalink to this headline">¶</a></h4>
<p>Let’s update the file list and read all files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Let’s read the files:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OBSCONFIG</span><span class="p">[</span><span class="s2">&quot;EBASMC&quot;</span><span class="p">][</span><span class="s2">&quot;PATH&quot;</span><span class="p">],</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="merging-of-several-stationdata-objects-into-one">
<h3>Merging of several StationData objects into one<a class="headerlink" href="#merging-of-several-stationdata-objects-into-one" title="Permalink to this headline">¶</a></h3>
<p>This notebook illustrates to can merge several instances StationData
objects into one objects. This merging only works for data from the same
station and a typical case is if the data source files for one station
are separated into many single files containing only parts of the data
(e.g. if the files contain only one year of data).</p>
<p>In the following, the example of the EBAS database is used for
illustration. In particular, we will focus on the retrieval of the
aerosol light scattering coefficients at 550 nm (<strong>scatc550aer</strong> in
AEROCOM naming convention) for the station <strong>Jungfraujoch</strong>, located in
Germany.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initating</span> <span class="n">pyaerocom</span> <span class="n">configuration</span>
<span class="n">Checking</span> <span class="n">database</span> <span class="n">access</span><span class="o">...</span>
<span class="n">Checking</span> <span class="n">access</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span>
<span class="n">Access</span> <span class="n">to</span> <span class="n">lustre</span> <span class="n">database</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Init</span> <span class="n">data</span> <span class="n">paths</span> <span class="k">for</span> <span class="n">lustre</span>
<span class="n">Expired</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.021</span> <span class="n">s</span>
</pre></div>
</div>
<div class="section" id="get-list-of-all-files-containing-scattering-data-for-ebas-station-jungfraujoch">
<h4>Get list of all files containing scattering data for EBAS station Jungfraujoch<a class="headerlink" href="#get-list-of-all-files-containing-scattering-data-for-ebas-station-jungfraujoch" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadEbas</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span>
                            <span class="n">datalevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">station_names</span><span class="o">=</span><span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Retrieving</span> <span class="n">EBAS</span> <span class="n">files</span> <span class="k">for</span> <span class="n">variables</span>
<span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">]</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">1</span><span class="o">-</span><span class="mi">3</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">23</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">3</span><span class="o">-</span><span class="mi">5</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">23</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">5</span><span class="o">-</span><span class="mi">7</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">7</span><span class="o">-</span><span class="mi">9</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">9</span><span class="o">-</span><span class="mi">11</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">24</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">11</span><span class="o">-</span><span class="mi">13</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">25</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">13</span><span class="o">-</span><span class="mi">15</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">15</span><span class="o">-</span><span class="mi">17</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">26</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">17</span><span class="o">-</span><span class="mi">19</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">27</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">19</span><span class="o">-</span><span class="mi">21</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">27</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">21</span><span class="o">-</span><span class="mi">23</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">28</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">23</span><span class="o">-</span><span class="mi">25</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">28</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">25</span><span class="o">-</span><span class="mi">27</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">29</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
<span class="n">Reading</span> <span class="n">files</span> <span class="mi">27</span><span class="o">-</span><span class="mi">29</span> <span class="n">of</span> <span class="mi">28</span> <span class="p">(</span><span class="n">ReadEbas</span><span class="p">)</span> <span class="o">|</span> <span class="mi">15</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">30</span> <span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">s</span><span class="s1">&#39;)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;EBASMC&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;IN3563&#39;</span><span class="p">,</span> <span class="s1">&#39;TSI_3563_JFJ_dry&#39;</span><span class="p">,</span> <span class="s1">&#39;Ecotech_Aurora3000_JFJ_dry&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">meta</span><span class="o">-</span><span class="n">blocks</span><span class="p">:</span> <span class="mi">28</span>
<span class="n">Filters</span> <span class="n">that</span> <span class="n">were</span> <span class="n">applied</span><span class="p">:</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20191012155523</span>
    <span class="n">prefer_statistics</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;arithmetic mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">]</span>
    <span class="n">wavelength_tol_nm</span><span class="p">:</span> <span class="mi">50</span>
    <span class="n">datalevel</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">station_names</span><span class="p">:</span> <span class="n">Jungfraujoch</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20191012155531</span>
    <span class="n">Removed</span> <span class="mi">0</span> <span class="n">metadata</span> <span class="n">blocks</span> <span class="n">that</span> <span class="n">have</span> <span class="n">no</span> <span class="n">data</span> <span class="n">assigned</span>
</pre></div>
</div>
<p>As you can see, the data has successfully been imported into an instance
of the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class. This class is organised <em>by file</em>, that
is, for each of the 26 files that were imported, there is one metadata
dictionary assigned. Let’s look at the metadata from the first file:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mf">46.5475</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mf">7.985</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="mf">3578.0</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span>
              <span class="s1">&#39;CH0001G.19950101000000.20181031145000.nephelometer..aerosol.1y.1h.CH02L_IN3563.CH02L_backscat_coef.lev2.nas&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="s1">&#39;CH0001G&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;instrument_name&#39;</span><span class="p">,</span> <span class="s1">&#39;IN3563&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="s1">&#39;Baltensperger, Urs; Weingartner, Ernest&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;hourly&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_id&#39;</span><span class="p">,</span> <span class="s1">&#39;EBASMC&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_product&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_version&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_level&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;revision_date&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-10-31T00:00:00&#39;</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;stat_merge_pref_attr&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_revision&#39;</span><span class="p">,</span> <span class="s1">&#39;20191001&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;var_info&#39;</span><span class="p">,</span>
              <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span>
                            <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;1/Mm&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span> <span class="s1">&#39;550.0 nm&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;method_ref&#39;</span><span class="p">,</span> <span class="s1">&#39;CH02L_scat_coef&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;statistics&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;arithmetic mean&#39;</span><span class="p">)]))])),</span>
             <span class="p">(</span><span class="s1">&#39;variables&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<p>And the last one:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="mf">46.5475</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="mf">7.985</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="mf">3580.0</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span>
              <span class="s1">&#39;CH0001G.20170101000000.20190524143212.nephelometer..aerosol.1y.1h.CH02L_Ecotech_Aurora3000_JFJ_dry.CH02L_Neph_Aurora3000.lev2.nas&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_id&#39;</span><span class="p">,</span> <span class="s1">&#39;CH0001G&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;instrument_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Ecotech_Aurora3000_JFJ_dry&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="s1">&#39;Bukowiecki, Nicolas; Baltensperger, Urs&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;hourly&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_id&#39;</span><span class="p">,</span> <span class="s1">&#39;EBASMC&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_product&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_version&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_level&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;revision_date&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-05-24T00:00:00&#39;</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;stat_merge_pref_attr&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;data_revision&#39;</span><span class="p">,</span> <span class="s1">&#39;20191001&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;var_info&#39;</span><span class="p">,</span>
              <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span>
                            <span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;1/Mm&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;wavelength&#39;</span><span class="p">,</span> <span class="s1">&#39;525.0 nm&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;statistics&#39;</span><span class="p">,</span> <span class="s1">&#39;arithmetic mean&#39;</span><span class="p">),</span>
                                         <span class="p">(</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol&#39;</span><span class="p">)]))])),</span>
             <span class="p">(</span><span class="s1">&#39;variables&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<p>As you can see, both files contain scattering data but do not share all
the same metadata attributes (e.g. <code class="docutils literal notranslate"><span class="pre">instrument_name</span></code> is different,
which might be due to technological updates over time).</p>
<p>Let’s have a look at the respective time-series for both stations.
First, convert into instance of <code class="docutils literal notranslate"><span class="pre">StationData</span></code> class and then plot.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_file</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vars_to_convert</span><span class="o">=</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
    <span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>
    <span class="n">method_ref</span><span class="p">:</span> <span class="n">CH02L_scat_coef</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
    <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">3578.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">filename</span><span class="p">:</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19950101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
<span class="n">station_id</span><span class="p">:</span> <span class="n">CH0001G</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Jungfraujoch</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">IN3563</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Baltensperger</span><span class="p">,</span> <span class="n">Urs</span><span class="p">;</span> <span class="n">Weingartner</span><span class="p">,</span> <span class="n">Ernest</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
<span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">3578.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">EBASMC</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">31</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20191001</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">1995</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T01</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T22</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">,</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">scatc550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">last_file</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">last_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
    <span class="n">wavelength</span><span class="p">:</span> <span class="mf">525.0</span> <span class="n">nm</span>
    <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">3580.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">filename</span><span class="p">:</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20170101000000.20190524143212</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
<span class="n">station_id</span><span class="p">:</span> <span class="n">CH0001G</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Jungfraujoch</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">Ecotech_Aurora3000_JFJ_dry</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Bukowiecki</span><span class="p">,</span> <span class="n">Nicolas</span><span class="p">;</span> <span class="n">Baltensperger</span><span class="p">,</span> <span class="n">Urs</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
<span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">3580.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">EBASMC</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">revision_date</span><span class="p">:</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">24</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20191001</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">2017</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T01</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T22</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">,</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mf">59.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">scatc550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_file</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_11_0.png" src="_images/add04_stationdata_merging_11_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">last_file</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_12_0.png" src="_images/add04_stationdata_merging_12_0.png" />
<p>As you can see, the files contain data from different years. Now, how
can we get these objects into one object that contains the timeseries of
both files from this station?</p>
<p>This is actually very easy:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">first_file</span><span class="o">.</span><span class="n">merge_other</span><span class="p">(</span><span class="n">last_file</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
    <span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span><span class="p">;</span><span class="mf">525.0</span> <span class="n">nm</span>
    <span class="n">method_ref</span><span class="p">:</span> <span class="n">CH02L_scat_coef</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
    <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
    <span class="n">apply_constraints</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">min_num_obs</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">3578.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">filename</span><span class="p">:</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19950101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20170101000000.20190524143212</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
<span class="n">station_id</span><span class="p">:</span> <span class="n">CH0001G</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Jungfraujoch</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">IN3563</span><span class="p">;</span> <span class="n">Ecotech_Aurora3000_JFJ_dry</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Baltensperger</span><span class="p">,</span> <span class="n">Urs</span><span class="p">;</span> <span class="n">Weingartner</span><span class="p">,</span> <span class="n">Ernest</span><span class="p">;</span> <span class="n">Bukowiecki</span><span class="p">,</span> <span class="n">Nicolas</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
<span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">3578.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">EBASMC</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">revision_date</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">2</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-10-31T00:00:00&#39;</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-05-24T00:00:00&#39;</span><span class="p">)]</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20191001</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">9794</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">1995</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">08</span><span class="n">T23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">09</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">24</span><span class="n">T19</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">scatc550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">9794</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see in the output, the merging comprises not only the data
arrays but also registers any differences in the assoicated metdadata
(cf. e.g., sampling wavelength 550 nm vs. 525 nm, instrument name, PI)</p>
<p>Now, have a look at the merged timeseries data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_17_0.png" src="_images/add04_stationdata_merging_17_0.png" />
<p>Looks okay. Let’s merge all 26 files and see if we get a nice long time
series.</p>
<p>Retrieve list of <code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">merge_if_multi</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of StationData objects retrieved: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stats</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">StationData</span> <span class="n">objects</span> <span class="n">retrieved</span><span class="p">:</span> <span class="mi">28</span>
</pre></div>
</div>
<p>Now merge them into one long time series:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">merge_station_data</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">StationData</span>
<span class="o">---------------------</span>
<span class="n">var_info</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
    <span class="n">units</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
    <span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span><span class="p">;</span><span class="mf">525.0</span> <span class="n">nm</span>
    <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
    <span class="n">apply_constraints</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">min_num_obs</span><span class="p">:</span> <span class="kc">None</span>
    <span class="n">method_ref</span><span class="p">:</span> <span class="n">CH02L_scat_coef</span>
<span class="n">station_coords</span> <span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
  <span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
  <span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
  <span class="n">altitude</span><span class="p">:</span> <span class="mf">3580.0</span>
<span class="n">data_err</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span> <span class="o">&lt;</span><span class="n">empty_dict</span><span class="o">&gt;</span>
<span class="n">overlap</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span><span class="p">:</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.255198</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>   <span class="o">-</span><span class="mf">0.284809</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">03</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.123830</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.127599</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.052224</span>
                         <span class="o">...</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">19</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>   <span class="o">-</span><span class="mf">0.030204</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.625988</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">21</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.178854</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">22</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.175893</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.329280</span>
<span class="n">Length</span><span class="p">:</span> <span class="mi">25787</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
<span class="n">data_flagged</span> <span class="p">(</span><span class="n">BrowseDict</span><span class="p">):</span>
  <span class="n">scatc550aer</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">8760</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">filename</span><span class="p">:</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20010101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20100101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20060101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20180101000000.20190520125514</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20040101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20180101000000.20190520124723</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20080101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20050101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20070101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20110101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20030101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20150101000000.20190524143212</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20170101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20160101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20000101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20140101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20020101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20090101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20120101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20130101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19980101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19960101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20170101000000.20190524143212</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19990101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20150101000000.20190524142901</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_TSI_3563_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_3563</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">20160101000000.20190524143212</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_Ecotech_Aurora3000_JFJ_dry</span><span class="o">.</span><span class="n">CH02L_Neph_Aurora3000</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19970101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span><span class="p">;</span> <span class="n">CH0001G</span><span class="o">.</span><span class="mf">19950101000000.20181031145000</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">CH02L_IN3563</span><span class="o">.</span><span class="n">CH02L_backscat_coef</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
<span class="n">station_id</span><span class="p">:</span> <span class="n">CH0001G</span>
<span class="n">station_name</span><span class="p">:</span> <span class="n">Jungfraujoch</span>
<span class="n">instrument_name</span><span class="p">:</span> <span class="n">TSI_3563_JFJ_dry</span><span class="p">;</span> <span class="n">Ecotech_Aurora3000_JFJ_dry</span><span class="p">;</span> <span class="n">IN3563</span>
<span class="n">PI</span><span class="p">:</span> <span class="n">Baltensperger</span><span class="p">,</span> <span class="n">Urs</span><span class="p">;</span> <span class="n">Weingartner</span><span class="p">,</span> <span class="n">Ernest</span><span class="p">;</span> <span class="n">Bukowiecki</span><span class="p">,</span> <span class="n">Nicolas</span>
<span class="n">country</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">latitude</span><span class="p">:</span> <span class="mf">46.5475</span>
<span class="n">longitude</span><span class="p">:</span> <span class="mf">7.985</span>
<span class="n">altitude</span><span class="p">:</span> <span class="mf">3580.0</span>
<span class="n">data_id</span><span class="p">:</span> <span class="n">EBASMC</span>
<span class="n">dataset_name</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_product</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_version</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">revision_date</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">3</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-05-24T00:00:00&#39;</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2019-05-20T00:00:00&#39;</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2018-10-31T00:00:00&#39;</span><span class="p">)]</span>
<span class="n">website</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">ts_type_src</span><span class="p">:</span> <span class="n">hourly</span>
<span class="n">stat_merge_pref_attr</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">data_revision</span><span class="p">:</span> <span class="mi">20191001</span>

<span class="n">Data</span> <span class="n">arrays</span>
<span class="o">.................</span>
<span class="n">dtime</span> <span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="mi">205849</span> <span class="n">items</span><span class="p">):</span> <span class="p">[</span><span class="mi">1995</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">08</span><span class="n">T23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">1995</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">09</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T22</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">,</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000000</span><span class="p">]</span>
<span class="n">Pandas</span> <span class="n">Series</span>
<span class="o">.................</span>
<span class="n">scatc550aer</span> <span class="p">(</span><span class="n">Series</span><span class="p">,</span> <span class="mi">205849</span> <span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>And plot…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span>
<span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;yearly&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_23_0.png" src="_images/add04_stationdata_merging_23_0.png" />
</div>
<div class="section" id="comment-for-convenience">
<h4>Comment for convenience….<a class="headerlink" href="#comment-for-convenience" title="Permalink to this headline">¶</a></h4>
<p>Actually, in the default setup you do not really need to think about all
this. As you might have recognised, when creating the list of
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects from the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object (using method
<code class="docutils literal notranslate"><span class="pre">to_station_data</span></code>) we parsed the argument <code class="docutils literal notranslate"><span class="pre">merge_if_multi=False</span></code>.</p>
<p>The default here is <code class="docutils literal notranslate"><span class="pre">True</span></code>, so you can just go ahead and do:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7faa0a0d6b00</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_25_1.png" src="_images/add04_stationdata_merging_25_1.png" />
<p>What’s happening here is, that <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code> internally creates a
list of <code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects and uses the above illustrated method
<code class="docutils literal notranslate"><span class="pre">merge_station_data</span></code> at the end if the input argument
<code class="docutils literal notranslate"><span class="pre">merge_if_multi=True</span></code>.</p>
</div>
<div class="section" id="what-about-overlapping-data">
<h4>What about overlapping data ??<a class="headerlink" href="#what-about-overlapping-data" title="Permalink to this headline">¶</a></h4>
<p>In some situations, there may be overlapping conflicts when merging
multiple time series into one long time-series. In the following, we
illustrate how these overlaps are handled if they occur.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">merge_station_data</span></code> that is illustrated above has some
features to handle overlapping data and in any case, all overlaps that
were detected are stored in the <code class="docutils literal notranslate"><span class="pre">overlap</span></code> attribute of the merged
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> object. Let’s check first if there are any overlaps in
the Jungfraujoch data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">overlap</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BrowseDict</span><span class="p">([(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.255198</span>
             <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>   <span class="o">-</span><span class="mf">0.284809</span>
             <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">03</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.123830</span>
             <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.127599</span>
             <span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">05</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.052224</span>
                                      <span class="o">...</span>
             <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">19</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>   <span class="o">-</span><span class="mf">0.030204</span>
             <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.625988</span>
             <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">21</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.178854</span>
             <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">22</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.175893</span>
             <span class="mi">2018</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span> <span class="mi">23</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>    <span class="mf">0.329280</span>
             <span class="n">Length</span><span class="p">:</span> <span class="mi">25787</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span><span class="p">)])</span>
</pre></div>
</div>
<p>Apparently, there is. You can check out these data (in comparison with
the retrieved time series) as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">add_overlaps</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_30_0.png" src="_images/add04_stationdata_merging_30_0.png" />
</div>
<div class="section" id="how-to-prioritise-certain-stations-from-others-when-deciding-what-goes-into-overlap-and-what-into-the-final-timeseries">
<h4>How to prioritise certain stations from others, when deciding what goes into overlap and what into the final timeseries?<a class="headerlink" href="#how-to-prioritise-certain-stations-from-others-when-deciding-what-goes-into-overlap-and-what-into-the-final-timeseries" title="Permalink to this headline">¶</a></h4>
<p>The method <code class="docutils literal notranslate"><span class="pre">merge_station_data</span></code> provides a bunch of options to handle
that. Things do not be written twice so please read the docstring of the
method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">merge_station_data</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on function merge_station_data in module pyaerocom.helpers:

merge_station_data(stats, var_name, pref_attr=None, sort_by_largest=True, fill_missing_nan=True, <a href="#id8"><span class="problematic" id="id9">**</span></a>add_meta_keys)
    Merge multiple StationData objects (from one station) into one instance

    Note
    ----
    - all input <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code> objects need to have same attributes       <code class="docutils literal notranslate"><span class="pre">station_name</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">altitude</span></code>

    Parameters
    ----------
    stats : list
        list containing <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code> objects (note: all of these
        objects must contain variable data for the specified input variable)
    var_name : str
        data variable name that is to be merged
    pref_attr
        optional argument that may be used to specify a metadata attribute
        that is available in all input <code class="xref py py-class docutils literal notranslate"><span class="pre">StationData</span></code> objects and that
        is used to order the input stations by relevance. The associated values
        of this attribute need to be sortable (e.g. revision_date). This is
        only relevant in case overlaps occur. If unspecified the relevance of
        the stations is sorted based on the length of the associated data
        arrays.
    sort_by_largest : bool
        if True, the result from the sorting is inverted. E.g. if
        <code class="docutils literal notranslate"><span class="pre">pref_attr</span></code> is unspecified, then the stations will be sorted based on
        the length of the data vectors, starting with the shortest, ending with
        the longest. This sorting result will then be inverted, if
        <code class="docutils literal notranslate"><span class="pre">sort_by_largest=True</span></code>, so that the longest time series get's highest
        importance. If, e.g. <code class="docutils literal notranslate"><span class="pre">pref_attr='revision_date'</span></code>, then the stations
        are sorted by the associated revision date value, starting with the
        earliest, ending with the latest (which will also be inverted if
        this argument is set to True)
    fill_missing_nan : bool
        if True, the resulting time series is filled with NaNs. NOTE: this
        requires that information about the temporal resolution (ts_type) of
        the data is available in each of the StationData objects.</pre>
<p>In particular, <code class="docutils literal notranslate"><span class="pre">pref_attr</span></code> and <code class="docutils literal notranslate"><span class="pre">sort_by_largest</span></code> are relevant here.</p>
<p><strong>NOTE</strong>: if <code class="docutils literal notranslate"><span class="pre">pref_attr</span></code> is unspecified, then the stations are sorted
based on the number of valid measurement points for the input variable.
This was done in the merged time series that we retrieved above.</p>
<p>Now, in the following, let’s not use the number of available data points
(to sort the stations by relevance) but prefer stations that have a more
recent data revision date.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">merged_pref_awesomeness</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">merge_station_data</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">pref_attr</span><span class="o">=</span><span class="s1">&#39;awesomeness&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pya</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">MetaDataError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed merging, error: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Failed</span> <span class="n">merging</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="n">MetaDataError</span><span class="p">(</span><span class="s1">&#39;Cannot sort station relevance by attribute awesomeness. At least one of the input stations does not contain this attribute&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Unfortunately, the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects do not contain an attribute
<code class="docutils literal notranslate"><span class="pre">awesomeness</span></code> by which we could sort. Let’s go with <code class="docutils literal notranslate"><span class="pre">revision_date</span></code>
instead:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># recompute stations, since we overwrote one above</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Jungfraujoch&#39;</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">merge_if_multi</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">merged_pref_recent_revision</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">merge_station_data</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">pref_attr</span><span class="o">=</span><span class="s1">&#39;revision_date&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_pref_recent_revision</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">,</span> <span class="n">add_overlaps</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7faa0a25e400</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_37_1.png" src="_images/add04_stationdata_merging_37_1.png" />
<p>Let’s see if there is any difference to the previous method (resample to
daily resolution):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">overlap</span><span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Overlaps (prefer longer timeseries)&#39;</span><span class="p">,</span>
                                                             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">merged_pref_recent_revision</span><span class="o">.</span><span class="n">overlap</span><span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                                                             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Overlaps (prefer more recent)&#39;</span><span class="p">,</span>
                                                                             <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_39_0.png" src="_images/add04_stationdata_merging_39_0.png" />
<p>As you can see, the merging strategy can make an impact and it is
important to define a reasonable strategy. In this case, it is certainly
more reliable to use the data with the more recent revision date.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">merged_pref_recent_revision</span><span class="o">.</span><span class="n">overlap</span><span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">],</span>
                 <span class="n">merged</span><span class="o">.</span><span class="n">overlap</span><span class="p">[</span><span class="s1">&#39;scatc550aer&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/add04_stationdata_merging_41_0.png" src="_images/add04_stationdata_merging_41_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="readme.html" class="btn btn-neutral float-left" title="About" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MET Norway

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>