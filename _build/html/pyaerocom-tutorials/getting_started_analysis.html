

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Diving deeper into the analysis and API &mdash; pyaerocom  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Getting started" href="obsolete/tut00_get_started.html" />
    <link rel="prev" title="Checking pyaerocom installation and access to data" href="getting_started_setup.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pyaerocom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#aerocom">AeroCom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#website-and-code-documentation">Website and code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#installation-of-pyaerocom">Installation of pyaerocom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#access-to-users-database">Access to users database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#getting-started">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#getting-started">Getting started</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="getting_started_setup.html">Checking pyaerocom installation and access to data</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Diving deeper into the analysis and API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Check-access-to-testdata">Check access to testdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Pre-remark-on-the-ReadGridded-class">Pre-remark on the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Time-stamps">Time stamps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Rectangular-regions">Rectangular regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Binary-region-masks">Binary region masks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Filtering-of-time">Filtering of time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Data-selection-over-multiple-dimensions">Data selection over multiple dimensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Regional-averaging">Regional averaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Access-of-individual-stations">Access of individual stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#You-can-also-plot-the-time-series-directly-from-UngriddedData">You can also plot the time-series directly from <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Low-level-colocation-routine(s)">Low-level colocation routine(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Under-the-hood-…">Under the hood …</a></li>
<li class="toctree-l4"><a class="reference internal" href="#High-level-colocation-routine">High-level colocation routine</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#outdated-tutorials">Outdated tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyaerocom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Diving deeper into the analysis and API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pyaerocom-tutorials/getting_started_analysis.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Diving-deeper-into-the-analysis-and-API">
<h1>Diving deeper into the analysis and API<a class="headerlink" href="#Diving-deeper-into-the-analysis-and-API" title="Permalink to this headline">¶</a></h1>
<p>This notebook is meant to give a quick introduction into the main features and workflows of <a class="reference external" href="http://aerocom.met.no/pyaerocom/">pyaerocom</a>.</p>
<p>This includes brief introductions into the following features:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>What?</p></th>
<th class="head"><p>Relevant classes and/or methods</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Finding model and observation data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.browse_database</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.io.utils.browse_database">https://pyaerocom.met.no/api.html#pyaerocom.io.utils.browse_database</a>&gt;`__</p></td>
</tr>
<tr class="row-odd"><td><p>Reading of <strong>gridded</strong> model data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.io.ReadGridded</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.io.readgridded.ReadGridded">https://pyaerocom.met.no/api.html#pyaerocom.io.readgridded.ReadGridded</a>&gt;`__</p></td>
</tr>
<tr class="row-even"><td><p>Working with <strong>gridded</strong> data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.GriddedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.griddeddata.GriddedData">https://pyaerocom.met.no/api.html#pyaerocom.griddeddata.GriddedData</a>&gt;`__</p></td>
</tr>
<tr class="row-odd"><td><p>Reading of <strong>ungridded</strong> observation data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.io.ReadUngridded</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#reading-of-ungridded-data">https://pyaerocom.met.no/api.html#reading-of-ungridded-data</a>&gt;`__</p></td>
</tr>
<tr class="row-even"><td><p>Working with <strong>ungridded</strong> data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.UngriddedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.ungriddeddata.UngriddedData">https://pyaerocom.met.no/api.html#pyaerocom.ungriddeddata.UngriddedData</a>&gt;`__</p></td>
</tr>
<tr class="row-odd"><td><p>Working with data from individual site locations</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.StationData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.stationdata.StationData">https://pyaerocom.met.no/api.html#pyaerocom.stationdata.StationData</a>&gt;`__</p></td>
</tr>
<tr class="row-even"><td><p><strong>Colocation</strong> of model and observational data</p></td>
<td><p>High-level: <code class="docutils literal notranslate"><span class="pre">`pya.colocation_auto</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#module-pyaerocom.colocation_auto">https://pyaerocom.met.no/api.html#module-pyaerocom.colocation_auto</a>&gt;`__</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Low-level: <code class="docutils literal notranslate"><span class="pre">`pya.colocation</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#module-pyaerocom.colocation">https://pyaerocom.met.no/api.html#module-pyaerocom.colocation</a>&gt;`__</p></td>
</tr>
<tr class="row-even"><td><p>Working with <strong>colocated</strong> data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">`pya.ColocatedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.colocateddata.ColocatedData">https://pyaerocom.met.no/api.html#pyaerocom.colocateddata.ColocatedData</a>&gt;`__</p></td>
</tr>
</tbody>
</table>
<p>In a graphical way it introduces the main data object and processing routines for model and observation comparisons with pyaerocom, illustrated in the following flowchart:</p>
<p><img alt="Basic processing flowchart of pyaerocom" src="../_images/pyaerocom_basic_flowchart.png" /></p>
<p>Only that in this example “Data server” is the local computer that has the minimal testdataset as an example dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;0.10.0rc2&#39;
</pre></div></div>
</div>
<p>Should be at least 0.10.X</p>
<div class="section" id="Check-access-to-testdata">
<h2>Check access to testdata<a class="headerlink" href="#Check-access-to-testdata" title="Permalink to this headline">¶</a></h2>
<p><strong>NOTE</strong>: details regarding testdata access and intialization are covered in tutorial notebook <em>getting_started_setup.ipynb</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyaerocom.testdata_access</span> <span class="kn">import</span> <span class="n">initialise</span>
<span class="n">initialise</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Adding data search directory /home/jonasg/MyPyaerocom/testdata-minimal/modeldata.
Adding data search directory /home/jonasg/MyPyaerocom/testdata-minimal/obsdata.
Adding data search directory /home/jonasg/MyPyaerocom/testdata-minimal/config.
Adding ungridded dataset AeronetSunV3L2Subset.daily located at /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed.Reader: &lt;class &#39;pyaerocom.io.read_aeronet_sunv3.ReadAeronetSunV3&#39;&gt;
Adding ungridded dataset AeronetSDAV3L2Subset.daily located at /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSDAV3Lev2.daily/renamed.Reader: &lt;class &#39;pyaerocom.io.read_aeronet_sdav3.ReadAeronetSdaV3&#39;&gt;
Adding ungridded dataset AeronetInvV3L2Subset.daily located at /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetInvV3Lev2.daily/renamed.Reader: &lt;class &#39;pyaerocom.io.read_aeronet_invv3.ReadAeronetInvV3&#39;&gt;
Adding ungridded dataset EBASSubset located at /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/EBASMultiColumn.Reader: &lt;class &#39;pyaerocom.io.read_ebas.ReadEbas&#39;&gt;
pyaerocom-testdata is ready to be used. The data is available at /home/jonasg/MyPyaerocom/testdata-minimal
</pre></div></div>
</div>
<div class="section" id="Model-data:-Reading-of-and-working-with-gridded-data">
<h3>Model data: Reading of and working with <em>gridded</em> data<a class="headerlink" href="#Model-data:-Reading-of-and-working-with-gridded-data" title="Permalink to this headline">¶</a></h3>
<p>This section provides an introduction into the following pyaerocom classes and architectures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">`pyaerocom.io.ReadGridded</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#module-pyaerocom.io.readgridded">https://pyaerocom.met.no/api.html#module-pyaerocom.io.readgridded</a>&gt;`__</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`pyaerocom.GriddedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#module-pyaerocom.griddeddata">https://pyaerocom.met.no/api.html#module-pyaerocom.griddeddata</a>&gt;`__</p></li>
</ul>
<p>*you may click the links to see the online documentation of these classes.</p>
</div>
</div>
<div class="section" id="Pre-remark-on-the-ReadGridded-class">
<h2>Pre-remark on the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class<a class="headerlink" href="#Pre-remark-on-the-ReadGridded-class" title="Permalink to this headline">¶</a></h2>
<p>As you could see in tutorial <a class="reference external" href="https://github.com/metno/pyaerocom-tutorials/blob/master/getting_started_setup.ipynb">getting_started_setup.ipynb</a> the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class makes extensive use of the AeroCom file naming conventions. So if you have model data that is stored using different conventions (e.g. CMIP6), this class will not be of much help (yet) for filtering the correct files to read. In that case you may locate a model NetCDF file yourself and pass it directly into a GriddedData
object on initialisation.</p>
<p>The testdataset contains data from the TM5 model, which is used in the following. You can use the <code class="docutils literal notranslate"><span class="pre">browse_database</span></code> function of pyaerocom to find model ID’s (which can be quite cryptic sometimes) using wildcard pattern search.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;*TM5*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Pyaerocom ReadGridded
---------------------
Data ID: TM5-met2010_CTRL-TEST
Data directory: /home/jonasg/MyPyaerocom/testdata-minimal/modeldata/TM5-met2010_CTRL-TEST/renamed
Available experiments: [&#39;AP3&#39;]
Available years: [2010]
Available frequencies [&#39;daily&#39; &#39;monthly&#39;]
Available variables: [&#39;abs550aer&#39;, &#39;od550aer&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;TM5-met2010_CTRL-TEST&#39;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_id</span> <span class="o">=</span> <span class="s1">&#39;TM5-met2010_CTRL-TEST&#39;</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">model_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can have a look at the individual files and corresponding metadata using the <code class="docutils literal notranslate"><span class="pre">file_info</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reader</span><span class="o">.</span><span class="n">file_info</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>perturbation</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>abs550aer</td>
      <td>2010</td>
      <td>daily</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td>met2010</td>
      <td>AP3</td>
      <td>CTRL2019</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5-met2010_AP3-CTRL2019_abs550aer_Co...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>abs550aer</td>
      <td>2010</td>
      <td>monthly</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td>met2010</td>
      <td>AP3</td>
      <td>CTRL2019</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5-met2010_AP3-CTRL2019_abs550aer_Co...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>od550aer</td>
      <td>2010</td>
      <td>daily</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td>met2010</td>
      <td>AP3</td>
      <td>CTRL2019</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5-met2010_AP3-CTRL2019_od550aer_Col...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>od550aer</td>
      <td>2010</td>
      <td>monthly</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td></td>
      <td>AP3</td>
      <td>CTRL2016</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5_AP3-CTRL2016_od550aer_Column_2010...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You can also filter this attribute based on what you are interested in. E.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reader</span><span class="o">.</span><span class="n">filter_files</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var_name</th>
      <th>year</th>
      <th>ts_type</th>
      <th>vert_code</th>
      <th>data_id</th>
      <th>name</th>
      <th>meteo</th>
      <th>experiment</th>
      <th>perturbation</th>
      <th>is_at_stations</th>
      <th>3D</th>
      <th>filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>od550aer</td>
      <td>2010</td>
      <td>daily</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td>met2010</td>
      <td>AP3</td>
      <td>CTRL2019</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5-met2010_AP3-CTRL2019_od550aer_Col...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>od550aer</td>
      <td>2010</td>
      <td>monthly</td>
      <td>Column</td>
      <td>TM5-met2010_CTRL-TEST</td>
      <td>TM5</td>
      <td></td>
      <td>AP3</td>
      <td>CTRL2016</td>
      <td>False</td>
      <td>False</td>
      <td>aerocom3_TM5_AP3-CTRL2016_od550aer_Column_2010...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_22_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_22_0.png" />
</div>
</div>
<p>Ups, this looks rather incomplete. The reason is that pyaerocom picked the available <em>daily</em> dataset, which is cropped in the <em>minimal</em> testdataset for storage purpose. Let’s try monthly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
<span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_24_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_24_0.png" />
</div>
</div>
<p>Looking better. You may wonder why only January is displayed here. This is because <code class="docutils literal notranslate"><span class="pre">quickplot_map</span></code> picks the first available timestamp in the dataset, you may specify that explicitly.</p>
<p>Under the hood <a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.griddeddata">pyaerocom.GriddedData</a> is based on the <a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">iris.Cube object</a> class (<a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/index.html">iris library</a>) and features very similar functionality (and more).</p>
<p>The loaded <code class="docutils literal notranslate"><span class="pre">Cube</span></code> instance can be accessed via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">cube</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>
  a.iris {
      text-decoration: none !important;
  }
  table.iris {
      white-space: pre;
      border: 1px solid;
      border-color: #9c9c9c;
      font-family: monaco, monospace;
  }
  th.iris {
      background: #303f3f;
      color: #e0e0e0;
      border-left: 1px solid;
      border-color: #9c9c9c;
      font-size: 1.05em;
      min-width: 50px;
      max-width: 125px;
  }
  tr.iris :first-child {
      border-right: 1px solid #9c9c9c !important;
  }
  td.iris-title {
      background: #d5dcdf;
      border-top: 1px solid #9c9c9c;
      font-weight: bold;
  }
  .iris-word-cell {
      text-align: left !important;
      white-space: pre;
  }
  .iris-subheading-cell {
      padding-left: 2em !important;
  }
  .iris-inclusion-cell {
      padding-right: 1em !important;
  }
  .iris-panel-body {
      padding-top: 0px;
  }
  .iris-panel-title {
      padding-left: 3em;
  }
  .iris-panel-title {
      margin-top: 7px;
  }
</style>
<table class="iris" id="139785392029072">
    <tr class="iris">
<th class="iris iris-word-cell">Atmosphere Optical Thickness Due To Ambient Aerosol (1)</th>
<th class="iris iris-word-cell">time</th>
<th class="iris iris-word-cell">latitude</th>
<th class="iris iris-word-cell">longitude</th>
</tr>
    <tr class="iris">
<td class="iris-word-cell iris-subheading-cell">Shape</td>
<td class="iris iris-inclusion-cell">12</td>
<td class="iris iris-inclusion-cell">90</td>
<td class="iris iris-inclusion-cell">120</td>
</td>
    <tr class="iris">
    <td class="iris-title iris-word-cell">Dimension coordinates</td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        time</td>
    <td class="iris-inclusion-cell">x</td>
    <td class="iris-inclusion-cell">-</td>
    <td class="iris-inclusion-cell">-</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        latitude</td>
    <td class="iris-inclusion-cell">-</td>
    <td class="iris-inclusion-cell">x</td>
    <td class="iris-inclusion-cell">-</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        longitude</td>
    <td class="iris-inclusion-cell">-</td>
    <td class="iris-inclusion-cell">-</td>
    <td class="iris-inclusion-cell">x</td>
</tr>
<tr class="iris">
    <td class="iris-title iris-word-cell">Attributes</td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        Conventions</td>
    <td class="iris-word-cell" colspan="3">CF-1.6</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        computed</td>
    <td class="iris-word-cell" colspan="3">False</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        concatenated</td>
    <td class="iris-word-cell" colspan="3">False</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        contact</td>
    <td class="iris-word-cell" colspan="3">Twan van Noije (noije@knmi.nl)</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        data_id</td>
    <td class="iris-word-cell" colspan="3">TM5-met2010_CTRL-TEST</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        experiment</td>
    <td class="iris-word-cell" colspan="3">AP3</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        experiment_id</td>
    <td class="iris-word-cell" colspan="3">AP3-CTRL2016</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        from_files</td>
    <td class="iris-word-cell" colspan="3">['/home/jonasg/MyPyaerocom/testdata-minimal/modeldata/TM5-met2010_CTRL...</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        institute_id</td>
    <td class="iris-word-cell" colspan="3">KNMI</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        institution</td>
    <td class="iris-word-cell" colspan="3">Royal Netherlands Meteorological Institute, De Bilt, The Netherlands</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        meteo</td>
    <td class="iris-word-cell" colspan="3"></td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        model_id</td>
    <td class="iris-word-cell" colspan="3">TM5</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        outliers_removed</td>
    <td class="iris-word-cell" colspan="3">False</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        perturbation</td>
    <td class="iris-word-cell" colspan="3">CTRL2016</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        project_id</td>
    <td class="iris-word-cell" colspan="3">AeroCom Phase 3</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        reader</td>
    <td class="iris-word-cell" colspan="3">None</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        references</td>
    <td class="iris-word-cell" colspan="3">Van Noije, T.P.C., et al. (Geosci. Model Dev., 7, 2435-2475, 2014); Van...</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        region</td>
    <td class="iris-word-cell" colspan="3">None</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        regridded</td>
    <td class="iris-word-cell" colspan="3">False</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        source</td>
    <td class="iris-word-cell" colspan="3">TM5-mp: CTM ERA-Interim 3x2 34L</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        title</td>
    <td class="iris-word-cell" colspan="3">TM5 model output prepared for AeroCom Phase 3</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        ts_type</td>
    <td class="iris-word-cell" colspan="3">monthly</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        var_name_read</td>
    <td class="iris-word-cell" colspan="3">n/d</td>
</tr>
<tr class="iris">
    <td class="iris-title iris-word-cell">Cell methods</td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
    <td class="iris-title"></td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        point</td>
    <td class="iris-word-cell" colspan="3">longitude, latitude</td>
</tr>
<tr class="iris">
    <td class="iris-word-cell iris-subheading-cell">        mean</td>
    <td class="iris-word-cell" colspan="3">time</td>
</tr>
</table></div>
</div>
<p>If you have not heard of xarray, you should <a class="reference external" href="http://xarray.pydata.org/en/stable/">check it out</a>. If you have heard of it (or maybe even used it already) you may convert a <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object to an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xarr</span> <span class="o">=</span> <span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="n">xarr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'od550aer'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 12</li><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>lon</span>: 120</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-40f10542-245b-4515-b2c8-b6699fc9ce9f' class='xr-array-in' type='checkbox' ><label for='section-40f10542-245b-4515-b2c8-b6699fc9ce9f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(12, 90, 61), meta=np.ndarray&gt;</span></div><pre class='xr-array-data'><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 518.40 kB </td> <td> 263.52 kB </td></tr>
    <tr><th> Shape </th><td> (12, 90, 120) </td> <td> (12, 90, 61) </td></tr>
    <tr><th> Count </th><td> 10 Tasks </td><td> 2 Chunks </td></tr>
    <tr><th> Type </th><td> float32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="202" height="162" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="32" y2="22" style="stroke-width:2" />
  <line x1="10" y1="90" x2="32" y2="112" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="90" style="stroke-width:2" />
  <line x1="32" y1="22" x2="32" y2="112" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 32.70403708005059,22.70403708005059 32.70403708005059,112.7040370800506 10.0,90.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="32" y1="22" x2="152" y2="22" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="32" y2="22" style="stroke-width:2" />
  <line x1="71" y1="0" x2="93" y2="22" />
  <line x1="130" y1="0" x2="152" y2="22" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 152.7040370800506,22.70403708005059 32.70403708005059,22.70403708005059" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="32" y1="22" x2="152" y2="22" style="stroke-width:2" />
  <line x1="32" y1="112" x2="152" y2="112" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="32" y1="22" x2="32" y2="112" style="stroke-width:2" />
  <line x1="93" y1="22" x2="93" y2="112" />
  <line x1="152" y1="22" x2="152" y2="112" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="32.70403708005059,22.70403708005059 152.7040370800506,22.70403708005059 152.7040370800506,112.7040370800506 32.70403708005059,112.7040370800506" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="92.704037" y="132.704037" font-size="1.0rem" font-weight="100" text-anchor="middle" >120</text>
  <text x="172.704037" y="67.704037" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,172.704037,67.704037)">90</text>
  <text x="11.352019" y="121.352019" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.352019,121.352019)">12</text>
</svg>
</td>
</tr>
</table></pre></div></li><li class='xr-section-item'><input id='section-e428b890-da49-4971-bfbe-bf3255d20abd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e428b890-da49-4971-bfbe-bf3255d20abd' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2010-01-15 12:00:00 ... 2010-12-15 12:00:00</div><input id='attrs-912986f8-c21c-48ca-b644-220e7ef582dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-912986f8-c21c-48ca-b644-220e7ef582dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e889c07-afe9-481d-8673-1e7b372c8f65' class='xr-var-data-in' type='checkbox'><label for='data-5e889c07-afe9-481d-8673-1e7b372c8f65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd></dl></div><pre class='xr-var-data'>array([cftime.DatetimeJulian(2010, 1, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 2, 14, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 3, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 4, 15, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 5, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 6, 15, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 7, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 8, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 9, 15, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 10, 15, 12, 0, 0, 0),
       cftime.DatetimeJulian(2010, 11, 15, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 12, 15, 12, 0, 0, 0)], dtype=object)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-e25cf56a-2a8c-4c88-ad5a-5963d6859fd4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e25cf56a-2a8c-4c88-ad5a-5963d6859fd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41a8bf19-c75d-4e20-b90d-b2777c54a4d8' class='xr-var-data-in' type='checkbox'><label for='data-41a8bf19-c75d-4e20-b90d-b2777c54a4d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Center coordinates for latitudes</dd><dt><span>units :</span></dt><dd>degrees</dd></dl></div><pre class='xr-var-data'>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-181.5 -178.5 ... 172.5 175.5</div><input id='attrs-c1ed44d9-14c7-4454-9a36-7e2b62aa305d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c1ed44d9-14c7-4454-9a36-7e2b62aa305d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-01d2bff6-7bca-4d89-919b-540905bd0139' class='xr-var-data-in' type='checkbox'><label for='data-01d2bff6-7bca-4d89-919b-540905bd0139' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Center coordinates for longitudes</dd><dt><span>units :</span></dt><dd>degrees</dd></dl></div><pre class='xr-var-data'>array([-181.5, -178.5, -175.5, -172.5, -169.5, -166.5, -163.5, -160.5, -157.5,
       -154.5, -151.5, -148.5, -145.5, -142.5, -139.5, -136.5, -133.5, -130.5,
       -127.5, -124.5, -121.5, -118.5, -115.5, -112.5, -109.5, -106.5, -103.5,
       -100.5,  -97.5,  -94.5,  -91.5,  -88.5,  -85.5,  -82.5,  -79.5,  -76.5,
        -73.5,  -70.5,  -67.5,  -64.5,  -61.5,  -58.5,  -55.5,  -52.5,  -49.5,
        -46.5,  -43.5,  -40.5,  -37.5,  -34.5,  -31.5,  -28.5,  -25.5,  -22.5,
        -19.5,  -16.5,  -13.5,  -10.5,   -7.5,   -4.5,   -1.5,    1.5,    4.5,
          7.5,   10.5,   13.5,   16.5,   19.5,   22.5,   25.5,   28.5,   31.5,
         34.5,   37.5,   40.5,   43.5,   46.5,   49.5,   52.5,   55.5,   58.5,
         61.5,   64.5,   67.5,   70.5,   73.5,   76.5,   79.5,   82.5,   85.5,
         88.5,   91.5,   94.5,   97.5,  100.5,  103.5,  106.5,  109.5,  112.5,
        115.5,  118.5,  121.5,  124.5,  127.5,  130.5,  133.5,  136.5,  139.5,
        142.5,  145.5,  148.5,  151.5,  154.5,  157.5,  160.5,  163.5,  166.5,
        169.5,  172.5,  175.5])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-1dad0aab-e938-4c12-9f9e-0b318c2f1887' class='xr-section-summary-in' type='checkbox'  ><label for='section-1dad0aab-e938-4c12-9f9e-0b318c2f1887' class='xr-section-summary' >Attributes: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>atmosphere_optical_thickness_due_to_ambient_aerosol</dd><dt><span>long_name :</span></dt><dd>Ambient Aerosol Optical Thickness at 550 nm</dd><dt><span>institution :</span></dt><dd>Royal Netherlands Meteorological Institute, De Bilt, The Netherlands</dd><dt><span>institute_id :</span></dt><dd>KNMI</dd><dt><span>source :</span></dt><dd>TM5-mp: CTM ERA-Interim 3x2 34L</dd><dt><span>model_id :</span></dt><dd>TM5</dd><dt><span>references :</span></dt><dd>Van Noije, T.P.C., et al. (Geosci. Model Dev., 7, 2435-2475, 2014); Van Noije, T.P.C., et al. (manuscript in preparation)</dd><dt><span>experiment_id :</span></dt><dd>AP3-CTRL2016</dd><dt><span>project_id :</span></dt><dd>AeroCom Phase 3</dd><dt><span>title :</span></dt><dd>TM5 model output prepared for AeroCom Phase 3</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>contact :</span></dt><dd>Twan van Noije (noije@knmi.nl)</dd><dt><span>from_files :</span></dt><dd>[&#x27;/home/jonasg/MyPyaerocom/testdata-minimal/modeldata/TM5-met2010_CTRL-TEST/renamed/aerocom3_TM5_AP3-CTRL2016_od550aer_Column_2010_monthly.nc&#x27;]</dd><dt><span>data_id :</span></dt><dd>TM5-met2010_CTRL-TEST</dd><dt><span>var_name_read :</span></dt><dd>n/d</dd><dt><span>ts_type :</span></dt><dd>monthly</dd><dt><span>regridded :</span></dt><dd>False</dd><dt><span>outliers_removed :</span></dt><dd>False</dd><dt><span>computed :</span></dt><dd>False</dd><dt><span>concatenated :</span></dt><dd>False</dd><dt><span>meteo :</span></dt><dd></dd><dt><span>experiment :</span></dt><dd>AP3</dd><dt><span>perturbation :</span></dt><dd>CTRL2016</dd><dt><span>cell_methods :</span></dt><dd>longitude: latitude: point time: mean</dd></dl></div></li></ul></div></div></div>
</div>
<p>Simply print the object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">od550aer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyaerocom.GriddedData: TM5-met2010_CTRL-TEST
Grid data: atmosphere_optical_thickness_due_to_ambient_aerosol / (1) (time: 365; latitude: 11; longitude: 11)
     Dimension coordinates:
          time                                                 x              -              -
          latitude                                             -              x              -
          longitude                                            -              -              x
     Attributes:
          Conventions: CF-1.6
          NCO: 4.7.2
          computed: False
          concatenated: False
          contact: Twan van Noije (noije@knmi.nl)
          data_id: TM5-met2010_CTRL-TEST
          experiment: AP3
          experiment_id: AP3-CTRL2019
          from_files: [&#39;/home/jonasg/MyPyaerocom/testdata-minimal/modeldata/TM5-met2010_CTRL...
          history: Wed Jul  8 10:31:53 2020: ncks -d lat,20,30 -d lon,20,30 raw/aerocom3_TM5-met2010_AP3-CTRL2019_od550aer_Column_2010_daily.nc...
          institute_id: KNMI
          institution: Royal Netherlands Meteorological Institute, De Bilt, The Netherlands
          meteo: met2010
          model_id: TM5
          outliers_removed: False
          perturbation: CTRL2019
          project_id: AeroCom Phase 3
          reader: None
          references: Van Noije, T.P.C., et al. (Geosci. Model Dev., 7, 2435-2475, 2014); Bergman,...
          region: None
          regridded: False
          source: TM5-mp, r1058: CTM ERA-Interim 3x2 34L
          title: TM5 model output prepared for AeroCom Phase 3
          ts_type: daily
          var_name_read: n/d
     Cell methods:
          point: longitude, latitude
          mean: time
</pre></div></div>
</div>
<p>Dimension coordinates can be simply accessed either using <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">.</span></code> operator, e.g.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DimCoord(array([-49., -47., -45., -43., -41., -39., -37., -35., -33., -31., -29.]), bounds=array([[-50., -48.],
       [-48., -46.],
       [-46., -44.],
       [-44., -42.],
       [-42., -40.],
       [-40., -38.],
       [-38., -36.],
       [-36., -34.],
       [-34., -32.],
       [-32., -30.],
       [-30., -28.]]), standard_name=&#39;latitude&#39;, units=Unit(&#39;degrees&#39;), long_name=&#39;Center coordinates for latitudes&#39;, var_name=&#39;lat&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">longitude</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DimCoord(array([61.5, 64.5, 67.5, 70.5, 73.5, 76.5, 79.5, 82.5, 85.5, 88.5, 91.5]), bounds=array([[60., 63.],
       [63., 66.],
       [66., 69.],
       [69., 72.],
       [72., 75.],
       [75., 78.],
       [78., 81.],
       [81., 84.],
       [84., 87.],
       [87., 90.],
       [90., 93.]]), standard_name=&#39;longitude&#39;, units=Unit(&#39;degrees&#39;), long_name=&#39;Center coordinates for longitudes&#39;, var_name=&#39;lon&#39;)
</pre></div></div>
</div>
<p>They are instances of <code class="docutils literal notranslate"><span class="pre">iris.coords.DimCoords</span></code>, as defined in the underlying <code class="docutils literal notranslate"><span class="pre">Cube</span></code> instance used in the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object.</p>
</div>
<div class="section" id="Time-stamps">
<h2>Time stamps<a class="headerlink" href="#Time-stamps" title="Permalink to this headline">¶</a></h2>
<p>Time stamps are represented as numerical values with respect to a reference date and frequency, according to the CF conventions. They can be accessed via the <code class="docutils literal notranslate"><span class="pre">time</span></code> attribute of the data class (if the data contains a time dimension).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DimCoord(array([58454.5, 58484. , 58513.5, 58544. , 58574.5, 58605. , 58635.5,
       58666.5, 58697. , 58727.5, 58758. , 58788.5]), standard_name=&#39;time&#39;, units=Unit(&#39;days since 1850-01-01 00:00&#39;, calendar=&#39;julian&#39;), long_name=&#39;Time&#39;, var_name=&#39;time&#39;)
</pre></div></div>
</div>
<p>You may also want the time-stamps in the form of actual datetime-like objects. These can be computed using the <code class="docutils literal notranslate"><span class="pre">time_stamps()</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;2010-01-01T00:00:00.000000&#39;, &#39;2010-01-02T00:00:00.000000&#39;,
       &#39;2010-01-03T00:00:00.000000&#39;], dtype=&#39;datetime64[us]&#39;)
</pre></div></div>
</div>
<p>As introduced above, maps of individual time stamps can be plotted using the quickplot_map method. Above we used the default call, which chooses the first available timestamp. You may also specify which date you are interested in:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2010-10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_41_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_41_0.png" />
</div>
</div>
<p>If you want more control on the input parameters of the map plotting function (e.g. color-binning, lower, upper limit, colorbar, etc.), you may use the underlying plot method (that is also used in <code class="docutils literal notranslate"><span class="pre">GriddedData.quickplot_map</span></code>, which is available at <code class="docutils literal notranslate"><span class="pre">`pya.plot.mapping.plot_griddeddata_on_map</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.plot.mapping.plot_griddeddata_on_map">https://pyaerocom.met.no/api.html#pyaerocom.plot.mapping.plot_griddeddata_on_map</a>&gt;`__, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">plot_griddeddata_on_map</span><span class="p">(</span><span class="n">od550aer_tm5</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_43_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_43_0.png" />
</div>
</div>
<p>Regional filtering can be performed using the <a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.filter">Filter</a> class.</p>
</div>
<div class="section" id="Rectangular-regions">
<h2>Rectangular regions<a class="headerlink" href="#Rectangular-regions" title="Permalink to this headline">¶</a></h2>
<p>An overview of rectangular AeroCom default regions can be accessed via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OLD_AEROCOM_REGIONS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;WORLD&#39;, &#39;ASIA&#39;, &#39;AUSTRALIA&#39;, &#39;CHINA&#39;, &#39;EUROPE&#39;, &#39;INDIA&#39;, &#39;NAFRICA&#39;, &#39;SAFRICA&#39;, &#39;SAMERICA&#39;, &#39;NAMERICA&#39;]
</pre></div></div>
</div>
<p>Let’s choose north Africa as an example. Create instance of Filter class:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;NAFRICA&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can print its <code class="docutils literal notranslate"><span class="pre">region</span></code> attribute to see the edges:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyaeorocom Region
Name: NAFRICA
Longitude range: [-17, 50]
Latitude range: [0, 40]
Longitude range (plots): [-17, 50]
Latitude range (plots): [0, 40]
</pre></div></div>
</div>
<p>Now apply to the model data object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_nafrica</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">od550aer_tm5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Compare shapes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_nafrica</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyaerocom.GriddedData
Grid data: &lt;iris &#39;Cube&#39; of atmosphere_optical_thickness_due_to_ambient_aerosol / (1) (time: 12; latitude: 22; longitude: 23)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyaerocom.GriddedData
Grid data: &lt;iris &#39;Cube&#39; of atmosphere_optical_thickness_due_to_ambient_aerosol / (1) (time: 12; latitude: 90; longitude: 120)&gt;
</pre></div></div>
</div>
<p>As you can see, the filtered object is reduced in the longitude and latitude dimension. Let’s have a look:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;March 2010&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_56_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_56_0.png" />
</div>
</div>
</div>
<div class="section" id="Binary-region-masks">
<h2>Binary region masks<a class="headerlink" href="#Binary-region-masks" title="Permalink to this headline">¶</a></h2>
<p>Available <a class="reference external" href="http://www.htap.org/">HTAP</a> binary filter masks can be accessed via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">HTAP_REGIONS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;PAN&#39;, &#39;EAS&#39;, &#39;NAF&#39;, &#39;MDE&#39;, &#39;LAND&#39;, &#39;SAS&#39;, &#39;SPO&#39;, &#39;OCN&#39;, &#39;SEA&#39;, &#39;RBU&#39;, &#39;EEUROPE&#39;, &#39;NAM&#39;, &#39;WEUROPE&#39;, &#39;SAF&#39;, &#39;USA&#39;, &#39;SAM&#39;, &#39;EUR&#39;, &#39;NPO&#39;, &#39;MCA&#39;]
</pre></div></div>
</div>
<p>And they are handled in the same way as the rectangular regions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;OCN&#39;</span><span class="p">)(</span><span class="n">od550aer_tm5</span><span class="p">)</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Failed to compute / add area weighted mean. Reason: ValueError(&#39;Format specifier missing precision&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_60_1.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_60_1.png" />
</div>
</div>
<p>As you can see the provided HTAP region masks are only valid within 60<span class="math notranslate nohighlight">\(^\circ\)</span>S to 60<span class="math notranslate nohighlight">\(^\circ\)</span>N.</p>
</div>
<div class="section" id="Filtering-of-time">
<h2>Filtering of time<a class="headerlink" href="#Filtering-of-time" title="Permalink to this headline">¶</a></h2>
<p>Filtering of time is not included in the Filter class (which only allows for regional filtering) but can be easily performed from the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object directly. If you know the indices of the time stamps you want to crop, you can simply use numpy indexing syntax (remember that we have a 3D array containing time, latitude and lonfgitude).</p>
<p>Let’s say we are interested in the (northern hemispheric) summer months of June to September.</p>
<p>Since the time dimension corresponds the first index in the 3D data (time, lat, lon), and since we know, that we have monthly 2010 data (see above), we may use:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_summer</span> <span class="o">=</span> <span class="n">od550aer_tm5</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">od550aer_summer</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;2010-06-15T00:00:00.000000&#39;, &#39;2010-07-15T12:00:00.000000&#39;,
       &#39;2010-08-15T12:00:00.000000&#39;], dtype=&#39;datetime64[us]&#39;)
</pre></div></div>
</div>
<p>However, this methodology might not always be handy (imagine you have a 10 year dataset of <code class="docutils literal notranslate"><span class="pre">3hourly</span></code> sampled data and want to extract three months in the 6th year …). In that case, you can perform the cropping using the actual timestamps:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;6-2010&#39;</span><span class="p">,</span> <span class="s1">&#39;9-2010&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;2010-06-15T00:00:00.000000&#39;, &#39;2010-07-15T12:00:00.000000&#39;,
       &#39;2010-08-15T12:00:00.000000&#39;], dtype=&#39;datetime64[us]&#39;)
</pre></div></div>
</div>
</div>
<div class="section" id="Data-selection-over-multiple-dimensions">
<h2>Data selection over multiple dimensions<a class="headerlink" href="#Data-selection-over-multiple-dimensions" title="Permalink to this headline">¶</a></h2>
<p>Inspired by the <a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.sel.html">xarray.DataArray.sel</a> method, a similar method was implemented in <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;April 2010&#39;</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">179</span><span class="p">),</span> <span class="n">latitude</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_68_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_68_0.png" />
</div>
</div>
<p><strong>NOTE</strong>: Before release of version 0.10.0, there was a <a class="reference external" href="https://github.com/metno/pyaerocom/issues/225">bug</a> that led to a crash if a time range (i.e. <code class="docutils literal notranslate"><span class="pre">time=(start,</span> <span class="pre">stop)</span></code>) was passed into the <code class="docutils literal notranslate"><span class="pre">sel</span></code> method.</p>
<p>You may regrid <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> using the <code class="docutils literal notranslate"><span class="pre">regrid</span></code> method (for regional regridding) or the <code class="docutils literal notranslate"><span class="pre">resample_time</span></code> method (for temporal resmpling). Like already done above, the calls may be combined, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lowres</span> <span class="o">=</span> <span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">lat_res_deg</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lon_res_deg</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">resample_time</span><span class="p">(</span><span class="s1">&#39;yearly&#39;</span><span class="p">)</span>
<span class="n">lowres</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyaerocom.GriddedData
Grid data: &lt;iris &#39;Cube&#39; of od550aer / (1) (time: 1; latitude: 18; longitude: 18)&gt;
</pre></div></div>
</div>
<p>As you can see, the time dimension only has one entry, as expected, as the data only contains 2010 timestamps and we computed a yearly average, lat and lon dimensions are also reduced, accordingly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lowres</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_73_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_73_0.png" />
</div>
</div>
</div>
<div class="section" id="Regional-averaging">
<h2>Regional averaging<a class="headerlink" href="#Regional-averaging" title="Permalink to this headline">¶</a></h2>
<p>The actual cell sizes of latitude and longitude coordinates vary, dependent on where you are, that is, they are largest close to the equator, and smallest near the poles. When computing a regional average, this needs to be considered (i.e. values need to be weighted by their actual cell size). This is <em>area weighted regridding</em> is implemented in the <code class="docutils literal notranslate"><span class="pre">iris</span></code> library and is used by default in <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>, for instance, when calling:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.11864813532841474
</pre></div></div>
</div>
<p>You may specify if you do not want to use area weighting:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">areaweighted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.09825691
</pre></div></div>
</div>
<p>Makes quite a difference, doesn’t it?</p>
<p>Time-series at individual coordinates can be extracted from a <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ts_data</span> <span class="o">=</span> <span class="n">od550aer_tm5</span><span class="o">.</span><span class="n">to_time_series</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ts_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[StationData([(&#39;dtime&#39;, []),
              (&#39;var_info&#39;, BrowseDict([(&#39;od550aer&#39;, {&#39;units&#39;: Unit(&#39;1&#39;)})])),
              (&#39;station_coords&#39;,
               {&#39;latitude&#39;: None, &#39;longitude&#39;: None, &#39;altitude&#39;: None}),
              (&#39;data_err&#39;, BrowseDict()),
              (&#39;overlap&#39;, BrowseDict()),
              (&#39;numobs&#39;, BrowseDict()),
              (&#39;data_flagged&#39;, BrowseDict()),
              (&#39;filename&#39;, None),
              (&#39;station_id&#39;, None),
              (&#39;station_name&#39;, None),
              (&#39;instrument_name&#39;, None),
              (&#39;PI&#39;, None),
              (&#39;country&#39;, None),
              (&#39;country_code&#39;, None),
              (&#39;ts_type&#39;, &#39;monthly&#39;),
              (&#39;latitude&#39;, 61.0),
              (&#39;longitude&#39;, 10.5),
              (&#39;altitude&#39;, nan),
              (&#39;data_id&#39;, &#39;TM5-met2010_CTRL-TEST&#39;),
              (&#39;dataset_name&#39;, None),
              (&#39;data_product&#39;, None),
              (&#39;data_version&#39;, None),
              (&#39;data_level&#39;, None),
              (&#39;revision_date&#39;, None),
              (&#39;website&#39;, None),
              (&#39;ts_type_src&#39;, None),
              (&#39;stat_merge_pref_attr&#39;, None),
              (&#39;od550aer&#39;,
               2010-01-15 12:00:00    0.049607
               2010-02-14 00:00:00    0.061162
               2010-03-15 12:00:00    0.069986
               2010-04-15 00:00:00    0.097556
               2010-05-15 12:00:00    0.103770
               2010-06-15 00:00:00    0.107482
               2010-07-15 12:00:00    0.146354
               2010-08-15 12:00:00    0.145518
               2010-09-15 00:00:00    0.078066
               2010-10-15 12:00:00    0.077722
               2010-11-15 00:00:00    0.037447
               2010-12-15 12:00:00    0.039024
               dtype: float32)])]
</pre></div></div>
</div>
<p>As you can see from the output, the return value of this method is a list, that contains <em>one</em> <code class="docutils literal notranslate"><span class="pre">pyaerocom.StationData</span></code> object. The reason why this method returns a list is because it is usually called with many input coordinates (e.g. all site locations of an observation network), and thus, returns a list of <code class="docutils literal notranslate"><span class="pre">StationData</span></code> objects, one for each input coordinate.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object is basically a dictionary-like object with some extra functionality.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">station</span> <span class="o">=</span> <span class="n">ts_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The actual time-series is a <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> object and can be accessed through the variable name (remember, <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> instances are single variable).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2010-01-15 12:00:00    0.049607
2010-02-14 00:00:00    0.061162
2010-03-15 12:00:00    0.069986
2010-04-15 00:00:00    0.097556
2010-05-15 12:00:00    0.103770
2010-06-15 00:00:00    0.107482
2010-07-15 12:00:00    0.146354
2010-08-15 12:00:00    0.145518
2010-09-15 00:00:00    0.078066
2010-10-15 12:00:00    0.077722
2010-11-15 00:00:00    0.037447
2010-12-15 12:00:00    0.039024
dtype: float32
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TM5 AOD Oslo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD [550 nm]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_86_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_86_0.png" />
</div>
</div>
<p>This is as much as there is to say for now about <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> and <code class="docutils literal notranslate"><span class="pre">StationData</span></code> for now. Let’s have a little closer look at observations. After all, the main purpose of the AeroCom initiative is to compare models with observations. As we shall see below, the just introduced <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object will play a key role when bringing <em>gridded</em> model data (<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>) together with <em>ungridded</em> observational data, such as measurements of a certain variable at a given site location.</p>
<p>In the following section the reading of ungridded data is illustrated based on the example of AERONET version 3 (level 2) data.</p>
<div class="section" id="Observational-data:-Reading-of-and-working-with-ungridded-data">
<h3>Observational data: Reading of and working with ungridded data<a class="headerlink" href="#Observational-data:-Reading-of-and-working-with-ungridded-data" title="Permalink to this headline">¶</a></h3>
<p>This section provides brief introductions into the following pyaerocom classes and architectures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">`pya.io.ReadUngridded</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.io.readungridded.ReadUngridded">https://pyaerocom.met.no/api.html#pyaerocom.io.readungridded.ReadUngridded</a>&gt;`__</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`pya.UngriddedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.ungriddeddata.UngriddedData">https://pyaerocom.met.no/api.html#pyaerocom.ungriddeddata.UngriddedData</a>&gt;`__</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`pya.StationData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.stationdata.StationData">https://pyaerocom.met.no/api.html#pyaerocom.stationdata.StationData</a>&gt;`__</p></li>
</ul>
<div class="section" id="Primer-on-observational-data">
<h4>Primer on observational data<a class="headerlink" href="#Primer-on-observational-data" title="Permalink to this headline">¶</a></h4>
<p>Other than model data, which can be provided as a gridded object over a certain domain (e.g. latitude, longitude, time) and in that, can be considered <strong>fully sampled</strong>, observational data is usually <strong>sparsely</strong> sampled in space and time.</p>
<p>That is, consider a network of observations of a certain variable (e.g. od550aer, or AOD), with many different site locations around the globe. Each of these sites is measuring the variable at that exact location, and the whole network of sites makes a point cloud of site locations in the latitude, longitude domain. In addition, since these are real world measurements, the temporal sampling itself between the different sites is not synchronised, that is, each site is measuring independently of
any other site.</p>
<p>For instance, the <a class="reference external" href="https://aeronet.gsfc.nasa.gov/">AERONET</a> network is a global network of sun photometer measurements, that can measure the AOD at several wavelengths based on measurements of the solar irradiance. Thus, at the least, these measurements require 2 things:</p>
<ol class="arabic simple">
<li><p>Daylight</p></li>
<li><p>A clear sky</p></li>
</ol>
<p>Thus, it is needless to say, that a site in Antarctica cannot measure at the same time as a site in Ny-Ålesund (actually, that is also not strictly true, as AERONET now also provides AOD measurements based on the lunar irradiance, but I hope you got the point anyways).</p>
<p>This should illustrate, that it is more difficult to define a <em>harmonised</em> and yet, flexible data format for such observational databases. In pyaerocom, the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> object is designed for such point cloud data and typically holds the data belonging to a whole observation network, that is:</p>
<p><strong>The ``UngriddedData`` object can be considered a point-cloud-like dataobject that holds individual time-series from many locations around the globe and the associated metadata for each site and measurement</strong></p>
<p>Moreover, since observational data typically comes from many different observation networks, the formats in which these data are stored typically vary from network to network, which makes it harder to read the data, compared to model data which typically comes as NetCDF file and these days, most often follow some metadata conventions such as the <a class="reference external" href="https://cfconventions.org/">CF conventions</a>.</p>
<p>Data from the AERONET network (that is introduced in the following), for instance, is provided in the form of column seperated text files per measurement station, where columns correspond to different variables and data rows to individual time stamps.</p>
<p>As a result, custom reading routines for individual observation networks need to be implemented, and pyaerocom provides reading support for many commonly used observational databases such as <a class="reference external" href="https://aeronet.gsfc.nasa.gov/">AERONET</a>, or the <a class="reference external" href="http://ebas.nilu.no/">EBAS</a> or <a class="reference external" href="https://earlinet.org">EARLINET</a> data.</p>
<p>The basic workflow for reading of ungridded data, such as Aeronet data, is very similar to the reading of gridded data (comprising a reading class that handles a query and returns a data class, here <a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.ungriddeddata">UngriddedData</a>. However, under the hood, the implementation is a little more complicated, as there are reading classes for each supported network, as illustrated in the following flowchart:</p>
<p><img alt="Flowchart ungridded reading" src="../_images/pyaerocom_ungridded_io_flowchart1.png" /></p>
<p>The actual classes handling the reading of data (for a given dataset) are indicated in blue. The orange <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class is a factory class, that knows about the blue reading classes via a unique ID (similar to the gridded reading). Thus, as indicated, as a user, you do not need to know which exact reading class you need, you just need the ID and <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> will know which (blue) reader to use. To summarise, what you need for reading an ungridded dataset is:</p>
<ol class="arabic simple">
<li><p>A path where the actual datafiles are located</p></li>
<li><p>An unique ID, that links that path with a name</p></li>
<li><p>A reader that can read the class</p></li>
</ol>
<p>The first 2 points are available via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OBSLOCS_UNGRIDDED</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
OrderedDict([(&#39;AeronetSunV3L2Subset.daily&#39;,
              &#39;/home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed&#39;),
             (&#39;AeronetSDAV3L2Subset.daily&#39;,
              &#39;/home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSDAV3Lev2.daily/renamed&#39;),
             (&#39;AeronetInvV3L2Subset.daily&#39;,
              &#39;/home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetInvV3Lev2.daily/renamed&#39;),
             (&#39;EBASSubset&#39;,
              &#39;/home/jonasg/MyPyaerocom/testdata-minimal/obsdata/EBASMultiColumn&#39;)])
</pre></div></div>
</div>
<p>And the reader classes that are supposed to be used for each of these IDs is provided in the <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class header:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="o">.</span><span class="n">SUPPORTED_READERS</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[pyaerocom.io.read_aeronet_invv3.ReadAeronetInvV3,
 pyaerocom.io.read_aeronet_invv2.ReadAeronetInvV2,
 pyaerocom.io.read_aeronet_sdav2.ReadAeronetSdaV2,
 pyaerocom.io.read_aeronet_sdav3.ReadAeronetSdaV3,
 pyaerocom.io.read_aeronet_sunv2.ReadAeronetSunV2,
 pyaerocom.io.read_aeronet_sunv3.ReadAeronetSunV3,
 pyaerocom.io.read_earlinet.ReadEarlinet,
 pyaerocom.io.read_ebas.ReadEbas,
 pyaerocom.io.read_gaw.ReadGAW,
 pyaerocom.io.read_aasetal.ReadAasEtal,
 pyaerocom.io.read_ghost.ReadGhost]
</pre></div></div>
</div>
<p>The link between ID (keys of <code class="docutils literal notranslate"><span class="pre">const.OBSLOCS_UNGRIDDED</span></code>) and reader is available in the actual readers themselves, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_aeronet_sunv3</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span><span class="o">.</span><span class="n">SUPPORTED_DATASETS</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;AeronetSunV3Lev1.5.daily&#39;,
 &#39;AeronetSunV3Lev1.5.AP&#39;,
 &#39;AeronetSunV3Lev2.daily&#39;,
 &#39;AeronetSunV3Lev2.AP&#39;,
 &#39;AeronetSunV3L2Subset.daily&#39;]
</pre></div></div>
</div>
<p>But these are details that you usually do not need to worry about. If you want to register a new observation dataset, you need the 3 points specified above and can add it via:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aeronet_sun_datadir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OUTPUTDIR</span><span class="si">}</span><span class="s1">/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed&#39;</span>
<span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">add_ungridded_obs</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;Bla&#39;</span><span class="p">,</span>
                            <span class="n">data_dir</span><span class="o">=</span><span class="n">aeronet_sun_datadir</span><span class="p">,</span>
                            <span class="n">reader</span><span class="o">=</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_aeronet_sunv3</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, we basically have 2 names for the same dataset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_aeronet_sunv3</span><span class="o">.</span><span class="n">ReadAeronetSunV3</span><span class="o">.</span><span class="n">SUPPORTED_DATASETS</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;AeronetSunV3Lev1.5.daily&#39;,
 &#39;AeronetSunV3Lev1.5.AP&#39;,
 &#39;AeronetSunV3Lev2.daily&#39;,
 &#39;AeronetSunV3Lev2.AP&#39;,
 &#39;AeronetSunV3L2Subset.daily&#39;,
 &#39;Bla&#39;]
</pre></div></div>
</div>
<p>That is, the data under the above directory is now accessible via 2 IDs: <code class="docutils literal notranslate"><span class="pre">Bla</span></code> and <code class="docutils literal notranslate"><span class="pre">AeronetSunV3L2Subset.daily</span></code>.</p>
<p>Before continuing with the reading of observational data, some things need to be said related to the caching of <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> objects.</p>
</div>
<div class="section" id="Caching-of-UngriddedData">
<h4>Caching of UngriddedData<a class="headerlink" href="#Caching-of-UngriddedData" title="Permalink to this headline">¶</a></h4>
<p>Reading of ungridded data is often rather time-consuming. Therefore, pyaerocom uses a caching strategy that stores loaded instances of the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class as pickle files in a cache directory (illustrated in the flowchart shown above). The loaction of the cache directory can be accessed via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHEDIR</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/home/jonasg/MyPyaerocom/_cache/jonasg&#39;
</pre></div></div>
</div>
<p>You may change this directory if required.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="sa">f</span><span class="s1">&#39;Caching is active? </span><span class="si">{</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;Caching is active? True&#39;
</pre></div></div>
</div>
<div class="section" id="Deactivate-/-Activate-caching">
<h5>Deactivate / Activate caching<a class="headerlink" href="#Deactivate-/-Activate-caching" title="Permalink to this headline">¶</a></h5>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<p><strong>Note</strong>: if caching is active, make sure you have enough disk quota or change location where the cache files are stored.</p>
</div>
</div>
<div class="section" id="Read-Aeronet-Sun-v3-level-2-data">
<h4>Read Aeronet Sun v3 level 2 data<a class="headerlink" href="#Read-Aeronet-Sun-v3-level-2-data" title="Permalink to this headline">¶</a></h4>
<p>As illustrated in the flowchart above, ungridded observation data can be imported using the <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class. Like for the model data, observation datasets can be searched as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;Aeronet*&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Dataset name: AeronetSunV3L2Subset.daily
Data directory: /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed
Supported variables: [&#39;od340aer&#39;, &#39;od440aer&#39;, &#39;od500aer&#39;, &#39;od870aer&#39;, &#39;ang4487aer&#39;, &#39;ang44&amp;87aer&#39;, &#39;od550aer&#39;]
Last revision: n/d

Dataset name: AeronetSDAV3L2Subset.daily
Data directory: /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSDAV3Lev2.daily/renamed
Supported variables: [&#39;od500gt1aer&#39;, &#39;od500lt1aer&#39;, &#39;od500aer&#39;, &#39;ang4487aer&#39;, &#39;od550aer&#39;, &#39;od550gt1aer&#39;, &#39;od550lt1aer&#39;]
Last revision: n/d

Dataset name: AeronetInvV3L2Subset.daily
Data directory: /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetInvV3Lev2.daily/renamed
Supported variables: [&#39;abs440aer&#39;, &#39;angabs4487aer&#39;, &#39;od440aer&#39;, &#39;ang4487aer&#39;, &#39;abs550aer&#39;, &#39;od550aer&#39;]
Last revision: n/d
</pre></div></div>
</div>
<p>The search routine found 3 matches for the 3 different AERONET data products: Sun, SDA, and Inv (inversion). You may read more about the different products at the <a class="reference external" href="https://aeronet.gsfc.nasa.gov/">AERONET website</a>.</p>
<p>Let’s continue with the “Sun” product (AERONET Direct Sun algorithm). As you can see from the output above, this dataset contains daily averages, which is convenient to use for model evaluation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obs_id</span> <span class="o">=</span> <span class="s1">&#39;AeronetSunV3L2Subset.daily&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">obs_id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_reader</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Dataset name: AeronetSunV3L2Subset.daily
Data directory: /home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed
Supported variables: [&#39;od340aer&#39;, &#39;od440aer&#39;, &#39;od500aer&#39;, &#39;od870aer&#39;, &#39;ang4487aer&#39;, &#39;ang44&amp;87aer&#39;, &#39;od550aer&#39;]
Last revision: n/d
</pre></div></div>
</div>
<p>Let’s read the data (you can read a single or multiple variables at the same time). For now, we only read the AOD at 550 nm:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_aeronet</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">od550aer_aeronet</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
UngriddedData &lt;networks: [&#39;AeronetSunV3L2Subset.daily&#39;]; vars: [&#39;od550aer&#39;]; instruments: [&#39;sun_photometer&#39;];No. of metadata units: 22
</pre></div></div>
</div>
<p>As you can see, the data object is of type <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code>. Other than <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>, <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> can hold an arbitrary number of variables, and even networks. The number of metadata units indicates the number of data files that have been read.</p>
</div>
<div class="section" id="Plot-all-station-coordinates">
<h4>Plot all station coordinates<a class="headerlink" href="#Plot-all-station-coordinates" title="Permalink to this headline">¶</a></h4>
<p>To get an overview, you can plot all site coordinates contained in the dataset. You can also plot multiple times into the same map with different input criteria. For instance, below we first plot all site locations available in the data (in red), and then, on top of it, in green, we plot sites that contain data in 2010.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">od550aer_aeronet</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">od550aer_aeronet</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">2011</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;cartopy.mpl.geoaxes.GeoAxes at 0x7f2251140d50&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_123_1.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_123_1.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="Access-of-individual-stations">
<h2>Access of individual stations<a class="headerlink" href="#Access-of-individual-stations" title="Permalink to this headline">¶</a></h2>
<p>For intercomparison with model data, we are interested in time-series from individual sites. You can check out all existing site-location names via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">od550aer_aeronet</span><span class="o">.</span><span class="n">unique_station_names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;AAOT&#39;,
 &#39;ARIAKE_TOWER&#39;,
 &#39;Agoufou&#39;,
 &#39;Alta_Floresta&#39;,
 &#39;American_Samoa&#39;,
 &#39;Amsterdam_Island&#39;,
 &#39;Anmyon&#39;,
 &#39;Avignon&#39;,
 &#39;Azores&#39;,
 &#39;BORDEAUX&#39;,
 &#39;Barbados&#39;,
 &#39;Blyth_NOAH&#39;,
 &#39;La_Paz&#39;,
 &#39;Mauna_Loa&#39;,
 &#39;Tahiti&#39;,
 &#39;Taihu&#39;,
 &#39;Taipei_CWB&#39;,
 &#39;Tamanrasset_INM&#39;,
 &#39;The_Hague&#39;,
 &#39;Thessaloniki&#39;,
 &#39;Thornton_C-power&#39;,
 &#39;Trelew&#39;]
</pre></div></div>
</div>
<p>To access individual site location data as <code class="docutils literal notranslate"><span class="pre">StationData</span></code> you can simply do:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">station_data</span> <span class="o">=</span> <span class="n">od550aer_aeronet</span><span class="p">[</span><span class="s1">&#39;La_Paz&#39;</span><span class="p">]</span> <span class="c1"># this is fully equivalent with aeronet_data.to_station_data(&#39;Leipzig&#39;)</span>
<span class="n">station_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
StationData([(&#39;dtime&#39;,
              array([&#39;2006-02-18T00:00:00.000000000&#39;, &#39;2006-02-19T00:00:00.000000000&#39;,
                     &#39;2006-02-20T00:00:00.000000000&#39;, ...,
                     &#39;2019-05-24T00:00:00.000000000&#39;, &#39;2019-05-25T00:00:00.000000000&#39;,
                     &#39;2019-05-26T00:00:00.000000000&#39;], dtype=&#39;datetime64[ns]&#39;)),
             (&#39;var_info&#39;,
              BrowseDict([(&#39;od550aer&#39;,
                           OrderedDict([(&#39;units&#39;, &#39;1&#39;),
                                        (&#39;overlap&#39;, False),
                                        (&#39;ts_type&#39;, &#39;daily&#39;),
                                        (&#39;apply_constraints&#39;, False),
                                        (&#39;min_num_obs&#39;, None),
                                        (&#39;how&#39;, &#39;mean&#39;)]))])),
             (&#39;station_coords&#39;,
              {&#39;latitude&#39;: -16.538999999999998,
               &#39;longitude&#39;: -68.066467,
               &#39;altitude&#39;: 3439.0}),
             (&#39;data_err&#39;, BrowseDict()),
             (&#39;overlap&#39;, BrowseDict()),
             (&#39;numobs&#39;, BrowseDict()),
             (&#39;data_flagged&#39;, BrowseDict()),
             (&#39;filename&#39;,
              &#39;/home/jonasg/MyPyaerocom/testdata-minimal/obsdata/AeronetSunV3Lev2.daily/renamed/La_Paz.lev30&#39;),
             (&#39;station_id&#39;, None),
             (&#39;station_name&#39;, &#39;La_Paz&#39;),
             (&#39;instrument_name&#39;, &#39;sun_photometer&#39;),
             (&#39;PI&#39;, &#39;Brent_Holben&#39;),
             (&#39;country&#39;, None),
             (&#39;country_code&#39;, None),
             (&#39;ts_type&#39;, &#39;daily&#39;),
             (&#39;latitude&#39;, -16.538999999999998),
             (&#39;longitude&#39;, -68.066467),
             (&#39;altitude&#39;, 3439.0),
             (&#39;data_id&#39;, &#39;AeronetSunV3L2Subset.daily&#39;),
             (&#39;dataset_name&#39;, None),
             (&#39;data_product&#39;, None),
             (&#39;data_version&#39;, None),
             (&#39;data_level&#39;, None),
             (&#39;revision_date&#39;, None),
             (&#39;website&#39;, None),
             (&#39;ts_type_src&#39;, &#39;daily&#39;),
             (&#39;stat_merge_pref_attr&#39;, None),
             (&#39;data_revision&#39;, &#39;n/d&#39;),
             (&#39;od550aer&#39;,
              2006-02-18    0.087568
              2006-02-19         NaN
              2006-02-20         NaN
              2006-02-21         NaN
              2006-02-22    0.101807
                              ...
              2019-05-22         NaN
              2019-05-23    0.059489
              2019-05-24    0.049292
              2019-05-25    0.074172
              2019-05-26    0.060137
              Freq: D, Length: 4846, dtype: float64)])
</pre></div></div>
</div>
<p>As you can see, the returned object is of type <code class="docutils literal notranslate"><span class="pre">StationData</span></code> which has been introduced above (remember, we extracted a time series from the TM5 model for the location of Oslo).</p>
<p>As mentioned above, it can be used like a dictionary, and the variable time-series can be accessed via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">station_data</span><span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f2252de9b90&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_129_1.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_129_1.png" />
</div>
</div>
<p>You may also plot directly from the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> object (and do some more other hopefully self-explanatory things):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">station_data</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">station_data</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f2250f653d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_131_1.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_131_1.png" />
</div>
</div>
<p>Back to <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code>: You may also retrieve the <code class="docutils literal notranslate"><span class="pre">StationData</span></code> with specifying more constraints using <code class="docutils literal notranslate"><span class="pre">to_station_data</span></code> (e.g. in monthly resolution and only for the year 2010). And you can overlay different curves, by passing the axes instance returned by the plotting method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span><span class="o">=</span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;La_Paz&#39;</span><span class="p">,</span>
                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">2011</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">=</span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;La_Paz&#39;</span><span class="p">,</span>
                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;La Paz AODs 2010&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-57-2d2face4676d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> ax=aeronet_data.to_station_data(&#39;La_Paz&#39;,
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                                 start<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2010</span><span class="ansi-blue-fg">,</span> stop<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2011</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                                 freq=&#39;daily&#39;).plot_timeseries(&#39;od550aer&#39;)
<span class="ansi-green-intense-fg ansi-bold">      4</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> ax=aeronet_data.to_station_data(&#39;La_Paz&#39;,

<span class="ansi-red-fg">NameError</span>: name &#39;aeronet_data&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="You-can-also-plot-the-time-series-directly-from-UngriddedData">
<h2>You can also plot the time-series directly from <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code><a class="headerlink" href="#You-can-also-plot-the-time-series-directly-from-UngriddedData" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">plot_station_timeseries</span><span class="p">(</span><span class="s1">&#39;La_Paz&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                     <span class="n">start</span><span class="o">=</span><span class="mi">2018</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly AOD in La Paz, 2018&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="Colocation-of-model-and-obsdata">
<h3>Colocation of model and obsdata<a class="headerlink" href="#Colocation-of-model-and-obsdata" title="Permalink to this headline">¶</a></h3>
<p>Now that we have a <strong>gridded model dataset</strong> and an <strong>ungridded observation dataset</strong> loaded we can continue with colocation of both datasets. <em>Colocation</em> essentially describes the process of matching observations and model in space and time, which makes it possible to compare both and ultimately, to assess how well the model is performing.</p>
<p>As the observations are usually sparse, they define the set of locations and times to be extracted from the model (for comparison). Essentially, what needs to be done is simple:</p>
<ol class="arabic simple">
<li><p>Decide on a time interval in which you want to colocate the observations with the model data.</p></li>
<li><p>Decide on an output frequency.</p></li>
<li><p>Find all site location coordinates from the observations in the time period and extract the model values from the model dataset at these locations.</p></li>
<li><p>Match the time interval and frequency.</p></li>
</ol>
<p>pyaerocom has some methods that can do this for you and these methods return an instance of the <code class="docutils literal notranslate"><span class="pre">`ColocatedData</span></code> &lt;<a class="reference external" href="https://pyaerocom.met.no/api.html#pyaerocom.colocateddata.ColocatedData">https://pyaerocom.met.no/api.html#pyaerocom.colocateddata.ColocatedData</a>&gt;`__ object.</p>
</div>
</div>
<div class="section" id="Low-level-colocation-routine(s)">
<h2>Low-level colocation routine(s)<a class="headerlink" href="#Low-level-colocation-routine(s)" title="Permalink to this headline">¶</a></h2>
<p>Let’s colocate the TM5 model data with the AERONET AOD subset for the year 2010 and in monthly resolution. Since we already have both data objects loaded, we can go straight to the low-level colocation routine:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coldata</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">od550aer_tm5</span><span class="p">,</span>
                                                    <span class="n">od550aer_aeronet</span><span class="p">,</span>
                                                    <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                    <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                                    <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The filter-name <code class="docutils literal notranslate"><span class="pre">WORLD-noMOUNTAINS</span></code> denotes that all available AERONET sites are supposed to be used but high altitude sites (located above 1000m a.s.l). A more detailed introduction into available regions and region filters is provided in the <a class="reference external" href="https://github.com/metno/pyaerocom-tutorials/blob/master/getting_started_setup.ipynb">getting_started_setup.ipynb</a> tutorial.</p>
<p>You may create a scatter plot from these colocated monthly means, which includes relevant statistical parameters that help to assess model performance:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coldata</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">(</span><span class="n">loglog</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>Does not look too bad, you can see that this result is from 8 sites and 62 data points (monthly averages). The normalised-mean-bias (NMB) is -12.9%, which means that the model slightly underestimates AOD at these locations.</p>
<p>A more illustrative view of the model biases can be retrieved by plotting a <em>bias map</em>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">plot_nmb_map_colocateddata</span><span class="p">(</span><span class="n">coldata</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>The fact that you can barely see most of the sites is a good sign, since 0% bias is mapped to white color which is the same as the background color here. The largest bias is found in Amsterdam Island, in the southern Indian Ocean, which could be an indication that the model is simulating too little sea-salt aerosol in this very remote and clean region.</p>
</div>
<div class="section" id="Under-the-hood-…">
<h2>Under the hood …<a class="headerlink" href="#Under-the-hood-…" title="Permalink to this headline">¶</a></h2>
<p>… the <code class="docutils literal notranslate"><span class="pre">ColocatedData</span></code> object is an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coldata</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<p>As you can see, model and obs (stored in <code class="docutils literal notranslate"><span class="pre">data_source</span></code> dimension) now share the same coordinates (dimension <code class="docutils literal notranslate"><span class="pre">station_name</span></code>) and time stamps (dimension <code class="docutils literal notranslate"><span class="pre">time</span></code>). The <code class="docutils literal notranslate"><span class="pre">data_source</span></code> dimension always contains the observation data at the first index and the model data at the second:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obsdata</span> <span class="o">=</span> <span class="n">coldata</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">obsdata</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">modeldata</span> <span class="o">=</span> <span class="n">coldata</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">modeldata</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="High-level-colocation-routine">
<h2>High-level colocation routine<a class="headerlink" href="#High-level-colocation-routine" title="Permalink to this headline">¶</a></h2>
<p>If it wasn’t for the purpose of this notebook, normally, we don’t want to go through the hassle of reading the data individually before colocating. Thus, pyaerocom has a high-level interface that can do colocation straight with the observation and model IDs (under the hood, of course, it uses the same routines that have been used here). By default, this high-level interface also stores all produced <code class="docutils literal notranslate"><span class="pre">ColocatedData</span></code> objects as NetCDF files, for later analysis:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">colocator</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Colocator</span><span class="p">(</span>
    <span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">obs_id</span><span class="o">=</span><span class="n">obs_id</span><span class="p">,</span> <span class="n">obs_vars</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
    <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
    <span class="n">model_ts_type_read</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
    <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;OCN&#39;</span><span class="p">,</span> <span class="c1">#  let&#39;s try to better isolate Amsterdam Island</span>
    <span class="n">reanalyse_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_coldata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">colocator</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Colocator([(&#39;save_coldata&#39;, True),
           (&#39;_obs_cache_only&#39;, False),
           (&#39;obs_vars&#39;, [&#39;od550aer&#39;]),
           (&#39;obs_vert_type&#39;, None),
           (&#39;model_vert_type_alt&#39;, None),
           (&#39;read_opts_ungridded&#39;, None),
           (&#39;obs_ts_type_read&#39;, None),
           (&#39;model_use_vars&#39;, None),
           (&#39;model_add_vars&#39;, None),
           (&#39;model_keep_outliers&#39;, True),
           (&#39;model_to_stp&#39;, False),
           (&#39;model_id&#39;, &#39;TM5-met2010_CTRL-TEST&#39;),
           (&#39;model_name&#39;, None),
           (&#39;model_data_dir&#39;, None),
           (&#39;obs_id&#39;, &#39;AeronetSunV3L2Subset.daily&#39;),
           (&#39;obs_name&#39;, None),
           (&#39;obs_data_dir&#39;, None),
           (&#39;obs_keep_outliers&#39;, False),
           (&#39;obs_use_climatology&#39;, False),
           (&#39;obs_add_meta&#39;, []),
           (&#39;gridded_reader_id&#39;,
            {&#39;model&#39;: &#39;ReadGridded&#39;, &#39;obs&#39;: &#39;ReadGridded&#39;}),
           (&#39;start&#39;, None),
           (&#39;stop&#39;, None),
           (&#39;ts_type&#39;, &#39;monthly&#39;),
           (&#39;filter_name&#39;, &#39;OCN&#39;),
           (&#39;remove_outliers&#39;, True),
           (&#39;apply_time_resampling_constraints&#39;, None),
           (&#39;min_num_obs&#39;, None),
           (&#39;resample_how&#39;, None),
           (&#39;var_outlier_ranges&#39;, None),
           (&#39;var_ref_outlier_ranges&#39;, None),
           (&#39;harmonise_units&#39;, False),
           (&#39;vert_scheme&#39;, None),
           (&#39;regrid_res_deg&#39;, None),
           (&#39;ignore_station_names&#39;, None),
           (&#39;basedir_coldata&#39;, &#39;/home/jonasg/MyPyaerocom/colocated_data&#39;),
           (&#39;model_ts_type_read&#39;, &#39;monthly&#39;),
           (&#39;model_read_aux&#39;, None),
           (&#39;model_use_climatology&#39;, False),
           (&#39;colocate_time&#39;, False),
           (&#39;flex_ts_type_gridded&#39;, True),
           (&#39;reanalyse_existing&#39;, True),
           (&#39;raise_exceptions&#39;, False),
           (&#39;_log&#39;, None),
           (&#39;logging&#39;, True),
           (&#39;data&#39;, {}),
           (&#39;file_status&#39;, {})])
</pre></div></div>
</div>
<p>Quite a few options, a lot of them are for the even higher-level automatic web-processing tools that feed the <a class="reference external" href="https://aerocom-evaluation.met.no/main.php?project=aerocom&amp;exp=PIII-optics2019-P">Aerocom Evaluation websites</a>, so let’s not get lost in these details here.</p>
<p>The colocation can be run as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">colocator</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
PREPARING colocation of TM5-met2010_CTRL-TEST vs. AeronetSunV3L2Subset.daily
The following variable combinations will be colocated
MODEL-VAR       OBS-VAR
od550aer        od550aer
Running TM5-met2010_CTRL-TEST / AeronetSunV3L2Subset.daily (od550aer, od550aer)
Input filters {&#39;latitude&#39;: [-89.0, 89.0], &#39;longitude&#39;: [-181.5, 175.5]} result in unchanged data object
WRITE: od550aer_REF-AeronetSunV3L2Subset.daily_MOD-TM5-met2010_CTRL-TEST_20100101_20101231_monthly_OCN.nc

</pre></div></div>
</div>
<p>As you can see in the last line of the output, the colocated data object was stored as NetCDF file. The default direcory for these files can be accessed (and modified) in the <code class="docutils literal notranslate"><span class="pre">const</span></code> class:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">COLOCATEDDATADIR</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/home/jonasg/MyPyaerocom/colocated_data&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">COLOCATEDDATADIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;logfiles&#39;,
 &#39;CAM5.3-Oslo_AP3-CTRL2016-PD&#39;,
 &#39;TM5-met2010_CTRL-TEST&#39;,
 &#39;NorESM2-met2010_AP3-CTRL&#39;]
</pre></div></div>
</div>
<p>And you can see that there is a subdirecory which contains all colocated data objects that have been created for the TM5 model. The loaded colocated data object can also be accessed via:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coldata2</span> <span class="o">=</span> <span class="n">colocator</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">model_id</span><span class="p">][</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">coldata2</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_158_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_158_0.png" />
</div>
</div>
<p>That looks like we managed to get only Amsterdam Island here (1 site) and 8 months of data. The corresponding model bias suggests that TM5 is underestimating AOD at 550nm at Amsterdam Island by ca 60%.</p>
<p>As a last step for this tutorial, let’s make sure it is Amsterdam Island that we got here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">plot_nmb_map_colocateddata</span><span class="p">(</span><span class="n">coldata2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/pyaerocom-tutorials_getting_started_analysis_160_0.png" src="../_images/pyaerocom-tutorials_getting_started_analysis_160_0.png" />
</div>
</div>
<p>Looks like it! Ciao!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="obsolete/tut00_get_started.html" class="btn btn-neutral float-right" title="Getting started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started_setup.html" class="btn btn-neutral float-left" title="Checking pyaerocom installation and access to data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MET Norway

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>