

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TODO : Continue with calculating bias and plotting bias &mdash; pyaerocom  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pyaerocom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#aerocom">AeroCom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#website-and-code-documentation">Website and code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#installation-of-pyaerocom">Installation of pyaerocom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#access-to-users-database">Access to users database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html#getting-started">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyaerocom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>TODO : Continue with calculating bias and plotting bias</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/pyaerocom-tutorials/obsolete/dev/intercomparison_AasEtAl_and_2010CTRL.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="kn">from</span> <span class="nn">pyaerocom.io.readungridded</span> <span class="kn">import</span> <span class="n">ReadUngridded</span>
<span class="kn">from</span> <span class="nn">pyaerocom.io.readgridded</span> <span class="kn">import</span> <span class="n">ReadGridded</span>
<span class="kn">from</span> <span class="nn">pyaerocom.io.helpers_units</span> <span class="kn">import</span> <span class="p">(</span><span class="n">unitconv_sfc_conc_bck</span><span class="p">,</span>
                                        <span class="n">unitconv_sfc_conc</span><span class="p">,</span>
                                        <span class="n">unitconv_wet_depo_bck</span><span class="p">,</span>
                                        <span class="n">unitconv_wet_depo</span><span class="p">,</span> <span class="n">unitconv_wet_depo_from_emep</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyaerocom.plot</span> <span class="kn">import</span> <span class="n">df_to_heatmap</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Initating pyaerocom configuration
Checking database access...
Checking access to: /lustre/storeA
Access to lustre database: True
Init data paths for lustre
Expired time: 0.013 s
/home/hannas/anaconda3/lib/python3.7/site-packages/dask/config.py:168: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  data = yaml.load(f.read()) or {}
/home/hannas/anaconda3/lib/python3.7/site-packages/distributed/config.py:20: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  defaults = yaml.load(f)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_gridded_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of wetso4 / (kg m-2 s-1) (time: 12; latitude: 80; longitude: 160)&gt;,
 pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of wet deposition rate of so4 / (kg m-2 s-1) (time: 12; latitude: 96; longitude: 144)&gt;,
 pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of tendency_of_atmosphere_mass_content_of_sulfate_dry_aerosol_particles_due_to_wet_deposition / (kg m-2 s-1) (time: 12; latitude: 180; longitude: 288)&gt;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[165]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">construct_df_model_intercomparison_to_observations</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span>
                                                       <span class="n">OBS_network</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span>
                                                       <span class="n">list_model_ID</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">,</span>
                                                                        <span class="s1">&#39;CAM5-ATRAS_AP3-CTRL&#39;</span><span class="p">],</span>
                                                       <span class="n">bias</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                       <span class="n">rmse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

    <span class="n">ungridded_data</span>    <span class="o">=</span> <span class="n">ReadUngridded</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datasets_to_read</span> <span class="o">=</span> <span class="n">OBS_network</span><span class="p">,</span> <span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="n">vars_to_retrieve</span><span class="p">)</span>
    <span class="n">list_gridded_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="p">[</span><span class="n">vars_to_retrieve</span><span class="p">],</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">2010</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                         <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">list_model_ID</span> <span class="p">]</span>

    <span class="c1"># Possible to retrieve ts type of obeservation</span>
    <span class="n">list_colocate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">gridded_data</span> <span class="ow">in</span> <span class="n">list_gridded_data</span><span class="p">:</span>
        <span class="n">list_colocate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="p">,</span>
                                                                       <span class="n">ungridded_data</span><span class="p">,</span>
                                                                       <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">))</span>
    <span class="c1"># call merged : raw, bias : Bias, rmse : RMSE</span>
    <span class="k">def</span> <span class="nf">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">)</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
        <span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df2</span>

    <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span> <span class="n">coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">coloc</span> <span class="ow">in</span> <span class="n">list_colocate</span> <span class="p">]</span>
    <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">]</span>
    <span class="c1">#print(dataframes)</span>
    <span class="n">lala</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">lala</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">lala</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">lala</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[167]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">construct_df_model_intercomparison_to_observations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 80, 160). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 96, 144). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[169]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Checks for different number of columns
New version edited by hanna.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[169]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f20067a0d10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_4_2.png" src="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_4_2.png" />
</div>
</div>
<div class="section" id="TODO-:-Continue-with-calculating-bias-and-plotting-bias">
<h1>TODO : Continue with calculating bias and plotting bias<a class="headerlink" href="#TODO-:-Continue-with-calculating-bias-and-plotting-bias" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[148]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ungridded_data</span> <span class="o">=</span> <span class="n">ReadUngridded</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datasets_to_read</span> <span class="o">=</span> <span class="n">OBS_network</span><span class="p">,</span> <span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="n">vars_to_retrieve</span><span class="p">)</span>
<span class="n">list_gridded_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="p">[</span><span class="n">vars_to_retrieve</span><span class="p">],</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">2010</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                     <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">list_model_ID</span> <span class="p">]</span>

<span class="c1"># Possible to retrieve ts type of obeservation</span>
<span class="n">list_colocate</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">gridded_data</span> <span class="ow">in</span> <span class="n">list_gridded_data</span><span class="p">:</span>
    <span class="n">list_colocate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="p">,</span>
                                                                   <span class="n">ungridded_data</span><span class="p">,</span>
                                                                   <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 80, 160). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 96, 144). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[149]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># call merged : raw, bias : Bias, rmse : RMSE</span>
<span class="k">def</span> <span class="nf">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">all_stations</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_colocate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_source</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;data_source&#39; (data_source: 2)&gt;
array([&#39;GAWTADsubsetAasEtAl&#39;, &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;], dtype=&#39;&lt;U30&#39;)
Coordinates:
  * data_source  (data_source) &lt;U30 &#39;GAWTADsubsetAasEtAl&#39; &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;
    var_name     (data_source) &lt;U6 &#39;wetso4&#39; &#39;wetso4&#39;
    var_units    (data_source) &lt;U10 &#39;kg m-2 s-1&#39; &#39;kg m-2 s-1&#39;
    ts_type_src  (data_source) &lt;U7 &#39;monthly&#39; &#39;monthly&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[139]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_colocate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data_source</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[139]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;data_source&#39; (data_source: 2)&gt;
array([&#39;GAWTADsubsetAasEtAl&#39;, &#39;CAM5-ATRAS_AP3-CTRL&#39;], dtype=&#39;&lt;U19&#39;)
Coordinates:
  * data_source  (data_source) &lt;U19 &#39;GAWTADsubsetAasEtAl&#39; &#39;CAM5-ATRAS_AP3-CTRL&#39;
    var_name     (data_source) &lt;U6 &#39;wetso4&#39; &#39;wetso4&#39;
    var_units    (data_source) &lt;U10 &#39;kg m-2 s-1&#39; &#39;kg m-2 s-1&#39;
    ts_type_src  (data_source) &lt;U7 &#39;monthly&#39; &#39;monthly&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">list_colocate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>var_name</th>
      <th>var_units</th>
      <th>ts_type_src</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>altitude</th>
      <th>wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>time</th>
      <th>station_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="30" valign="top">GAWTADsubsetAasEtAl</th>
      <th rowspan="30" valign="top">2010-01-15</th>
      <th>Abington (CT15)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>41.840000</td>
      <td>-72.010100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.377200</td>
      <td>-68.260800</td>
      <td>NaN</td>
      <td>8.948091e-04</td>
    </tr>
    <tr>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>40.474900</td>
      <td>-86.992400</td>
      <td>NaN</td>
      <td>7.829580e-04</td>
    </tr>
    <tr>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.922600</td>
      <td>-74.480600</td>
      <td>NaN</td>
      <td>1.084956e-03</td>
    </tr>
    <tr>
      <th>Alamosa (CO00)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.442100</td>
      <td>-105.868000</td>
      <td>NaN</td>
      <td>2.237023e-05</td>
    </tr>
    <tr>
      <th>Algoma</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>47.033670</td>
      <td>-84.378970</td>
      <td>NaN</td>
      <td>9.954752e-04</td>
    </tr>
    <tr>
      <th>Alhambra (IL46)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>38.868900</td>
      <td>-89.621900</td>
      <td>NaN</td>
      <td>1.565916e-03</td>
    </tr>
    <tr>
      <th>Allahabad</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>25.450000</td>
      <td>81.730000</td>
      <td>NaN</td>
      <td>6.263664e-05</td>
    </tr>
    <tr>
      <th>Ann Arbor (MI52)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>42.416400</td>
      <td>-83.901900</td>
      <td>NaN</td>
      <td>4.697748e-04</td>
    </tr>
    <tr>
      <th>Arendtsville (PA00)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>39.923100</td>
      <td>-77.307800</td>
      <td>NaN</td>
      <td>2.360059e-03</td>
    </tr>
    <tr>
      <th>Ashland Wildlife Area (MO03)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>38.754000</td>
      <td>-92.199400</td>
      <td>NaN</td>
      <td>1.543546e-03</td>
    </tr>
    <tr>
      <th>Aspvreten</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>58.800000</td>
      <td>17.383300</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Assateague Island National Seashore-Woodcock (MD18)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>38.251000</td>
      <td>-75.159300</td>
      <td>NaN</td>
      <td>6.822920e-04</td>
    </tr>
    <tr>
      <th>Attwater Prairie Chicken National Wildlife Refuge (TX10)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>29.661400</td>
      <td>-96.259400</td>
      <td>NaN</td>
      <td>2.975240e-03</td>
    </tr>
    <tr>
      <th>Aurora Research Farm (NY08)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>42.733900</td>
      <td>-76.659700</td>
      <td>NaN</td>
      <td>5.928111e-04</td>
    </tr>
    <tr>
      <th>BANIZOUMBOU</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>13.517000</td>
      <td>2.630000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Babcock State Park (WV04)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.979600</td>
      <td>-80.952500</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Bandelier National Monument (NM07)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>35.778800</td>
      <td>-106.266000</td>
      <td>NaN</td>
      <td>1.901469e-04</td>
    </tr>
    <tr>
      <th>Barcarrota</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>38.475800</td>
      <td>-6.922800</td>
      <td>NaN</td>
      <td>4.474046e-04</td>
    </tr>
    <tr>
      <th>Bay D'Espoir</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>47.991670</td>
      <td>-55.814170</td>
      <td>NaN</td>
      <td>4.585897e-04</td>
    </tr>
    <tr>
      <th>Beaufort (NC06)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>34.884600</td>
      <td>-76.620700</td>
      <td>NaN</td>
      <td>2.214653e-03</td>
    </tr>
    <tr>
      <th>Beeville (TX03)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>28.466700</td>
      <td>-97.706900</td>
      <td>NaN</td>
      <td>1.677767e-03</td>
    </tr>
    <tr>
      <th>Bellville (GA20)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>32.084900</td>
      <td>-81.936700</td>
      <td>NaN</td>
      <td>2.673242e-03</td>
    </tr>
    <tr>
      <th>Bennett Bridge (NY52)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>43.528200</td>
      <td>-75.949200</td>
      <td>NaN</td>
      <td>1.756063e-03</td>
    </tr>
    <tr>
      <th>Bennington (VT01)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>42.876100</td>
      <td>-73.163300</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Big Bend National Park - K-Bar (TX04)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>29.302500</td>
      <td>-103.178100</td>
      <td>NaN</td>
      <td>4.250343e-04</td>
    </tr>
    <tr>
      <th>Big Springs Fish Hatchery (IA08)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>42.909700</td>
      <td>-91.470000</td>
      <td>NaN</td>
      <td>1.006660e-03</td>
    </tr>
    <tr>
      <th>Birkenes</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>58.383333</td>
      <td>8.250000</td>
      <td>NaN</td>
      <td>3.579237e-03</td>
    </tr>
    <tr>
      <th>Biscuit Brook (NY68)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>41.993600</td>
      <td>-74.503100</td>
      <td>NaN</td>
      <td>1.319843e-03</td>
    </tr>
    <tr>
      <th>Black Belt Research &amp; Extension Center (AL10)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>32.458300</td>
      <td>-87.242200</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="30" valign="top">CAM5-ATRAS_AP3-CTRL</th>
      <th rowspan="30" valign="top">2010-12-15</th>
      <th>Unionville (MI51)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>43.613500</td>
      <td>-83.359900</td>
      <td>NaN</td>
      <td>1.141686e-11</td>
    </tr>
    <tr>
      <th>University Forest (MO05)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>36.910800</td>
      <td>-90.318700</td>
      <td>NaN</td>
      <td>3.385257e-11</td>
    </tr>
    <tr>
      <th>Valentia Observatory</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>51.939722</td>
      <td>-10.244444</td>
      <td>NaN</td>
      <td>3.160185e-12</td>
    </tr>
    <tr>
      <th>Verna Well Field (FL41)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>27.380100</td>
      <td>-82.283100</td>
      <td>NaN</td>
      <td>2.087127e-11</td>
    </tr>
    <tr>
      <th>Vilsandi</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>58.383300</td>
      <td>21.816700</td>
      <td>NaN</td>
      <td>8.424598e-12</td>
    </tr>
    <tr>
      <th>Virolahti II</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>60.526667</td>
      <td>27.686111</td>
      <td>NaN</td>
      <td>1.002713e-11</td>
    </tr>
    <tr>
      <th>Visakhapatnam</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>17.680000</td>
      <td>83.300000</td>
      <td>NaN</td>
      <td>3.465497e-11</td>
    </tr>
    <tr>
      <th>Voyageurs National Park-Sullivan Bay (MN32)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>48.413200</td>
      <td>-92.830500</td>
      <td>NaN</td>
      <td>4.499523e-12</td>
    </tr>
    <tr>
      <th>VÃ­znar</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.233300</td>
      <td>-3.533300</td>
      <td>NaN</td>
      <td>7.858172e-12</td>
    </tr>
    <tr>
      <th>Waldhof</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>52.802222</td>
      <td>10.759444</td>
      <td>NaN</td>
      <td>3.779522e-11</td>
    </tr>
    <tr>
      <th>Walker Branch Watershed (TN00)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>35.961400</td>
      <td>-84.287200</td>
      <td>NaN</td>
      <td>2.890028e-11</td>
    </tr>
    <tr>
      <th>Warren 2WSW (AR02)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>33.605000</td>
      <td>-92.097200</td>
      <td>NaN</td>
      <td>2.751409e-11</td>
    </tr>
    <tr>
      <th>Warsaw Caves</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.463890</td>
      <td>-78.130560</td>
      <td>NaN</td>
      <td>1.028635e-11</td>
    </tr>
    <tr>
      <th>Wellston (MI53)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.224200</td>
      <td>-85.818600</td>
      <td>NaN</td>
      <td>1.345812e-11</td>
    </tr>
    <tr>
      <th>West Point (NY99)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>41.351100</td>
      <td>-74.048400</td>
      <td>NaN</td>
      <td>8.307061e-12</td>
    </tr>
    <tr>
      <th>Westerland</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>54.925556</td>
      <td>8.309722</td>
      <td>NaN</td>
      <td>1.391650e-11</td>
    </tr>
    <tr>
      <th>Whiteface Mountain (NY98)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.393300</td>
      <td>-73.859400</td>
      <td>NaN</td>
      <td>8.930879e-12</td>
    </tr>
    <tr>
      <th>Wildcat Mountain (WI98)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>43.702300</td>
      <td>-90.568500</td>
      <td>NaN</td>
      <td>1.671519e-11</td>
    </tr>
    <tr>
      <th>Wolf Creek Pass (CO91)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.468600</td>
      <td>-106.787000</td>
      <td>NaN</td>
      <td>7.115234e-12</td>
    </tr>
    <tr>
      <th>Wolf Ridge (MN99)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>47.384100</td>
      <td>-91.206700</td>
      <td>NaN</td>
      <td>4.740397e-12</td>
    </tr>
    <tr>
      <th>Woodworth (ND11)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>47.124700</td>
      <td>-99.238100</td>
      <td>NaN</td>
      <td>1.162071e-11</td>
    </tr>
    <tr>
      <th>Wooster (OH71)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>40.781300</td>
      <td>-81.919700</td>
      <td>NaN</td>
      <td>1.451169e-11</td>
    </tr>
    <tr>
      <th>Wye (MD13)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>38.913100</td>
      <td>-76.152500</td>
      <td>NaN</td>
      <td>1.037033e-11</td>
    </tr>
    <tr>
      <th>Yarner Wood</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>50.596389</td>
      <td>-3.713056</td>
      <td>NaN</td>
      <td>5.424688e-12</td>
    </tr>
    <tr>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.916600</td>
      <td>-110.420300</td>
      <td>NaN</td>
      <td>4.209496e-12</td>
    </tr>
    <tr>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.796100</td>
      <td>-119.858100</td>
      <td>NaN</td>
      <td>1.456536e-11</td>
    </tr>
    <tr>
      <th>Young Woman's Creek (PA18)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>41.414200</td>
      <td>-77.679900</td>
      <td>NaN</td>
      <td>9.197068e-12</td>
    </tr>
    <tr>
      <th>Zarra</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>39.086100</td>
      <td>-1.101900</td>
      <td>NaN</td>
      <td>9.453141e-12</td>
    </tr>
    <tr>
      <th>Zavizan</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.816667</td>
      <td>14.983333</td>
      <td>NaN</td>
      <td>1.953565e-11</td>
    </tr>
    <tr>
      <th>ÃhtÃ¤ri</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>62.533333</td>
      <td>24.221667</td>
      <td>NaN</td>
      <td>1.960589e-12</td>
    </tr>
  </tbody>
</table>
<p>7584 rows Ã 7 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="section" id="Soo-far-soo-good.">
<h2>Soo far soo good.<a class="headerlink" href="#Soo-far-soo-good." title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[154]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#second</span>
<span class="k">def</span> <span class="nf">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fix_df</span><span class="p">(</span><span class="n">first</span><span class="p">)[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">],</span> <span class="n">fix_df</span><span class="p">(</span><span class="n">second</span><span class="p">)[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]],</span> <span class="n">axis</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="21" halign="left">wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th colspan="10" halign="left">GAWTADsubsetAasEtAl</th>
      <th>...</th>
      <th colspan="10" halign="left">OsloCTM3v1.01-met2010_AP3-CTRL</th>
    </tr>
    <tr>
      <th>station_name</th>
      <th>Abington (CT15)</th>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <th>Alamosa (CO00)</th>
      <th>Algoma</th>
      <th>Alhambra (IL46)</th>
      <th>Allahabad</th>
      <th>Ann Arbor (MI52)</th>
      <th>Arendtsville (PA00)</th>
      <th>...</th>
      <th>Woodworth (ND11)</th>
      <th>Wooster (OH71)</th>
      <th>Wye (MD13)</th>
      <th>Yarner Wood</th>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <th>Young Woman's Creek (PA18)</th>
      <th>Zarra</th>
      <th>Zavizan</th>
      <th>ÃhtÃ¤ri</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-15</th>
      <td>NaN</td>
      <td>0.000895</td>
      <td>0.000783</td>
      <td>0.001085</td>
      <td>0.000022</td>
      <td>0.000995</td>
      <td>0.001566</td>
      <td>0.000063</td>
      <td>0.000470</td>
      <td>0.002360</td>
      <td>...</td>
      <td>4.391446e-12</td>
      <td>1.498994e-11</td>
      <td>9.371823e-12</td>
      <td>8.338425e-12</td>
      <td>4.312484e-12</td>
      <td>5.019189e-12</td>
      <td>1.560959e-11</td>
      <td>1.269926e-11</td>
      <td>3.294521e-11</td>
      <td>8.714301e-12</td>
    </tr>
    <tr>
      <th>2010-02-15</th>
      <td>0.001201</td>
      <td>NaN</td>
      <td>0.001399</td>
      <td>0.000718</td>
      <td>0.000012</td>
      <td>0.000099</td>
      <td>0.002601</td>
      <td>0.000114</td>
      <td>0.001164</td>
      <td>0.001932</td>
      <td>...</td>
      <td>1.106464e-11</td>
      <td>2.419485e-11</td>
      <td>2.856035e-11</td>
      <td>1.072288e-11</td>
      <td>3.317620e-12</td>
      <td>8.596779e-12</td>
      <td>2.642058e-11</td>
      <td>1.111997e-11</td>
      <td>5.388155e-11</td>
      <td>2.028353e-11</td>
    </tr>
    <tr>
      <th>2010-03-15</th>
      <td>0.002394</td>
      <td>NaN</td>
      <td>0.005291</td>
      <td>0.001286</td>
      <td>0.000235</td>
      <td>0.000515</td>
      <td>0.002327</td>
      <td>0.000000</td>
      <td>0.002315</td>
      <td>0.004116</td>
      <td>...</td>
      <td>1.140536e-11</td>
      <td>1.812117e-11</td>
      <td>2.985291e-11</td>
      <td>9.776437e-12</td>
      <td>1.046714e-11</td>
      <td>7.095921e-12</td>
      <td>2.085583e-11</td>
      <td>1.448864e-11</td>
      <td>3.650530e-11</td>
      <td>1.680516e-11</td>
    </tr>
    <tr>
      <th>2010-04-15</th>
      <td>0.001815</td>
      <td>NaN</td>
      <td>0.003849</td>
      <td>0.001479</td>
      <td>0.000231</td>
      <td>0.002138</td>
      <td>0.002982</td>
      <td>0.000865</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.095090e-11</td>
      <td>1.538061e-11</td>
      <td>1.567176e-11</td>
      <td>4.290239e-12</td>
      <td>2.073608e-11</td>
      <td>8.883767e-12</td>
      <td>2.250951e-11</td>
      <td>6.892443e-12</td>
      <td>5.244276e-11</td>
      <td>2.122450e-11</td>
    </tr>
    <tr>
      <th>2010-05-15</th>
      <td>0.002136</td>
      <td>0.001622</td>
      <td>0.005324</td>
      <td>0.002148</td>
      <td>0.000067</td>
      <td>0.001588</td>
      <td>0.007058</td>
      <td>0.001535</td>
      <td>0.006197</td>
      <td>0.003803</td>
      <td>...</td>
      <td>1.525082e-11</td>
      <td>3.012205e-11</td>
      <td>2.369581e-11</td>
      <td>1.330386e-11</td>
      <td>1.824092e-11</td>
      <td>9.495459e-12</td>
      <td>3.026222e-11</td>
      <td>6.058135e-12</td>
      <td>3.334834e-11</td>
      <td>2.400646e-11</td>
    </tr>
    <tr>
      <th>2010-06-15</th>
      <td>0.004404</td>
      <td>0.005062</td>
      <td>0.009547</td>
      <td>0.004924</td>
      <td>0.000058</td>
      <td>0.001664</td>
      <td>0.009778</td>
      <td>0.000032</td>
      <td>0.004600</td>
      <td>0.004323</td>
      <td>...</td>
      <td>1.253881e-11</td>
      <td>5.388356e-11</td>
      <td>2.237945e-11</td>
      <td>9.368922e-12</td>
      <td>1.036689e-11</td>
      <td>2.141132e-12</td>
      <td>4.814630e-11</td>
      <td>1.483074e-12</td>
      <td>1.947579e-11</td>
      <td>1.700463e-11</td>
    </tr>
    <tr>
      <th>2010-07-15</th>
      <td>0.002919</td>
      <td>0.001510</td>
      <td>0.004754</td>
      <td>0.003165</td>
      <td>0.000313</td>
      <td>0.003054</td>
      <td>0.005950</td>
      <td>0.001808</td>
      <td>0.005145</td>
      <td>0.002953</td>
      <td>...</td>
      <td>1.076756e-11</td>
      <td>3.019250e-11</td>
      <td>1.939931e-11</td>
      <td>1.756922e-11</td>
      <td>7.210307e-12</td>
      <td>1.974421e-12</td>
      <td>2.982115e-11</td>
      <td>3.253119e-12</td>
      <td>1.166445e-11</td>
      <td>1.182147e-11</td>
    </tr>
    <tr>
      <th>2010-08-15</th>
      <td>0.004150</td>
      <td>0.001890</td>
      <td>0.002539</td>
      <td>0.007013</td>
      <td>0.000201</td>
      <td>0.004463</td>
      <td>0.002662</td>
      <td>0.004784</td>
      <td>0.002136</td>
      <td>0.004709</td>
      <td>...</td>
      <td>4.145075e-12</td>
      <td>3.037205e-11</td>
      <td>2.941910e-11</td>
      <td>1.781707e-11</td>
      <td>9.844686e-12</td>
      <td>8.506456e-13</td>
      <td>3.212597e-11</td>
      <td>5.779285e-12</td>
      <td>8.876544e-12</td>
      <td>1.216996e-11</td>
    </tr>
    <tr>
      <th>2010-09-15</th>
      <td>NaN</td>
      <td>0.002080</td>
      <td>0.001780</td>
      <td>0.003467</td>
      <td>0.000231</td>
      <td>0.006738</td>
      <td>0.003733</td>
      <td>0.002791</td>
      <td>0.002439</td>
      <td>0.003363</td>
      <td>...</td>
      <td>1.441965e-11</td>
      <td>2.103923e-11</td>
      <td>1.481914e-11</td>
      <td>9.264823e-12</td>
      <td>4.127097e-12</td>
      <td>4.730935e-13</td>
      <td>2.189410e-11</td>
      <td>4.834706e-12</td>
      <td>4.597247e-11</td>
      <td>1.661259e-11</td>
    </tr>
    <tr>
      <th>2010-10-15</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.001040</td>
      <td>0.002338</td>
      <td>0.000302</td>
      <td>0.002047</td>
      <td>0.000738</td>
      <td>0.002311</td>
      <td>NaN</td>
      <td>0.002830</td>
      <td>...</td>
      <td>2.801823e-12</td>
      <td>1.667234e-11</td>
      <td>2.345487e-11</td>
      <td>1.197042e-11</td>
      <td>4.830932e-12</td>
      <td>7.205136e-12</td>
      <td>1.491730e-11</td>
      <td>8.938566e-12</td>
      <td>2.814195e-11</td>
      <td>7.860317e-12</td>
    </tr>
    <tr>
      <th>2010-11-15</th>
      <td>0.001329</td>
      <td>0.001618</td>
      <td>0.003074</td>
      <td>0.001318</td>
      <td>NaN</td>
      <td>0.003953</td>
      <td>0.004045</td>
      <td>0.010793</td>
      <td>0.001965</td>
      <td>0.003791</td>
      <td>...</td>
      <td>3.537373e-12</td>
      <td>1.770122e-11</td>
      <td>8.896620e-12</td>
      <td>1.030218e-11</td>
      <td>6.948984e-12</td>
      <td>3.958564e-12</td>
      <td>1.788109e-11</td>
      <td>3.420666e-12</td>
      <td>4.199042e-11</td>
      <td>9.995354e-12</td>
    </tr>
    <tr>
      <th>2010-12-15</th>
      <td>0.001029</td>
      <td>0.000951</td>
      <td>0.001163</td>
      <td>0.000537</td>
      <td>0.000101</td>
      <td>0.002248</td>
      <td>0.001890</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.001197</td>
      <td>...</td>
      <td>8.493011e-12</td>
      <td>1.259899e-11</td>
      <td>7.873668e-12</td>
      <td>9.123861e-12</td>
      <td>4.476215e-12</td>
      <td>6.670919e-12</td>
      <td>1.121979e-11</td>
      <td>4.335006e-12</td>
      <td>2.521044e-11</td>
      <td>1.032021e-11</td>
    </tr>
  </tbody>
</table>
<p>12 rows Ã 632 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="21" halign="left">wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th colspan="10" halign="left">CAM5-ATRAS_AP3-CTRL</th>
      <th>...</th>
      <th colspan="10" halign="left">GAWTADsubsetAasEtAl</th>
    </tr>
    <tr>
      <th>station_name</th>
      <th>Abington (CT15)</th>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <th>Alamosa (CO00)</th>
      <th>Algoma</th>
      <th>Alhambra (IL46)</th>
      <th>Allahabad</th>
      <th>Ann Arbor (MI52)</th>
      <th>Arendtsville (PA00)</th>
      <th>...</th>
      <th>Woodworth (ND11)</th>
      <th>Wooster (OH71)</th>
      <th>Wye (MD13)</th>
      <th>Yarner Wood</th>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <th>Young Woman's Creek (PA18)</th>
      <th>Zarra</th>
      <th>Zavizan</th>
      <th>ÃhtÃ¤ri</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-15</th>
      <td>7.619458e-12</td>
      <td>5.537940e-12</td>
      <td>1.879829e-11</td>
      <td>1.017673e-11</td>
      <td>8.540980e-12</td>
      <td>6.607581e-12</td>
      <td>2.567367e-11</td>
      <td>8.021365e-13</td>
      <td>9.314997e-12</td>
      <td>1.377359e-11</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000951</td>
      <td>NaN</td>
      <td>0.001566</td>
      <td>0.000056</td>
      <td>0.000884</td>
      <td>0.001331</td>
      <td>0.001007</td>
      <td>0.004474</td>
      <td>0.000447</td>
    </tr>
    <tr>
      <th>2010-02-15</th>
      <td>8.648099e-12</td>
      <td>8.428183e-12</td>
      <td>2.397757e-11</td>
      <td>7.354824e-12</td>
      <td>1.523780e-11</td>
      <td>1.843193e-12</td>
      <td>2.729615e-11</td>
      <td>5.948270e-13</td>
      <td>1.386522e-11</td>
      <td>1.647475e-11</td>
      <td>...</td>
      <td>0.000161</td>
      <td>0.001300</td>
      <td>NaN</td>
      <td>0.002105</td>
      <td>0.000062</td>
      <td>0.000805</td>
      <td>0.000632</td>
      <td>0.000743</td>
      <td>0.006563</td>
      <td>0.000619</td>
    </tr>
    <tr>
      <th>2010-03-15</th>
      <td>3.736910e-11</td>
      <td>3.641364e-11</td>
      <td>7.139081e-11</td>
      <td>1.505087e-11</td>
      <td>1.809670e-11</td>
      <td>9.261580e-12</td>
      <td>7.996904e-11</td>
      <td>4.108561e-14</td>
      <td>2.329760e-11</td>
      <td>4.243782e-11</td>
      <td>...</td>
      <td>0.000850</td>
      <td>0.003747</td>
      <td>NaN</td>
      <td>0.002461</td>
      <td>0.000291</td>
      <td>0.001018</td>
      <td>0.002360</td>
      <td>0.001678</td>
      <td>0.010961</td>
      <td>0.001230</td>
    </tr>
    <tr>
      <th>2010-04-15</th>
      <td>4.198654e-11</td>
      <td>2.615322e-11</td>
      <td>6.164071e-11</td>
      <td>8.275699e-11</td>
      <td>9.685753e-12</td>
      <td>1.940794e-11</td>
      <td>5.217797e-11</td>
      <td>1.855615e-12</td>
      <td>5.601427e-11</td>
      <td>3.272406e-11</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.002797</td>
      <td>0.001445</td>
      <td>0.000693</td>
      <td>NaN</td>
      <td>0.001664</td>
      <td>NaN</td>
      <td>0.001156</td>
      <td>0.007744</td>
      <td>0.001156</td>
    </tr>
    <tr>
      <th>2010-05-15</th>
      <td>2.833630e-11</td>
      <td>2.949562e-11</td>
      <td>8.826961e-11</td>
      <td>4.334211e-11</td>
      <td>1.812425e-12</td>
      <td>2.400728e-11</td>
      <td>8.504643e-11</td>
      <td>1.144843e-11</td>
      <td>1.027821e-10</td>
      <td>6.390495e-11</td>
      <td>...</td>
      <td>0.001711</td>
      <td>0.004776</td>
      <td>0.001242</td>
      <td>0.001454</td>
      <td>NaN</td>
      <td>0.002215</td>
      <td>0.007382</td>
      <td>0.001678</td>
      <td>0.012863</td>
      <td>0.002125</td>
    </tr>
    <tr>
      <th>2010-06-15</th>
      <td>7.977421e-11</td>
      <td>9.967082e-11</td>
      <td>4.266960e-11</td>
      <td>9.693196e-11</td>
      <td>8.337496e-12</td>
      <td>5.607674e-11</td>
      <td>1.836857e-11</td>
      <td>4.666191e-11</td>
      <td>5.654893e-11</td>
      <td>5.634791e-11</td>
      <td>...</td>
      <td>0.001572</td>
      <td>0.009004</td>
      <td>0.002970</td>
      <td>0.000578</td>
      <td>0.000589</td>
      <td>NaN</td>
      <td>0.005571</td>
      <td>0.001965</td>
      <td>0.008900</td>
      <td>0.000578</td>
    </tr>
    <tr>
      <th>2010-07-15</th>
      <td>4.711749e-11</td>
      <td>3.317911e-11</td>
      <td>3.541107e-11</td>
      <td>7.207842e-11</td>
      <td>3.069668e-11</td>
      <td>3.039045e-11</td>
      <td>2.919662e-11</td>
      <td>2.891522e-10</td>
      <td>3.701117e-11</td>
      <td>6.893960e-11</td>
      <td>...</td>
      <td>0.001297</td>
      <td>0.005011</td>
      <td>0.004150</td>
      <td>0.002237</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.008668</td>
      <td>0.000000</td>
      <td>0.002013</td>
      <td>0.001454</td>
    </tr>
    <tr>
      <th>2010-08-15</th>
      <td>4.453999e-11</td>
      <td>3.011176e-11</td>
      <td>2.770252e-11</td>
      <td>6.389696e-11</td>
      <td>1.099812e-11</td>
      <td>4.386630e-11</td>
      <td>1.823239e-11</td>
      <td>1.855601e-10</td>
      <td>3.229364e-11</td>
      <td>8.520928e-11</td>
      <td>...</td>
      <td>0.000984</td>
      <td>0.004116</td>
      <td>0.005470</td>
      <td>0.001454</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.005212</td>
      <td>0.000447</td>
      <td>0.002237</td>
      <td>0.003915</td>
    </tr>
    <tr>
      <th>2010-09-15</th>
      <td>4.918928e-11</td>
      <td>4.862604e-11</td>
      <td>2.531093e-11</td>
      <td>5.214397e-11</td>
      <td>4.070532e-12</td>
      <td>6.431544e-11</td>
      <td>1.647330e-11</td>
      <td>2.070735e-10</td>
      <td>5.096311e-11</td>
      <td>5.089237e-11</td>
      <td>...</td>
      <td>0.001133</td>
      <td>NaN</td>
      <td>0.001410</td>
      <td>0.001387</td>
      <td>NaN</td>
      <td>0.000312</td>
      <td>0.002624</td>
      <td>0.000462</td>
      <td>0.005663</td>
      <td>0.001618</td>
    </tr>
    <tr>
      <th>2010-10-15</th>
      <td>2.946043e-11</td>
      <td>3.486638e-11</td>
      <td>2.143287e-11</td>
      <td>3.592526e-11</td>
      <td>1.405412e-11</td>
      <td>3.441921e-11</td>
      <td>1.873582e-11</td>
      <td>1.473977e-10</td>
      <td>1.906933e-11</td>
      <td>3.321619e-11</td>
      <td>...</td>
      <td>0.000134</td>
      <td>NaN</td>
      <td>0.002192</td>
      <td>0.001454</td>
      <td>0.000336</td>
      <td>0.001409</td>
      <td>0.001846</td>
      <td>0.001454</td>
      <td>0.007270</td>
      <td>0.000671</td>
    </tr>
    <tr>
      <th>2010-11-15</th>
      <td>1.964703e-11</td>
      <td>3.115853e-11</td>
      <td>2.907023e-11</td>
      <td>1.792456e-11</td>
      <td>1.681433e-12</td>
      <td>3.989932e-11</td>
      <td>4.002856e-11</td>
      <td>1.374018e-12</td>
      <td>1.803367e-11</td>
      <td>3.267455e-11</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.002254</td>
      <td>0.000902</td>
      <td>0.000809</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.002658</td>
      <td>0.000578</td>
      <td>0.007859</td>
      <td>0.000462</td>
    </tr>
    <tr>
      <th>2010-12-15</th>
      <td>5.828273e-12</td>
      <td>5.741043e-12</td>
      <td>2.134818e-11</td>
      <td>8.930879e-12</td>
      <td>3.763171e-12</td>
      <td>8.166990e-12</td>
      <td>2.716506e-11</td>
      <td>6.233177e-14</td>
      <td>1.573159e-11</td>
      <td>9.197068e-12</td>
      <td>...</td>
      <td>0.000101</td>
      <td>0.001197</td>
      <td>NaN</td>
      <td>0.000895</td>
      <td>0.000179</td>
      <td>0.000783</td>
      <td>NaN</td>
      <td>0.001230</td>
      <td>0.004698</td>
      <td>0.000336</td>
    </tr>
  </tbody>
</table>
<p>12 rows Ã 632 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span> <span class="n">coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span> <span class="k">for</span> <span class="n">coloc</span> <span class="ow">in</span> <span class="n">list_colocate</span> <span class="p">]</span>
<span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">:</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">],</span>
            <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">]</span>

<span class="n">lala</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">lala</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">lala</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">construct_df_model_intercomparison_to_observations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 80, 160). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 96, 144). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[station_name     Abington (CT15)                                 \
data_source  GAWTADsubsetAasEtAl OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                   NaN                   1.101474e-11
2010-02-15              0.001201                   1.617417e-11
2010-03-15              0.002394                   3.028526e-11
2010-04-15              0.001815                   2.441301e-11
2010-05-15              0.002136                   1.239039e-11
2010-06-15              0.004404                   3.170837e-11
2010-07-15              0.002919                   1.745229e-11
2010-08-15              0.004150                   2.264605e-11
2010-09-15                   NaN                   1.474363e-11
2010-10-15                   NaN                   2.707664e-11
2010-11-15              0.001329                   1.241212e-11
2010-12-15              0.001029                   1.188433e-11

station_name Acadia National Park-McFarland Hill (ME98)  \
data_source                         GAWTADsubsetAasEtAl
time
2010-01-15                                     0.000895
2010-02-15                                          NaN
2010-03-15                                          NaN
2010-04-15                                          NaN
2010-05-15                                     0.001622
2010-06-15                                     0.005062
2010-07-15                                     0.001510
2010-08-15                                     0.001890
2010-09-15                                     0.002080
2010-10-15                                          NaN
2010-11-15                                     0.001618
2010-12-15                                     0.000951

station_name                                 \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     1.506232e-11
2010-02-15                     1.690011e-11
2010-03-15                     2.070596e-11
2010-04-15                     1.149291e-11
2010-05-15                     1.425061e-11
2010-06-15                     4.085760e-11
2010-07-15                     2.291286e-11
2010-08-15                     1.132537e-11
2010-09-15                     1.449737e-11
2010-10-15                     2.187046e-11
2010-11-15                     2.067017e-11
2010-12-15                     1.755087e-11

station_name Agronomy Center for Research and Extension (IN41)  \
data_source                                GAWTADsubsetAasEtAl
time
2010-01-15                                            0.000783
2010-02-15                                            0.001399
2010-03-15                                            0.005291
2010-04-15                                            0.003849
2010-05-15                                            0.005324
2010-06-15                                            0.009547
2010-07-15                                            0.004754
2010-08-15                                            0.002539
2010-09-15                                            0.001780
2010-10-15                                            0.001040
2010-11-15                                            0.003074
2010-12-15                                            0.001163

station_name                                 \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     1.540255e-11
2010-02-15                     1.622979e-11
2010-03-15                     2.868071e-11
2010-04-15                     1.701637e-11
2010-05-15                     3.524035e-11
2010-06-15                     2.593983e-11
2010-07-15                     3.083856e-11
2010-08-15                     9.043917e-12
2010-09-15                     8.849791e-12
2010-10-15                     8.087505e-12
2010-11-15                     1.595927e-11
2010-12-15                     1.130635e-11

station_name Akwesasne Mohawk-Fort Covington (NY22)  \
data_source                     GAWTADsubsetAasEtAl
time
2010-01-15                                 0.001085
2010-02-15                                 0.000718
2010-03-15                                 0.001286
2010-04-15                                 0.001479
2010-05-15                                 0.002148
2010-06-15                                 0.004924
2010-07-15                                 0.003165
2010-08-15                                 0.007013
2010-09-15                                 0.003467
2010-10-15                                 0.002338
2010-11-15                                 0.001318
2010-12-15                                 0.000537

station_name                                     Alamosa (CO00)  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.648081e-11            0.000022
2010-02-15                     1.353954e-11            0.000012
2010-03-15                     1.530902e-11            0.000235
2010-04-15                     2.879189e-11            0.000231
2010-05-15                     1.939020e-11            0.000067
2010-06-15                     4.174451e-11            0.000058
2010-07-15                     2.810107e-11            0.000313
2010-08-15                     3.726308e-11            0.000201
2010-09-15                     2.896290e-11            0.000231
2010-10-15                     2.304163e-11            0.000302
2010-11-15                     1.443989e-11                 NaN
2010-12-15                     1.136428e-11            0.000101

station_name                                 ...  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL  ...
time                                         ...
2010-01-15                     2.765577e-12  ...
2010-02-15                     1.012656e-11  ...
2010-03-15                     1.319414e-11  ...
2010-04-15                     1.398473e-11  ...
2010-05-15                     1.262871e-11  ...
2010-06-15                     7.953231e-12  ...
2010-07-15                     1.390094e-11  ...
2010-08-15                     7.941177e-12  ...
2010-09-15                     1.833223e-12  ...
2010-10-15                     8.825139e-12  ...
2010-11-15                     2.303226e-12  ...
2010-12-15                     4.325677e-12  ...

station_name Yosemite National Park-Hodgdon Meadow (CA99)  \
data_source                           GAWTADsubsetAasEtAl
time
2010-01-15                                       0.000884
2010-02-15                                       0.000805
2010-03-15                                       0.001018
2010-04-15                                       0.001664
2010-05-15                                       0.002215
2010-06-15                                            NaN
2010-07-15                                            NaN
2010-08-15                                            NaN
2010-09-15                                       0.000312
2010-10-15                                       0.001409
2010-11-15                                            NaN
2010-12-15                                       0.000783

station_name                                Young Woman&#39;s Creek (PA18)  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL        GAWTADsubsetAasEtAl
time
2010-01-15                     5.019189e-12                   0.001331
2010-02-15                     8.596779e-12                   0.000632
2010-03-15                     7.095921e-12                   0.002360
2010-04-15                     8.883767e-12                        NaN
2010-05-15                     9.495459e-12                   0.007382
2010-06-15                     2.141132e-12                   0.005571
2010-07-15                     1.974421e-12                   0.008668
2010-08-15                     8.506456e-13                   0.005212
2010-09-15                     4.730935e-13                   0.002624
2010-10-15                     7.205136e-12                   0.001846
2010-11-15                     3.958564e-12                   0.002658
2010-12-15                     6.670919e-12                        NaN

station_name                                              Zarra  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.560959e-11            0.001007
2010-02-15                     2.642058e-11            0.000743
2010-03-15                     2.085583e-11            0.001678
2010-04-15                     2.250951e-11            0.001156
2010-05-15                     3.026222e-11            0.001678
2010-06-15                     4.814630e-11            0.001965
2010-07-15                     2.982115e-11            0.000000
2010-08-15                     3.212597e-11            0.000447
2010-09-15                     2.189410e-11            0.000462
2010-10-15                     1.491730e-11            0.001454
2010-11-15                     1.788109e-11            0.000578
2010-12-15                     1.121979e-11            0.001230

station_name                                            Zavizan  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.269926e-11            0.004474
2010-02-15                     1.111997e-11            0.006563
2010-03-15                     1.448864e-11            0.010961
2010-04-15                     6.892443e-12            0.007744
2010-05-15                     6.058135e-12            0.012863
2010-06-15                     1.483074e-12            0.008900
2010-07-15                     3.253119e-12            0.002013
2010-08-15                     5.779285e-12            0.002237
2010-09-15                     4.834706e-12            0.005663
2010-10-15                     8.938566e-12            0.007270
2010-11-15                     3.420666e-12            0.007859
2010-12-15                     4.335006e-12            0.004698

station_name                                             ÃhtÃ¤ri  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     3.294521e-11            0.000447
2010-02-15                     5.388155e-11            0.000619
2010-03-15                     3.650530e-11            0.001230
2010-04-15                     5.244276e-11            0.001156
2010-05-15                     3.334834e-11            0.002125
2010-06-15                     1.947579e-11            0.000578
2010-07-15                     1.166445e-11            0.001454
2010-08-15                     8.876544e-12            0.003915
2010-09-15                     4.597247e-11            0.001618
2010-10-15                     2.814195e-11            0.000671
2010-11-15                     4.199042e-11            0.000462
2010-12-15                     2.521044e-11            0.000336

station_name
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     8.714301e-12
2010-02-15                     2.028353e-11
2010-03-15                     1.680516e-11
2010-04-15                     2.122450e-11
2010-05-15                     2.400646e-11
2010-06-15                     1.700463e-11
2010-07-15                     1.182147e-11
2010-08-15                     1.216996e-11
2010-09-15                     1.661259e-11
2010-10-15                     7.860317e-12
2010-11-15                     9.995354e-12
2010-12-15                     1.032021e-11

[12 rows x 632 columns], station_name     Abington (CT15)                                 \
data_source  GAWTADsubsetAasEtAl OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                   NaN                   1.101474e-11
2010-02-15              0.001201                   1.617417e-11
2010-03-15              0.002394                   3.028526e-11
2010-04-15              0.001815                   2.441301e-11
2010-05-15              0.002136                   1.239039e-11
2010-06-15              0.004404                   3.170837e-11
2010-07-15              0.002919                   1.745229e-11
2010-08-15              0.004150                   2.264605e-11
2010-09-15                   NaN                   1.474363e-11
2010-10-15                   NaN                   2.707664e-11
2010-11-15              0.001329                   1.241212e-11
2010-12-15              0.001029                   1.188433e-11

station_name Acadia National Park-McFarland Hill (ME98)  \
data_source                         GAWTADsubsetAasEtAl
time
2010-01-15                                     0.000895
2010-02-15                                          NaN
2010-03-15                                          NaN
2010-04-15                                          NaN
2010-05-15                                     0.001622
2010-06-15                                     0.005062
2010-07-15                                     0.001510
2010-08-15                                     0.001890
2010-09-15                                     0.002080
2010-10-15                                          NaN
2010-11-15                                     0.001618
2010-12-15                                     0.000951

station_name                                 \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     1.506232e-11
2010-02-15                     1.690011e-11
2010-03-15                     2.070596e-11
2010-04-15                     1.149291e-11
2010-05-15                     1.425061e-11
2010-06-15                     4.085760e-11
2010-07-15                     2.291286e-11
2010-08-15                     1.132537e-11
2010-09-15                     1.449737e-11
2010-10-15                     2.187046e-11
2010-11-15                     2.067017e-11
2010-12-15                     1.755087e-11

station_name Agronomy Center for Research and Extension (IN41)  \
data_source                                GAWTADsubsetAasEtAl
time
2010-01-15                                            0.000783
2010-02-15                                            0.001399
2010-03-15                                            0.005291
2010-04-15                                            0.003849
2010-05-15                                            0.005324
2010-06-15                                            0.009547
2010-07-15                                            0.004754
2010-08-15                                            0.002539
2010-09-15                                            0.001780
2010-10-15                                            0.001040
2010-11-15                                            0.003074
2010-12-15                                            0.001163

station_name                                 \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     1.540255e-11
2010-02-15                     1.622979e-11
2010-03-15                     2.868071e-11
2010-04-15                     1.701637e-11
2010-05-15                     3.524035e-11
2010-06-15                     2.593983e-11
2010-07-15                     3.083856e-11
2010-08-15                     9.043917e-12
2010-09-15                     8.849791e-12
2010-10-15                     8.087505e-12
2010-11-15                     1.595927e-11
2010-12-15                     1.130635e-11

station_name Akwesasne Mohawk-Fort Covington (NY22)  \
data_source                     GAWTADsubsetAasEtAl
time
2010-01-15                                 0.001085
2010-02-15                                 0.000718
2010-03-15                                 0.001286
2010-04-15                                 0.001479
2010-05-15                                 0.002148
2010-06-15                                 0.004924
2010-07-15                                 0.003165
2010-08-15                                 0.007013
2010-09-15                                 0.003467
2010-10-15                                 0.002338
2010-11-15                                 0.001318
2010-12-15                                 0.000537

station_name                                     Alamosa (CO00)  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.648081e-11            0.000022
2010-02-15                     1.353954e-11            0.000012
2010-03-15                     1.530902e-11            0.000235
2010-04-15                     2.879189e-11            0.000231
2010-05-15                     1.939020e-11            0.000067
2010-06-15                     4.174451e-11            0.000058
2010-07-15                     2.810107e-11            0.000313
2010-08-15                     3.726308e-11            0.000201
2010-09-15                     2.896290e-11            0.000231
2010-10-15                     2.304163e-11            0.000302
2010-11-15                     1.443989e-11                 NaN
2010-12-15                     1.136428e-11            0.000101

station_name                                 ...  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL  ...
time                                         ...
2010-01-15                     2.765577e-12  ...
2010-02-15                     1.012656e-11  ...
2010-03-15                     1.319414e-11  ...
2010-04-15                     1.398473e-11  ...
2010-05-15                     1.262871e-11  ...
2010-06-15                     7.953231e-12  ...
2010-07-15                     1.390094e-11  ...
2010-08-15                     7.941177e-12  ...
2010-09-15                     1.833223e-12  ...
2010-10-15                     8.825139e-12  ...
2010-11-15                     2.303226e-12  ...
2010-12-15                     4.325677e-12  ...

station_name Yosemite National Park-Hodgdon Meadow (CA99)  \
data_source                           GAWTADsubsetAasEtAl
time
2010-01-15                                       0.000884
2010-02-15                                       0.000805
2010-03-15                                       0.001018
2010-04-15                                       0.001664
2010-05-15                                       0.002215
2010-06-15                                            NaN
2010-07-15                                            NaN
2010-08-15                                            NaN
2010-09-15                                       0.000312
2010-10-15                                       0.001409
2010-11-15                                            NaN
2010-12-15                                       0.000783

station_name                                Young Woman&#39;s Creek (PA18)  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL        GAWTADsubsetAasEtAl
time
2010-01-15                     5.019189e-12                   0.001331
2010-02-15                     8.596779e-12                   0.000632
2010-03-15                     7.095921e-12                   0.002360
2010-04-15                     8.883767e-12                        NaN
2010-05-15                     9.495459e-12                   0.007382
2010-06-15                     2.141132e-12                   0.005571
2010-07-15                     1.974421e-12                   0.008668
2010-08-15                     8.506456e-13                   0.005212
2010-09-15                     4.730935e-13                   0.002624
2010-10-15                     7.205136e-12                   0.001846
2010-11-15                     3.958564e-12                   0.002658
2010-12-15                     6.670919e-12                        NaN

station_name                                              Zarra  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.560959e-11            0.001007
2010-02-15                     2.642058e-11            0.000743
2010-03-15                     2.085583e-11            0.001678
2010-04-15                     2.250951e-11            0.001156
2010-05-15                     3.026222e-11            0.001678
2010-06-15                     4.814630e-11            0.001965
2010-07-15                     2.982115e-11            0.000000
2010-08-15                     3.212597e-11            0.000447
2010-09-15                     2.189410e-11            0.000462
2010-10-15                     1.491730e-11            0.001454
2010-11-15                     1.788109e-11            0.000578
2010-12-15                     1.121979e-11            0.001230

station_name                                            Zavizan  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     1.269926e-11            0.004474
2010-02-15                     1.111997e-11            0.006563
2010-03-15                     1.448864e-11            0.010961
2010-04-15                     6.892443e-12            0.007744
2010-05-15                     6.058135e-12            0.012863
2010-06-15                     1.483074e-12            0.008900
2010-07-15                     3.253119e-12            0.002013
2010-08-15                     5.779285e-12            0.002237
2010-09-15                     4.834706e-12            0.005663
2010-10-15                     8.938566e-12            0.007270
2010-11-15                     3.420666e-12            0.007859
2010-12-15                     4.335006e-12            0.004698

station_name                                             ÃhtÃ¤ri  \
data_source  OsloCTM3v1.01-met2010_AP3-CTRL GAWTADsubsetAasEtAl
time
2010-01-15                     3.294521e-11            0.000447
2010-02-15                     5.388155e-11            0.000619
2010-03-15                     3.650530e-11            0.001230
2010-04-15                     5.244276e-11            0.001156
2010-05-15                     3.334834e-11            0.002125
2010-06-15                     1.947579e-11            0.000578
2010-07-15                     1.166445e-11            0.001454
2010-08-15                     8.876544e-12            0.003915
2010-09-15                     4.597247e-11            0.001618
2010-10-15                     2.814195e-11            0.000671
2010-11-15                     4.199042e-11            0.000462
2010-12-15                     2.521044e-11            0.000336

station_name
data_source  OsloCTM3v1.01-met2010_AP3-CTRL
time
2010-01-15                     8.714301e-12
2010-02-15                     2.028353e-11
2010-03-15                     1.680516e-11
2010-04-15                     2.122450e-11
2010-05-15                     2.400646e-11
2010-06-15                     1.700463e-11
2010-07-15                     1.182147e-11
2010-08-15                     1.216996e-11
2010-09-15                     1.661259e-11
2010-10-15                     7.860317e-12
2010-11-15                     9.995354e-12
2010-12-15                     1.032021e-11

[12 rows x 632 columns]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-98-d07adc85b5f9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>construct_df_model_intercomparison_to_observations<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-97-f3ddac236dd0&gt;</span> in <span class="ansi-cyan-fg">construct_df_model_intercomparison_to_observations</span><span class="ansi-blue-fg">(vars_to_retrieve, OBS_network, list_model_ID, bias, rmse)</span>
<span class="ansi-green-intense-fg ansi-bold">     34</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span>     lala <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span>dataframes<span class="ansi-blue-fg">,</span> axis <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>sort_index<span class="ansi-blue-fg">(</span>axis <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> level <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> inplace <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 36</span><span class="ansi-red-fg">     </span>df <span class="ansi-blue-fg">=</span> lala<span class="ansi-blue-fg">.</span>loc<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">~</span>lala<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">.</span>duplicated<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>     <span class="ansi-green-fg">return</span> df

<span class="ansi-red-fg">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;loc&#39;
</pre></div></div>
</div>
<p>Check version of pyaerocom:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#pya.__version__ #0.8.1.dev1</span>
</pre></div>
</div>
</div>
<p>Viewing the supported variables.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#pya.browse_database(&#39;*GFDL-AM4-met2010_AP3-CTRL*&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Problems-with-collocating-âGFDL-AM4-met2010_AP3-CTRLâ-and-aas-et-al">
<h2>Problems with collocating âGFDL-AM4-met2010_AP3-CTRLâ and aas et al<a class="headerlink" href="#Problems-with-collocating-âGFDL-AM4-met2010_AP3-CTRLâ-and-aas-et-al" title="Permalink to this headline">Â¶</a></h2>
</div>
</div>
<div class="section" id="look-more-into-this-later">
<h1>look more into this later<a class="headerlink" href="#look-more-into-this-later" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;*GFDL-AM4-met2010_AP3-CTRL*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: FileConventionError(&#34;Failed to extract variable name from file aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc using file convention aerocom3.\nError: FileConventionError(&#39;Invalid file name (Aerocom 3 naming convention).\\n/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-III-2019/GFDL-AM4-met2010_AP3-CTRL/renamed/aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc\\nInvalid string identifier for vertical coordinate: Surace&#39;)&#34;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Pyaerocom ReadGridded
---------------------
Data ID: GFDL-AM4-met2010_AP3-CTRL
Data directory: /lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-III-2019/GFDL-AM4-met2010_AP3-CTRL/renamed
Available experiments: [&#39;AP3-CTRL&#39;]
Available years: [2010]
Available frequencies [&#39;monthly&#39; &#39;daily&#39;]
Available variables: [&#39;abs550aer&#39;, &#39;ac550aer&#39;, &#39;airmass&#39;, &#39;areacella&#39;, &#39;cdnc&#39;, &#39;chepsoa&#39;, &#39;clt&#39;, &#39;dh&#39;, &#39;drybc&#39;, &#39;drydust&#39;, &#39;drypoa&#39;, &#39;dryso4&#39;, &#39;drysoa&#39;, &#39;dryss&#39;, &#39;ec550aer&#39;, &#39;emibc&#39;, &#39;emidust&#39;, &#39;emipoa&#39;, &#39;emiso2&#39;, &#39;emiss&#39;, &#39;loadbc&#39;, &#39;loaddu&#39;, &#39;loadlgdst&#39;, &#39;loadoc&#39;, &#39;loadsmdst&#39;, &#39;loadso4&#39;, &#39;loadss&#39;, &#39;mmrbc&#39;, &#39;mmrdust&#39;, &#39;mmrlgdst&#39;, &#39;mmroa&#39;, &#39;mmrpm1&#39;, &#39;mmrpm10&#39;, &#39;mmrpm2p5&#39;, &#39;mmrsmdst&#39;, &#39;mmrso4&#39;, &#39;mmrss&#39;, &#39;od550aer&#39;, &#39;od550bc&#39;, &#39;od550dust&#39;, &#39;od550lgdst&#39;, &#39;od550lt1aer&#39;, &#39;od550oa&#39;, &#39;od550smdst&#39;, &#39;od550so4&#39;, &#39;od550ss&#39;, &#39;od870aer&#39;, &#39;orog&#39;, &#39;pr&#39;, &#39;ps&#39;, &#39;q&#39;, &#39;rho&#39;, &#39;rlds&#39;, &#39;rldscs&#39;, &#39;rlus&#39;, &#39;rlut&#39;, &#39;rlutcs&#39;, &#39;rsds&#39;, &#39;rsdscs&#39;, &#39;rsdt&#39;, &#39;rsus&#39;, &#39;rsuscs&#39;, &#39;rsut&#39;, &#39;rsutcs&#39;, &#39;sftlf&#39;, &#39;ta&#39;, &#39;tas&#39;, &#39;tntrl&#39;, &#39;tntrs&#39;, &#39;wetbc&#39;, &#39;wetdust&#39;, &#39;wetpoa&#39;, &#39;wetso4&#39;, &#39;wetsoa&#39;, &#39;wetss&#39;, &#39;zg&#39;, &#39;zg1000&#39;, &#39;zg500&#39;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">DATA_ID_models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">,</span>  <span class="s1">&#39;CAM5-ATRAS_AP3-CTRL&#39;</span><span class="p">,</span> <span class="s1">&#39;GFDL-AM4-met2010_AP3-CTRL&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span> <span class="c1"># they all have the same unit</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">DATA_ID</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span>
<span class="n">VAR_TO_READ</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span>
<span class="n">aas_reader</span> <span class="o">=</span> <span class="n">ReadUngridded</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>
<span class="n">ungridded_data</span> <span class="o">=</span> <span class="n">aas_reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datasets_to_read</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reader_model</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">DATA_ID_models</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">gridded_data</span> <span class="o">=</span> <span class="n">reader_model</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="p">[</span><span class="n">vars_to_retrieve</span><span class="p">],</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">2010</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gridded_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="p">[</span><span class="n">vars_to_retrieve</span><span class="p">],</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">2010</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">DATA_ID_models</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: FileConventionError(&#34;Failed to extract variable name from file aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc using file convention aerocom3.\nError: FileConventionError(&#39;Invalid file name (Aerocom 3 naming convention).\\n/lustre/storeA/project/aerocom/aerocom-users-database/AEROCOM-PHASE-III-2019/GFDL-AM4-met2010_AP3-CTRL/renamed/aerocom3_GFDL-AM4-met2010_AP3-CTRL_rsds_Surace_2010_monthly.nc\\nInvalid string identifier for vertical coordinate: Surace&#39;)&#34;)
Failed to import file aerocom3_GFDL-AM4-met2010_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: GFDL-AM4-met2010_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gridded_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of wetso4 / (kg m-2 s-1) (time: 12; latitude: 80; longitude: 160)&gt;,
 pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of wet deposition rate of so4 / (kg m-2 s-1) (time: 12; latitude: 96; longitude: 144)&gt;,
 pyaerocom.GriddedData
 Grid data: &lt;iris &#39;Cube&#39; of tendency_of_atmosphere_mass_content_of_sulfate_dry_aerosol_particles_due_to_wet_deposition / (kg m-2 s-1) (time: 12; latitude: 180; longitude: 288)&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ONE</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ungridded_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 80, 160). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ONE</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;wetso4&#39; (data_source: 2, time: 12, station_name: 316)&gt;
array([[[         nan, 8.948091e-04, ..., 4.474046e-03, 4.474046e-04],
        [1.201201e-03,          nan, ..., 6.563265e-03, 6.191760e-04],
        ...,
        [1.329164e-03, 1.618113e-03, ..., 7.859407e-03, 4.623181e-04],
        [1.029031e-03, 9.507347e-04, ..., 4.697748e-03, 3.355534e-04]],

       [[1.101474e-11, 1.506232e-11, ..., 3.294521e-11, 8.714301e-12],
        [1.617417e-11, 1.690011e-11, ..., 5.388155e-11, 2.028353e-11],
        ...,
        [1.241212e-11, 2.067017e-11, ..., 4.199042e-11, 9.995354e-12],
        [1.188433e-11, 1.755087e-11, ..., 2.521044e-11, 1.032021e-11]]])
Coordinates:
  * data_source   (data_source) &lt;U30 &#39;GAWTADsubsetAasEtAl&#39; &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;
    var_name      (data_source) &lt;U6 &#39;wetso4&#39; &#39;wetso4&#39;
    var_units     (data_source) &lt;U10 &#39;kg m-2 s-1&#39; &#39;kg m-2 s-1&#39;
    ts_type_src   (data_source) &lt;U7 &#39;monthly&#39; &#39;monthly&#39;
  * time          (time) datetime64[ns] 2010-01-15 2010-02-15 ... 2010-12-15
  * station_name  (station_name) &lt;U63 &#39;Abington (CT15)&#39; ... &#39;ÃhtÃ¤ri&#39;
    latitude      (station_name) float64 41.84 44.38 40.47 ... 39.09 44.82 62.53
    longitude     (station_name) float64 -72.01 -68.26 -86.99 ... 14.98 24.22
    altitude      (station_name) float64 nan nan nan nan nan ... nan nan nan nan
Attributes:
    data_source:     [&#39;GAWTADsubsetAasEtAl&#39;, &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;]
    var_name:        [&#39;wetso4&#39;, &#39;wetso4&#39;]
    ts_type:         monthly
    filter_name:     WORLD-wMOUNTAINS
    ts_type_src:     [&#39;monthly&#39;, &#39;monthly&#39;]
    start_str:       20100101
    stop_str:        20101231
    var_units:       [&#39;kg m-2 s-1&#39;, &#39;kg m-2 s-1&#39;]
    vert_scheme:     None
    data_level:      3
    revision_ref:    20190522
    from_files:      [&#39;aerocom3_OsloCTM3v1.01-met2010_AP3-CTRL_wetso4_Surface...
    from_files_ref:  None
    region:          WORLD
    lon_range:       [-180, 180]
    lat_range:       [-90, 90]
    alt_range:       None
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#two = pya.colocation.colocate_gridded_ungridded(gridded_data[2], ungridded_data, ts_type=&#39;monthly&#39;)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gridded_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">var_name</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;wetso4&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ungridded_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
UngriddedData &lt;networks: [&#39;GAWTADsubsetAasEtAl&#39;]; vars: [&#39;wetso4&#39;]; instruments: [&#39;wet only&#39;, &#39;bulk&#39;, &#39;bulk &#39;, &#39;wet-only&#39;];No. of stations: 370
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">THREE</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ungridded_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 96, 144). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#THREE</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;wetso4&#39; (data_source: 2, time: 12, station_name: 316)&gt;
array([[[         nan, 8.948091e-04, ..., 4.474046e-03, 4.474046e-04],
        [1.201201e-03,          nan, ..., 6.563265e-03, 6.191760e-04],
        ...,
        [1.329164e-03, 1.618113e-03, ..., 7.859407e-03, 4.623181e-04],
        [1.029031e-03, 9.507347e-04, ..., 4.697748e-03, 3.355534e-04]],

       [[7.619458e-12, 5.537940e-12, ..., 3.261841e-11, 2.165039e-12],
        [8.648099e-12, 8.428183e-12, ..., 3.181980e-11, 5.903959e-12],
        ...,
        [1.964703e-11, 3.115853e-11, ..., 6.997593e-11, 3.381500e-12],
        [5.828273e-12, 5.741043e-12, ..., 1.953565e-11, 1.960589e-12]]])
Coordinates:
  * data_source   (data_source) &lt;U19 &#39;GAWTADsubsetAasEtAl&#39; &#39;CAM5-ATRAS_AP3-CTRL&#39;
    var_name      (data_source) &lt;U6 &#39;wetso4&#39; &#39;wetso4&#39;
    var_units     (data_source) &lt;U10 &#39;kg m-2 s-1&#39; &#39;kg m-2 s-1&#39;
    ts_type_src   (data_source) &lt;U7 &#39;monthly&#39; &#39;monthly&#39;
  * time          (time) datetime64[ns] 2010-01-15 2010-02-15 ... 2010-12-15
  * station_name  (station_name) &lt;U63 &#39;Abington (CT15)&#39; ... &#39;ÃhtÃ¤ri&#39;
    latitude      (station_name) float64 41.84 44.38 40.47 ... 39.09 44.82 62.53
    longitude     (station_name) float64 -72.01 -68.26 -86.99 ... 14.98 24.22
    altitude      (station_name) float64 nan nan nan nan nan ... nan nan nan nan
Attributes:
    data_source:     [&#39;GAWTADsubsetAasEtAl&#39;, &#39;CAM5-ATRAS_AP3-CTRL&#39;]
    var_name:        [&#39;wetso4&#39;, &#39;wetso4&#39;]
    ts_type:         monthly
    filter_name:     WORLD-wMOUNTAINS
    ts_type_src:     [&#39;monthly&#39;, &#39;monthly&#39;]
    start_str:       20100101
    stop_str:        20101231
    var_units:       [&#39;kg m-2 s-1&#39;, &#39;kg m-2 s-1&#39;]
    vert_scheme:     None
    data_level:      3
    revision_ref:    20190522
    from_files:      [&#39;aerocom3_CAM5-ATRAS_AP3-CTRL_wetso4_Surface_2010_month...
    from_files_ref:  None
    region:          WORLD
    lon_range:       [-180, 180]
    lat_range:       [-90, 90]
    alt_range:       None
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># two = pya.colocation.colocate_gridded_ungridded(gridded_data[2], ungridded_data, ts_type=&#39;monthly&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="Colocate">
<h2>Colocate<a class="headerlink" href="#Colocate" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_stations</span> <span class="o">=</span> <span class="n">ONE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">all_stations</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>var_name</th>
      <th>var_units</th>
      <th>ts_type_src</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>altitude</th>
      <th>wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>time</th>
      <th>station_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">GAWTADsubsetAasEtAl</th>
      <th rowspan="5" valign="top">2010-01-15</th>
      <th>Abington (CT15)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>41.8400</td>
      <td>-72.0101</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.3772</td>
      <td>-68.2608</td>
      <td>NaN</td>
      <td>0.000895</td>
    </tr>
    <tr>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>40.4749</td>
      <td>-86.9924</td>
      <td>NaN</td>
      <td>0.000783</td>
    </tr>
    <tr>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>44.9226</td>
      <td>-74.4806</td>
      <td>NaN</td>
      <td>0.001085</td>
    </tr>
    <tr>
      <th>Alamosa (CO00)</th>
      <td>wetso4</td>
      <td>kg m-2 s-1</td>
      <td>monthly</td>
      <td>37.4421</td>
      <td>-105.8680</td>
      <td>NaN</td>
      <td>0.000022</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merge_with</span> <span class="o">=</span> <span class="n">THREE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">merge_with</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span> <span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span> <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>time</th>
      <th>station_name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="30" valign="top">GAWTADsubsetAasEtAl</th>
      <th rowspan="30" valign="top">2010-01-15</th>
      <th>Abington (CT15)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <td>8.948091e-04</td>
    </tr>
    <tr>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <td>7.829580e-04</td>
    </tr>
    <tr>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <td>1.084956e-03</td>
    </tr>
    <tr>
      <th>Alamosa (CO00)</th>
      <td>2.237023e-05</td>
    </tr>
    <tr>
      <th>Algoma</th>
      <td>9.954752e-04</td>
    </tr>
    <tr>
      <th>Alhambra (IL46)</th>
      <td>1.565916e-03</td>
    </tr>
    <tr>
      <th>Allahabad</th>
      <td>6.263664e-05</td>
    </tr>
    <tr>
      <th>Ann Arbor (MI52)</th>
      <td>4.697748e-04</td>
    </tr>
    <tr>
      <th>Arendtsville (PA00)</th>
      <td>2.360059e-03</td>
    </tr>
    <tr>
      <th>Ashland Wildlife Area (MO03)</th>
      <td>1.543546e-03</td>
    </tr>
    <tr>
      <th>Aspvreten</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Assateague Island National Seashore-Woodcock (MD18)</th>
      <td>6.822920e-04</td>
    </tr>
    <tr>
      <th>Attwater Prairie Chicken National Wildlife Refuge (TX10)</th>
      <td>2.975240e-03</td>
    </tr>
    <tr>
      <th>Aurora Research Farm (NY08)</th>
      <td>5.928111e-04</td>
    </tr>
    <tr>
      <th>BANIZOUMBOU</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Babcock State Park (WV04)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Bandelier National Monument (NM07)</th>
      <td>1.901469e-04</td>
    </tr>
    <tr>
      <th>Barcarrota</th>
      <td>4.474046e-04</td>
    </tr>
    <tr>
      <th>Bay D'Espoir</th>
      <td>4.585897e-04</td>
    </tr>
    <tr>
      <th>Beaufort (NC06)</th>
      <td>2.214653e-03</td>
    </tr>
    <tr>
      <th>Beeville (TX03)</th>
      <td>1.677767e-03</td>
    </tr>
    <tr>
      <th>Bellville (GA20)</th>
      <td>2.673242e-03</td>
    </tr>
    <tr>
      <th>Bennett Bridge (NY52)</th>
      <td>1.756063e-03</td>
    </tr>
    <tr>
      <th>Bennington (VT01)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Big Bend National Park - K-Bar (TX04)</th>
      <td>4.250343e-04</td>
    </tr>
    <tr>
      <th>Big Springs Fish Hatchery (IA08)</th>
      <td>1.006660e-03</td>
    </tr>
    <tr>
      <th>Birkenes</th>
      <td>3.579237e-03</td>
    </tr>
    <tr>
      <th>Biscuit Brook (NY68)</th>
      <td>1.319843e-03</td>
    </tr>
    <tr>
      <th>Black Belt Research &amp; Extension Center (AL10)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="30" valign="top">CAM5-ATRAS_AP3-CTRL</th>
      <th rowspan="30" valign="top">2010-12-15</th>
      <th>Unionville (MI51)</th>
      <td>1.141686e-11</td>
    </tr>
    <tr>
      <th>University Forest (MO05)</th>
      <td>3.385257e-11</td>
    </tr>
    <tr>
      <th>Valentia Observatory</th>
      <td>3.160185e-12</td>
    </tr>
    <tr>
      <th>Verna Well Field (FL41)</th>
      <td>2.087127e-11</td>
    </tr>
    <tr>
      <th>Vilsandi</th>
      <td>8.424598e-12</td>
    </tr>
    <tr>
      <th>Virolahti II</th>
      <td>1.002713e-11</td>
    </tr>
    <tr>
      <th>Visakhapatnam</th>
      <td>3.465497e-11</td>
    </tr>
    <tr>
      <th>Voyageurs National Park-Sullivan Bay (MN32)</th>
      <td>4.499523e-12</td>
    </tr>
    <tr>
      <th>VÃ­znar</th>
      <td>7.858172e-12</td>
    </tr>
    <tr>
      <th>Waldhof</th>
      <td>3.779522e-11</td>
    </tr>
    <tr>
      <th>Walker Branch Watershed (TN00)</th>
      <td>2.890028e-11</td>
    </tr>
    <tr>
      <th>Warren 2WSW (AR02)</th>
      <td>2.751409e-11</td>
    </tr>
    <tr>
      <th>Warsaw Caves</th>
      <td>1.028635e-11</td>
    </tr>
    <tr>
      <th>Wellston (MI53)</th>
      <td>1.345812e-11</td>
    </tr>
    <tr>
      <th>West Point (NY99)</th>
      <td>8.307061e-12</td>
    </tr>
    <tr>
      <th>Westerland</th>
      <td>1.391650e-11</td>
    </tr>
    <tr>
      <th>Whiteface Mountain (NY98)</th>
      <td>8.930879e-12</td>
    </tr>
    <tr>
      <th>Wildcat Mountain (WI98)</th>
      <td>1.671519e-11</td>
    </tr>
    <tr>
      <th>Wolf Creek Pass (CO91)</th>
      <td>7.115234e-12</td>
    </tr>
    <tr>
      <th>Wolf Ridge (MN99)</th>
      <td>4.740397e-12</td>
    </tr>
    <tr>
      <th>Woodworth (ND11)</th>
      <td>1.162071e-11</td>
    </tr>
    <tr>
      <th>Wooster (OH71)</th>
      <td>1.451169e-11</td>
    </tr>
    <tr>
      <th>Wye (MD13)</th>
      <td>1.037033e-11</td>
    </tr>
    <tr>
      <th>Yarner Wood</th>
      <td>5.424688e-12</td>
    </tr>
    <tr>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <td>4.209496e-12</td>
    </tr>
    <tr>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <td>1.456536e-11</td>
    </tr>
    <tr>
      <th>Young Woman's Creek (PA18)</th>
      <td>9.197068e-12</td>
    </tr>
    <tr>
      <th>Zarra</th>
      <td>9.453141e-12</td>
    </tr>
    <tr>
      <th>Zavizan</th>
      <td>1.953565e-11</td>
    </tr>
    <tr>
      <th>ÃhtÃ¤ri</th>
      <td>1.960589e-12</td>
    </tr>
  </tbody>
</table>
<p>7584 rows Ã 1 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>wetso4</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>time</th>
      <th>station_name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="30" valign="top">GAWTADsubsetAasEtAl</th>
      <th rowspan="30" valign="top">2010-01-15</th>
      <th>Abington (CT15)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <td>8.948091e-04</td>
    </tr>
    <tr>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <td>7.829580e-04</td>
    </tr>
    <tr>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <td>1.084956e-03</td>
    </tr>
    <tr>
      <th>Alamosa (CO00)</th>
      <td>2.237023e-05</td>
    </tr>
    <tr>
      <th>Algoma</th>
      <td>9.954752e-04</td>
    </tr>
    <tr>
      <th>Alhambra (IL46)</th>
      <td>1.565916e-03</td>
    </tr>
    <tr>
      <th>Allahabad</th>
      <td>6.263664e-05</td>
    </tr>
    <tr>
      <th>Ann Arbor (MI52)</th>
      <td>4.697748e-04</td>
    </tr>
    <tr>
      <th>Arendtsville (PA00)</th>
      <td>2.360059e-03</td>
    </tr>
    <tr>
      <th>Ashland Wildlife Area (MO03)</th>
      <td>1.543546e-03</td>
    </tr>
    <tr>
      <th>Aspvreten</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Assateague Island National Seashore-Woodcock (MD18)</th>
      <td>6.822920e-04</td>
    </tr>
    <tr>
      <th>Attwater Prairie Chicken National Wildlife Refuge (TX10)</th>
      <td>2.975240e-03</td>
    </tr>
    <tr>
      <th>Aurora Research Farm (NY08)</th>
      <td>5.928111e-04</td>
    </tr>
    <tr>
      <th>BANIZOUMBOU</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Babcock State Park (WV04)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Bandelier National Monument (NM07)</th>
      <td>1.901469e-04</td>
    </tr>
    <tr>
      <th>Barcarrota</th>
      <td>4.474046e-04</td>
    </tr>
    <tr>
      <th>Bay D'Espoir</th>
      <td>4.585897e-04</td>
    </tr>
    <tr>
      <th>Beaufort (NC06)</th>
      <td>2.214653e-03</td>
    </tr>
    <tr>
      <th>Beeville (TX03)</th>
      <td>1.677767e-03</td>
    </tr>
    <tr>
      <th>Bellville (GA20)</th>
      <td>2.673242e-03</td>
    </tr>
    <tr>
      <th>Bennett Bridge (NY52)</th>
      <td>1.756063e-03</td>
    </tr>
    <tr>
      <th>Bennington (VT01)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Big Bend National Park - K-Bar (TX04)</th>
      <td>4.250343e-04</td>
    </tr>
    <tr>
      <th>Big Springs Fish Hatchery (IA08)</th>
      <td>1.006660e-03</td>
    </tr>
    <tr>
      <th>Birkenes</th>
      <td>3.579237e-03</td>
    </tr>
    <tr>
      <th>Biscuit Brook (NY68)</th>
      <td>1.319843e-03</td>
    </tr>
    <tr>
      <th>Black Belt Research &amp; Extension Center (AL10)</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="30" valign="top">CAM5-ATRAS_AP3-CTRL</th>
      <th rowspan="30" valign="top">2010-12-15</th>
      <th>Unionville (MI51)</th>
      <td>1.141686e-11</td>
    </tr>
    <tr>
      <th>University Forest (MO05)</th>
      <td>3.385257e-11</td>
    </tr>
    <tr>
      <th>Valentia Observatory</th>
      <td>3.160185e-12</td>
    </tr>
    <tr>
      <th>Verna Well Field (FL41)</th>
      <td>2.087127e-11</td>
    </tr>
    <tr>
      <th>Vilsandi</th>
      <td>8.424598e-12</td>
    </tr>
    <tr>
      <th>Virolahti II</th>
      <td>1.002713e-11</td>
    </tr>
    <tr>
      <th>Visakhapatnam</th>
      <td>3.465497e-11</td>
    </tr>
    <tr>
      <th>Voyageurs National Park-Sullivan Bay (MN32)</th>
      <td>4.499523e-12</td>
    </tr>
    <tr>
      <th>VÃ­znar</th>
      <td>7.858172e-12</td>
    </tr>
    <tr>
      <th>Waldhof</th>
      <td>3.779522e-11</td>
    </tr>
    <tr>
      <th>Walker Branch Watershed (TN00)</th>
      <td>2.890028e-11</td>
    </tr>
    <tr>
      <th>Warren 2WSW (AR02)</th>
      <td>2.751409e-11</td>
    </tr>
    <tr>
      <th>Warsaw Caves</th>
      <td>1.028635e-11</td>
    </tr>
    <tr>
      <th>Wellston (MI53)</th>
      <td>1.345812e-11</td>
    </tr>
    <tr>
      <th>West Point (NY99)</th>
      <td>8.307061e-12</td>
    </tr>
    <tr>
      <th>Westerland</th>
      <td>1.391650e-11</td>
    </tr>
    <tr>
      <th>Whiteface Mountain (NY98)</th>
      <td>8.930879e-12</td>
    </tr>
    <tr>
      <th>Wildcat Mountain (WI98)</th>
      <td>1.671519e-11</td>
    </tr>
    <tr>
      <th>Wolf Creek Pass (CO91)</th>
      <td>7.115234e-12</td>
    </tr>
    <tr>
      <th>Wolf Ridge (MN99)</th>
      <td>4.740397e-12</td>
    </tr>
    <tr>
      <th>Woodworth (ND11)</th>
      <td>1.162071e-11</td>
    </tr>
    <tr>
      <th>Wooster (OH71)</th>
      <td>1.451169e-11</td>
    </tr>
    <tr>
      <th>Wye (MD13)</th>
      <td>1.037033e-11</td>
    </tr>
    <tr>
      <th>Yarner Wood</th>
      <td>5.424688e-12</td>
    </tr>
    <tr>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <td>4.209496e-12</td>
    </tr>
    <tr>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <td>1.456536e-11</td>
    </tr>
    <tr>
      <th>Young Woman's Creek (PA18)</th>
      <td>9.197068e-12</td>
    </tr>
    <tr>
      <th>Zarra</th>
      <td>9.453141e-12</td>
    </tr>
    <tr>
      <th>Zavizan</th>
      <td>1.953565e-11</td>
    </tr>
    <tr>
      <th>ÃhtÃ¤ri</th>
      <td>1.960589e-12</td>
    </tr>
  </tbody>
</table>
<p>7584 rows Ã 1 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_stations</span> <span class="o">=</span> <span class="n">all_stations</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span> <span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span> <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="TODO-swap">
<h2>TODO swap<a class="headerlink" href="#TODO-swap" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#all_stations.unstack()[&#39;wetso4&#39;].transpose()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">first</span>  <span class="o">=</span> <span class="n">fix_df</span><span class="p">(</span><span class="n">ONE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">())</span>
<span class="n">second</span> <span class="o">=</span> <span class="n">fix_df</span><span class="p">(</span><span class="n">THREE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;wetso4&#39;], [&#39;GAWTADsubsetAasEtAl&#39;, &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;], [&#39;Abington (CT15)&#39;, &#39;Acadia National Park-McFarland Hill (ME98)&#39;, &#39;Agronomy Center for Research and Extension (IN41)&#39;, &#39;Akwesasne Mohawk-Fort Covington (NY22)&#39;, &#39;Alamosa (CO00)&#39;, &#39;Algoma&#39;, &#39;Alhambra (IL46)&#39;, &#39;Allahabad&#39;, &#39;Ann Arbor (MI52)&#39;, &#39;Arendtsville (PA00)&#39;, &#39;Ashland Wildlife Area (MO03)&#39;, &#39;Aspvreten&#39;, &#39;Assateague Island National Seashore-Woodcock (MD18)&#39;, &#39;Attwater Prairie Chicken National Wildlife Refuge (TX10)&#39;, &#39;Aurora Research Farm (NY08)&#39;, &#39;BANIZOUMBOU&#39;, &#39;Babcock State Park (WV04)&#39;, &#39;Bandelier National Monument (NM07)&#39;, &#39;Barcarrota&#39;, &#39;Bay D&#39;Espoir&#39;, &#39;Beaufort (NC06)&#39;, &#39;Beeville (TX03)&#39;, &#39;Bellville (GA20)&#39;, &#39;Bennett Bridge (NY52)&#39;, &#39;Bennington (VT01)&#39;, &#39;Big Bend National Park - K-Bar (TX04)&#39;, &#39;Big Springs Fish Hatchery (IA08)&#39;, &#39;Birkenes&#39;, &#39;Biscuit Brook (NY68)&#39;, &#39;Black Belt Research &amp; Extension Center (AL10)&#39;, &#39;Bondville (IL11)&#39;, &#39;Bonner Lake&#39;, &#39;Bradford Forest (FL03)&#39;, &#39;Bridgton (ME02)&#39;, &#39;Brooklyn Lake (WY95)&#39;, &#39;Brotjacklriegel&#39;, &#39;Bryce Canyon National Park-Repeater Hill (UT99)&#39;, &#39;Buffalo National River-Buffalo Point (AR16)&#39;, &#39;Buffalo Pass - Dry Lake (CO93)&#39;, &#39;Buffalo Pass - Summit Lake (CO97)&#39;, &#39;Caddo Valley (AR03)&#39;, &#39;Caldwell (OH49)&#39;, &#39;Camp Ripley (MN23)&#39;, &#39;Campisabalos&#39;, &#39;Canyonlands National Park-Island in the Sky (UT09)&#39;, &#39;Cape Romain National Wildlife Refuge (SC05)&#39;, &#39;Capulin Volcano National Monument (NM12)&#39;, &#39;Caribou (ME00)&#39;, &#39;Casco Bay-Wolfeâs Neck Farm (ME96)&#39;, &#39;Cedar Creek (MN01)&#39;, &#39;Cedar Creek State Park (WV05)&#39;, &#39;Chalk River&#39;, &#39;Chapais&#39;, &#39;Charlottesville (VA00)&#39;, &#39;Chassahowitzka National Wildlife Refuge (FL05)&#39;, &#39;Chassell (MI99)&#39;, &#39;Chaumont&#39;, &#39;Chautauqua (NY10)&#39;, &#39;Chiricahua (AZ98)&#39;, &#39;Chula (GA99)&#39;, &#39;Clancy (MT07)&#39;, &#39;Clark State Fish Hatchery (KY35)&#39;, &#39;Clinton (MS10)&#39;, &#39;Clinton Crops Research Station (NC35)&#39;, &#39;Coffeeville (MS30)&#39;, &#39;Cottonwood (SD08)&#39;, &#39;Coweeta (NC25)&#39;, &#39;Craters of the Moon National Monument (ID03)&#39;, &#39;Danki&#39;, &#39;Davis (CA88)&#39;, &#39;Deer Creek State Park (OH54)&#39;, &#39;Delaware (OH17)&#39;, &#39;Denali National Park-Mt. McKinley (AK03)&#39;, &#39;Deuselbach&#39;, &#39;Diabla Gora&#39;, &#39;Dixon Springs Agricultural Center (IL63)&#39;, &#39;Donon&#39;, &#39;Douglas Lake (MI09)&#39;, &#39;E.L.A.&#39;, &#39;Edwin B. Forsythe National Wildlife Refuge (NJ00)&#39;, &#39;Egbert&#39;, &#39;Eskdalemuir&#39;, &#39;Everglades National Park-Research Center (FL11)&#39;, &#39;Farlington Fish Hatchery (KS07)&#39;, &#39;Fayetteville (AR27)&#39;, &#39;Fernberg (MN18)&#39;, &#39;Four Mile Park (CO08)&#39;, &#39;Fundy National Park&#39;, &#39;Georgia Station (GA41)&#39;, &#39;Gila Cliff Dwellings National Monument (NM01)&#39;, &#39;Gilead (ME08)&#39;, &#39;Glacier National Park-Fire Weather Station (MT05)&#39;, &#39;Goodwell Research Station (OK29)&#39;, &#39;Goose Bay&#39;, &#39;Gothic (CO10)&#39;, &#39;Grand Canyon National Park-Hopi Point (AZ03)&#39;, &#39;Great Basin National Park-Lehman Caves (NV05)&#39;, &#39;Great Smoky Mountains National Park-Elkmont (TN11)&#39;, &#39;Green River (UT98)&#39;, &#39;Greenville Station (ME09)&#39;, ...]]
[[&#39;wetso4&#39;], [&#39;GAWTADsubsetAasEtAl&#39;, &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;], [&#39;Abington (CT15)&#39;, &#39;Acadia National Park-McFarland Hill (ME98)&#39;, &#39;Agronomy Center for Research and Extension (IN41)&#39;, &#39;Akwesasne Mohawk-Fort Covington (NY22)&#39;, &#39;Alamosa (CO00)&#39;, &#39;Algoma&#39;, &#39;Alhambra (IL46)&#39;, &#39;Allahabad&#39;, &#39;Ann Arbor (MI52)&#39;, &#39;Arendtsville (PA00)&#39;, &#39;Ashland Wildlife Area (MO03)&#39;, &#39;Aspvreten&#39;, &#39;Assateague Island National Seashore-Woodcock (MD18)&#39;, &#39;Attwater Prairie Chicken National Wildlife Refuge (TX10)&#39;, &#39;Aurora Research Farm (NY08)&#39;, &#39;BANIZOUMBOU&#39;, &#39;Babcock State Park (WV04)&#39;, &#39;Bandelier National Monument (NM07)&#39;, &#39;Barcarrota&#39;, &#39;Bay D&#39;Espoir&#39;, &#39;Beaufort (NC06)&#39;, &#39;Beeville (TX03)&#39;, &#39;Bellville (GA20)&#39;, &#39;Bennett Bridge (NY52)&#39;, &#39;Bennington (VT01)&#39;, &#39;Big Bend National Park - K-Bar (TX04)&#39;, &#39;Big Springs Fish Hatchery (IA08)&#39;, &#39;Birkenes&#39;, &#39;Biscuit Brook (NY68)&#39;, &#39;Black Belt Research &amp; Extension Center (AL10)&#39;, &#39;Bondville (IL11)&#39;, &#39;Bonner Lake&#39;, &#39;Bradford Forest (FL03)&#39;, &#39;Bridgton (ME02)&#39;, &#39;Brooklyn Lake (WY95)&#39;, &#39;Brotjacklriegel&#39;, &#39;Bryce Canyon National Park-Repeater Hill (UT99)&#39;, &#39;Buffalo National River-Buffalo Point (AR16)&#39;, &#39;Buffalo Pass - Dry Lake (CO93)&#39;, &#39;Buffalo Pass - Summit Lake (CO97)&#39;, &#39;Caddo Valley (AR03)&#39;, &#39;Caldwell (OH49)&#39;, &#39;Camp Ripley (MN23)&#39;, &#39;Campisabalos&#39;, &#39;Canyonlands National Park-Island in the Sky (UT09)&#39;, &#39;Cape Romain National Wildlife Refuge (SC05)&#39;, &#39;Capulin Volcano National Monument (NM12)&#39;, &#39;Caribou (ME00)&#39;, &#39;Casco Bay-Wolfeâs Neck Farm (ME96)&#39;, &#39;Cedar Creek (MN01)&#39;, &#39;Cedar Creek State Park (WV05)&#39;, &#39;Chalk River&#39;, &#39;Chapais&#39;, &#39;Charlottesville (VA00)&#39;, &#39;Chassahowitzka National Wildlife Refuge (FL05)&#39;, &#39;Chassell (MI99)&#39;, &#39;Chaumont&#39;, &#39;Chautauqua (NY10)&#39;, &#39;Chiricahua (AZ98)&#39;, &#39;Chula (GA99)&#39;, &#39;Clancy (MT07)&#39;, &#39;Clark State Fish Hatchery (KY35)&#39;, &#39;Clinton (MS10)&#39;, &#39;Clinton Crops Research Station (NC35)&#39;, &#39;Coffeeville (MS30)&#39;, &#39;Cottonwood (SD08)&#39;, &#39;Coweeta (NC25)&#39;, &#39;Craters of the Moon National Monument (ID03)&#39;, &#39;Danki&#39;, &#39;Davis (CA88)&#39;, &#39;Deer Creek State Park (OH54)&#39;, &#39;Delaware (OH17)&#39;, &#39;Denali National Park-Mt. McKinley (AK03)&#39;, &#39;Deuselbach&#39;, &#39;Diabla Gora&#39;, &#39;Dixon Springs Agricultural Center (IL63)&#39;, &#39;Donon&#39;, &#39;Douglas Lake (MI09)&#39;, &#39;E.L.A.&#39;, &#39;Edwin B. Forsythe National Wildlife Refuge (NJ00)&#39;, &#39;Egbert&#39;, &#39;Eskdalemuir&#39;, &#39;Everglades National Park-Research Center (FL11)&#39;, &#39;Farlington Fish Hatchery (KS07)&#39;, &#39;Fayetteville (AR27)&#39;, &#39;Fernberg (MN18)&#39;, &#39;Four Mile Park (CO08)&#39;, &#39;Fundy National Park&#39;, &#39;Georgia Station (GA41)&#39;, &#39;Gila Cliff Dwellings National Monument (NM01)&#39;, &#39;Gilead (ME08)&#39;, &#39;Glacier National Park-Fire Weather Station (MT05)&#39;, &#39;Goodwell Research Station (OK29)&#39;, &#39;Goose Bay&#39;, &#39;Gothic (CO10)&#39;, &#39;Grand Canyon National Park-Hopi Point (AZ03)&#39;, &#39;Great Basin National Park-Lehman Caves (NV05)&#39;, &#39;Great Smoky Mountains National Park-Elkmont (TN11)&#39;, &#39;Green River (UT98)&#39;, &#39;Greenville Station (ME09)&#39;, ...]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">second</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>station_name</th>
      <th>Abington (CT15)</th>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <th>Alamosa (CO00)</th>
      <th>Algoma</th>
      <th>Alhambra (IL46)</th>
      <th>Allahabad</th>
      <th>Ann Arbor (MI52)</th>
      <th>Arendtsville (PA00)</th>
      <th>...</th>
      <th>Woodworth (ND11)</th>
      <th>Wooster (OH71)</th>
      <th>Wye (MD13)</th>
      <th>Yarner Wood</th>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <th>Young Woman's Creek (PA18)</th>
      <th>Zarra</th>
      <th>Zavizan</th>
      <th>ÃhtÃ¤ri</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>...</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-15</th>
      <td>NaN</td>
      <td>0.000895</td>
      <td>0.000783</td>
      <td>0.001085</td>
      <td>0.000022</td>
      <td>0.000995</td>
      <td>0.001566</td>
      <td>0.000063</td>
      <td>0.000470</td>
      <td>0.002360</td>
      <td>...</td>
      <td>4.391446e-12</td>
      <td>1.498994e-11</td>
      <td>9.371823e-12</td>
      <td>8.338425e-12</td>
      <td>4.312484e-12</td>
      <td>5.019189e-12</td>
      <td>1.560959e-11</td>
      <td>1.269926e-11</td>
      <td>3.294521e-11</td>
      <td>8.714301e-12</td>
    </tr>
    <tr>
      <th>2010-02-15</th>
      <td>0.001201</td>
      <td>NaN</td>
      <td>0.001399</td>
      <td>0.000718</td>
      <td>0.000012</td>
      <td>0.000099</td>
      <td>0.002601</td>
      <td>0.000114</td>
      <td>0.001164</td>
      <td>0.001932</td>
      <td>...</td>
      <td>1.106464e-11</td>
      <td>2.419485e-11</td>
      <td>2.856035e-11</td>
      <td>1.072288e-11</td>
      <td>3.317620e-12</td>
      <td>8.596779e-12</td>
      <td>2.642058e-11</td>
      <td>1.111997e-11</td>
      <td>5.388155e-11</td>
      <td>2.028353e-11</td>
    </tr>
    <tr>
      <th>2010-03-15</th>
      <td>0.002394</td>
      <td>NaN</td>
      <td>0.005291</td>
      <td>0.001286</td>
      <td>0.000235</td>
      <td>0.000515</td>
      <td>0.002327</td>
      <td>0.000000</td>
      <td>0.002315</td>
      <td>0.004116</td>
      <td>...</td>
      <td>1.140536e-11</td>
      <td>1.812117e-11</td>
      <td>2.985291e-11</td>
      <td>9.776437e-12</td>
      <td>1.046714e-11</td>
      <td>7.095921e-12</td>
      <td>2.085583e-11</td>
      <td>1.448864e-11</td>
      <td>3.650530e-11</td>
      <td>1.680516e-11</td>
    </tr>
    <tr>
      <th>2010-04-15</th>
      <td>0.001815</td>
      <td>NaN</td>
      <td>0.003849</td>
      <td>0.001479</td>
      <td>0.000231</td>
      <td>0.002138</td>
      <td>0.002982</td>
      <td>0.000865</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.095090e-11</td>
      <td>1.538061e-11</td>
      <td>1.567176e-11</td>
      <td>4.290239e-12</td>
      <td>2.073608e-11</td>
      <td>8.883767e-12</td>
      <td>2.250951e-11</td>
      <td>6.892443e-12</td>
      <td>5.244276e-11</td>
      <td>2.122450e-11</td>
    </tr>
    <tr>
      <th>2010-05-15</th>
      <td>0.002136</td>
      <td>0.001622</td>
      <td>0.005324</td>
      <td>0.002148</td>
      <td>0.000067</td>
      <td>0.001588</td>
      <td>0.007058</td>
      <td>0.001535</td>
      <td>0.006197</td>
      <td>0.003803</td>
      <td>...</td>
      <td>1.525082e-11</td>
      <td>3.012205e-11</td>
      <td>2.369581e-11</td>
      <td>1.330386e-11</td>
      <td>1.824092e-11</td>
      <td>9.495459e-12</td>
      <td>3.026222e-11</td>
      <td>6.058135e-12</td>
      <td>3.334834e-11</td>
      <td>2.400646e-11</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 632 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">first</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>station_name</th>
      <th>Abington (CT15)</th>
      <th>Acadia National Park-McFarland Hill (ME98)</th>
      <th>Agronomy Center for Research and Extension (IN41)</th>
      <th>Akwesasne Mohawk-Fort Covington (NY22)</th>
      <th>Alamosa (CO00)</th>
      <th>Algoma</th>
      <th>Alhambra (IL46)</th>
      <th>Allahabad</th>
      <th>Ann Arbor (MI52)</th>
      <th>Arendtsville (PA00)</th>
      <th>...</th>
      <th>Woodworth (ND11)</th>
      <th>Wooster (OH71)</th>
      <th>Wye (MD13)</th>
      <th>Yarner Wood</th>
      <th>Yellowstone National Park-Tower Falls (WY08)</th>
      <th>Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <th>Young Woman's Creek (PA18)</th>
      <th>Zarra</th>
      <th>Zavizan</th>
      <th>ÃhtÃ¤ri</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>...</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-15</th>
      <td>NaN</td>
      <td>0.000895</td>
      <td>0.000783</td>
      <td>0.001085</td>
      <td>0.000022</td>
      <td>0.000995</td>
      <td>0.001566</td>
      <td>0.000063</td>
      <td>0.000470</td>
      <td>0.002360</td>
      <td>...</td>
      <td>4.391446e-12</td>
      <td>1.498994e-11</td>
      <td>9.371823e-12</td>
      <td>8.338425e-12</td>
      <td>4.312484e-12</td>
      <td>5.019189e-12</td>
      <td>1.560959e-11</td>
      <td>1.269926e-11</td>
      <td>3.294521e-11</td>
      <td>8.714301e-12</td>
    </tr>
    <tr>
      <th>2010-02-15</th>
      <td>0.001201</td>
      <td>NaN</td>
      <td>0.001399</td>
      <td>0.000718</td>
      <td>0.000012</td>
      <td>0.000099</td>
      <td>0.002601</td>
      <td>0.000114</td>
      <td>0.001164</td>
      <td>0.001932</td>
      <td>...</td>
      <td>1.106464e-11</td>
      <td>2.419485e-11</td>
      <td>2.856035e-11</td>
      <td>1.072288e-11</td>
      <td>3.317620e-12</td>
      <td>8.596779e-12</td>
      <td>2.642058e-11</td>
      <td>1.111997e-11</td>
      <td>5.388155e-11</td>
      <td>2.028353e-11</td>
    </tr>
    <tr>
      <th>2010-03-15</th>
      <td>0.002394</td>
      <td>NaN</td>
      <td>0.005291</td>
      <td>0.001286</td>
      <td>0.000235</td>
      <td>0.000515</td>
      <td>0.002327</td>
      <td>0.000000</td>
      <td>0.002315</td>
      <td>0.004116</td>
      <td>...</td>
      <td>1.140536e-11</td>
      <td>1.812117e-11</td>
      <td>2.985291e-11</td>
      <td>9.776437e-12</td>
      <td>1.046714e-11</td>
      <td>7.095921e-12</td>
      <td>2.085583e-11</td>
      <td>1.448864e-11</td>
      <td>3.650530e-11</td>
      <td>1.680516e-11</td>
    </tr>
    <tr>
      <th>2010-04-15</th>
      <td>0.001815</td>
      <td>NaN</td>
      <td>0.003849</td>
      <td>0.001479</td>
      <td>0.000231</td>
      <td>0.002138</td>
      <td>0.002982</td>
      <td>0.000865</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.095090e-11</td>
      <td>1.538061e-11</td>
      <td>1.567176e-11</td>
      <td>4.290239e-12</td>
      <td>2.073608e-11</td>
      <td>8.883767e-12</td>
      <td>2.250951e-11</td>
      <td>6.892443e-12</td>
      <td>5.244276e-11</td>
      <td>2.122450e-11</td>
    </tr>
    <tr>
      <th>2010-05-15</th>
      <td>0.002136</td>
      <td>0.001622</td>
      <td>0.005324</td>
      <td>0.002148</td>
      <td>0.000067</td>
      <td>0.001588</td>
      <td>0.007058</td>
      <td>0.001535</td>
      <td>0.006197</td>
      <td>0.003803</td>
      <td>...</td>
      <td>1.525082e-11</td>
      <td>3.012205e-11</td>
      <td>2.369581e-11</td>
      <td>1.330386e-11</td>
      <td>1.824092e-11</td>
      <td>9.495459e-12</td>
      <td>3.026222e-11</td>
      <td>6.058135e-12</td>
      <td>3.334834e-11</td>
      <td>2.400646e-11</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 632 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>station_name</th>
      <th colspan="2" halign="left">Abington (CT15)</th>
      <th colspan="2" halign="left">Acadia National Park-McFarland Hill (ME98)</th>
      <th colspan="2" halign="left">Agronomy Center for Research and Extension (IN41)</th>
      <th colspan="2" halign="left">Akwesasne Mohawk-Fort Covington (NY22)</th>
      <th colspan="2" halign="left">Alamosa (CO00)</th>
      <th>...</th>
      <th colspan="2" halign="left">Yosemite National Park-Hodgdon Meadow (CA99)</th>
      <th colspan="2" halign="left">Young Woman's Creek (PA18)</th>
      <th colspan="2" halign="left">Zarra</th>
      <th colspan="2" halign="left">Zavizan</th>
      <th colspan="2" halign="left">ÃhtÃ¤ri</th>
    </tr>
    <tr>
      <th>data_source</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>...</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
      <th>GAWTADsubsetAasEtAl</th>
      <th>OsloCTM3v1.01-met2010_AP3-CTRL</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-15</th>
      <td>NaN</td>
      <td>1.101474e-11</td>
      <td>0.000895</td>
      <td>1.506232e-11</td>
      <td>0.000783</td>
      <td>1.540255e-11</td>
      <td>0.001085</td>
      <td>1.648081e-11</td>
      <td>0.000022</td>
      <td>2.765577e-12</td>
      <td>...</td>
      <td>0.000884</td>
      <td>5.019189e-12</td>
      <td>0.001331</td>
      <td>1.560959e-11</td>
      <td>0.001007</td>
      <td>1.269926e-11</td>
      <td>0.004474</td>
      <td>3.294521e-11</td>
      <td>0.000447</td>
      <td>8.714301e-12</td>
    </tr>
    <tr>
      <th>2010-02-15</th>
      <td>0.001201</td>
      <td>1.617417e-11</td>
      <td>NaN</td>
      <td>1.690011e-11</td>
      <td>0.001399</td>
      <td>1.622979e-11</td>
      <td>0.000718</td>
      <td>1.353954e-11</td>
      <td>0.000012</td>
      <td>1.012656e-11</td>
      <td>...</td>
      <td>0.000805</td>
      <td>8.596779e-12</td>
      <td>0.000632</td>
      <td>2.642058e-11</td>
      <td>0.000743</td>
      <td>1.111997e-11</td>
      <td>0.006563</td>
      <td>5.388155e-11</td>
      <td>0.000619</td>
      <td>2.028353e-11</td>
    </tr>
    <tr>
      <th>2010-03-15</th>
      <td>0.002394</td>
      <td>3.028526e-11</td>
      <td>NaN</td>
      <td>2.070596e-11</td>
      <td>0.005291</td>
      <td>2.868071e-11</td>
      <td>0.001286</td>
      <td>1.530902e-11</td>
      <td>0.000235</td>
      <td>1.319414e-11</td>
      <td>...</td>
      <td>0.001018</td>
      <td>7.095921e-12</td>
      <td>0.002360</td>
      <td>2.085583e-11</td>
      <td>0.001678</td>
      <td>1.448864e-11</td>
      <td>0.010961</td>
      <td>3.650530e-11</td>
      <td>0.001230</td>
      <td>1.680516e-11</td>
    </tr>
    <tr>
      <th>2010-04-15</th>
      <td>0.001815</td>
      <td>2.441301e-11</td>
      <td>NaN</td>
      <td>1.149291e-11</td>
      <td>0.003849</td>
      <td>1.701637e-11</td>
      <td>0.001479</td>
      <td>2.879189e-11</td>
      <td>0.000231</td>
      <td>1.398473e-11</td>
      <td>...</td>
      <td>0.001664</td>
      <td>8.883767e-12</td>
      <td>NaN</td>
      <td>2.250951e-11</td>
      <td>0.001156</td>
      <td>6.892443e-12</td>
      <td>0.007744</td>
      <td>5.244276e-11</td>
      <td>0.001156</td>
      <td>2.122450e-11</td>
    </tr>
    <tr>
      <th>2010-05-15</th>
      <td>0.002136</td>
      <td>1.239039e-11</td>
      <td>0.001622</td>
      <td>1.425061e-11</td>
      <td>0.005324</td>
      <td>3.524035e-11</td>
      <td>0.002148</td>
      <td>1.939020e-11</td>
      <td>0.000067</td>
      <td>1.262871e-11</td>
      <td>...</td>
      <td>0.002215</td>
      <td>9.495459e-12</td>
      <td>0.007382</td>
      <td>3.026222e-11</td>
      <td>0.001678</td>
      <td>6.058135e-12</td>
      <td>0.012863</td>
      <td>3.334834e-11</td>
      <td>0.002125</td>
      <td>2.400646e-11</td>
    </tr>
    <tr>
      <th>2010-06-15</th>
      <td>0.004404</td>
      <td>3.170837e-11</td>
      <td>0.005062</td>
      <td>4.085760e-11</td>
      <td>0.009547</td>
      <td>2.593983e-11</td>
      <td>0.004924</td>
      <td>4.174451e-11</td>
      <td>0.000058</td>
      <td>7.953231e-12</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.141132e-12</td>
      <td>0.005571</td>
      <td>4.814630e-11</td>
      <td>0.001965</td>
      <td>1.483074e-12</td>
      <td>0.008900</td>
      <td>1.947579e-11</td>
      <td>0.000578</td>
      <td>1.700463e-11</td>
    </tr>
    <tr>
      <th>2010-07-15</th>
      <td>0.002919</td>
      <td>1.745229e-11</td>
      <td>0.001510</td>
      <td>2.291286e-11</td>
      <td>0.004754</td>
      <td>3.083856e-11</td>
      <td>0.003165</td>
      <td>2.810107e-11</td>
      <td>0.000313</td>
      <td>1.390094e-11</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.974421e-12</td>
      <td>0.008668</td>
      <td>2.982115e-11</td>
      <td>0.000000</td>
      <td>3.253119e-12</td>
      <td>0.002013</td>
      <td>1.166445e-11</td>
      <td>0.001454</td>
      <td>1.182147e-11</td>
    </tr>
    <tr>
      <th>2010-08-15</th>
      <td>0.004150</td>
      <td>2.264605e-11</td>
      <td>0.001890</td>
      <td>1.132537e-11</td>
      <td>0.002539</td>
      <td>9.043917e-12</td>
      <td>0.007013</td>
      <td>3.726308e-11</td>
      <td>0.000201</td>
      <td>7.941177e-12</td>
      <td>...</td>
      <td>NaN</td>
      <td>8.506456e-13</td>
      <td>0.005212</td>
      <td>3.212597e-11</td>
      <td>0.000447</td>
      <td>5.779285e-12</td>
      <td>0.002237</td>
      <td>8.876544e-12</td>
      <td>0.003915</td>
      <td>1.216996e-11</td>
    </tr>
    <tr>
      <th>2010-09-15</th>
      <td>NaN</td>
      <td>1.474363e-11</td>
      <td>0.002080</td>
      <td>1.449737e-11</td>
      <td>0.001780</td>
      <td>8.849791e-12</td>
      <td>0.003467</td>
      <td>2.896290e-11</td>
      <td>0.000231</td>
      <td>1.833223e-12</td>
      <td>...</td>
      <td>0.000312</td>
      <td>4.730935e-13</td>
      <td>0.002624</td>
      <td>2.189410e-11</td>
      <td>0.000462</td>
      <td>4.834706e-12</td>
      <td>0.005663</td>
      <td>4.597247e-11</td>
      <td>0.001618</td>
      <td>1.661259e-11</td>
    </tr>
    <tr>
      <th>2010-10-15</th>
      <td>NaN</td>
      <td>2.707664e-11</td>
      <td>NaN</td>
      <td>2.187046e-11</td>
      <td>0.001040</td>
      <td>8.087505e-12</td>
      <td>0.002338</td>
      <td>2.304163e-11</td>
      <td>0.000302</td>
      <td>8.825139e-12</td>
      <td>...</td>
      <td>0.001409</td>
      <td>7.205136e-12</td>
      <td>0.001846</td>
      <td>1.491730e-11</td>
      <td>0.001454</td>
      <td>8.938566e-12</td>
      <td>0.007270</td>
      <td>2.814195e-11</td>
      <td>0.000671</td>
      <td>7.860317e-12</td>
    </tr>
    <tr>
      <th>2010-11-15</th>
      <td>0.001329</td>
      <td>1.241212e-11</td>
      <td>0.001618</td>
      <td>2.067017e-11</td>
      <td>0.003074</td>
      <td>1.595927e-11</td>
      <td>0.001318</td>
      <td>1.443989e-11</td>
      <td>NaN</td>
      <td>2.303226e-12</td>
      <td>...</td>
      <td>NaN</td>
      <td>3.958564e-12</td>
      <td>0.002658</td>
      <td>1.788109e-11</td>
      <td>0.000578</td>
      <td>3.420666e-12</td>
      <td>0.007859</td>
      <td>4.199042e-11</td>
      <td>0.000462</td>
      <td>9.995354e-12</td>
    </tr>
    <tr>
      <th>2010-12-15</th>
      <td>0.001029</td>
      <td>1.188433e-11</td>
      <td>0.000951</td>
      <td>1.755087e-11</td>
      <td>0.001163</td>
      <td>1.130635e-11</td>
      <td>0.000537</td>
      <td>1.136428e-11</td>
      <td>0.000101</td>
      <td>4.325677e-12</td>
      <td>...</td>
      <td>0.000783</td>
      <td>6.670919e-12</td>
      <td>NaN</td>
      <td>1.121979e-11</td>
      <td>0.001230</td>
      <td>4.335006e-12</td>
      <td>0.004698</td>
      <td>2.521044e-11</td>
      <td>0.000336</td>
      <td>1.032021e-11</td>
    </tr>
  </tbody>
</table>
<p>12 rows Ã 632 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">lala</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 Checks for different number of columns
New version edited by hanna.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f205860f050&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_59_2.png" src="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_59_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#all_st = pd.concat(all_stations.unstack(&#39;data_source&#39;), axis = 1)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span> <span class="o">=</span> <span class="n">ONE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">station_name</span> <span class="o">=</span> <span class="s1">&#39;Abington (CT15)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">THREE</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">station_name</span> <span class="o">=</span> <span class="s1">&#39;Abington (CT15)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">table</span>  <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span> <span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span> <span class="s1">&#39;station_name&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span> <span class="p">])</span>

<span class="n">table2</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span> <span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span> <span class="s1">&#39;station_name&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span> <span class="p">])</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table2</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table2</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obs</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">table2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">obs_df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">obs_df</span><span class="p">,</span> <span class="n">model</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bias</span> <span class="o">=</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#merged = pd.concat([merged, bias], axis = 1, keys = [&#39;bias&#39;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#merged</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">],</span> <span class="n">bias</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bias</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">pandas_mse</span><span class="p">(</span><span class="n">merged</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">pandas_r2</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">pandas_mae</span><span class="p">(</span><span class="n">merged</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">num_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;Data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mse</span> <span class="o">=</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mse</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#r2score = r2_score( merged[&#39;model&#39;], merged[&#39;obs&#39;].values )</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#osloctm.loc[:, idx[:, &#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#osloctm = table.drop(&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;, axis = 1)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table2</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wetso4_x&#39;</span><span class="p">:</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4_y&#39;</span><span class="p">:</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">:</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span>
          <span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">:</span> <span class="s1">&#39;OsloCTM3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5-ATRAS_AP3-CTRL&#39;</span><span class="p">:</span> <span class="s1">&#39;CAM5-ATRAS&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">biasOsloCTM3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;OsloCTM3&#39;</span><span class="p">]]</span>   <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;obs&#39;</span><span class="p">]][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">biasCAM5</span>     <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;CAM5-ATRAS&#39;</span><span class="p">]]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;obs&#39;</span><span class="p">]][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">biasOsloCTM3</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;raw&#39;</span><span class="p">:</span><span class="s1">&#39;Bias&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">biasCAM5</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;Bias&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">biasOsloCTM3</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="s1">&#39;OsloCTM3&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="s1">&#39;OsloCTM3&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">biasCAM5</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;PuBu&quot;</span><span class="p">,</span> <span class="n">num_digits</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;model_x&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#table.unstack(&#39;data_source&#39;).merge(table2.unstack(&#39;data_source&#39;), right_on = [&#39;data_source&#39;], left_index = True)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#table.pivot(columns=[&#39;data_source&#39;], index = [&#39;time&#39;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#table.concatenate(table2, left_index = True, right_on = [&#39;data_source&#39;, &#39;time&#39;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">][</span><span class="s1">&#39;OsloCTM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">][</span><span class="s1">&#39;OsloCTM&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">cropped</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;raw&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">][</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">][</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">:</span><span class="s1">&#39;bias&#39;</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cropped</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">][</span><span class="s1">&#39;hh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cropped</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span> <span class="o">=</span> <span class="n">cropped</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span><span class="p">[</span><span class="s1">&#39;bias&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">closer</span><span class="p">[</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">]</span> <span class="o">-</span>  <span class="n">closer</span><span class="p">[</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">month</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">closer</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">closer</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data_coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">data_source</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">station_name</span> <span class="o">=</span> <span class="s1">&#39;Abington (CT15)&#39;</span><span class="p">)</span>
<span class="n">df_obs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data_coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">data_source</span> <span class="o">=</span> <span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">,</span> <span class="n">station_name</span> <span class="o">=</span> <span class="s1">&#39;Abington (CT15)&#39;</span><span class="p">)</span>
<span class="n">df_model</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># bias =  is the difference ..</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bias</span> <span class="o">=</span> <span class="n">df_obs</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;bias&#39;</span><span class="p">:</span> <span class="n">bias</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hh</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">hh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_stations</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">station_name</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">data_coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">all_stations</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Reading-original-files.">
<h2>Reading original files.<a class="headerlink" href="#Reading-original-files." title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1//AEROCOM_OBSDATA/PYAEROCOM/GAWTADSulphurSubset/data/monthly_so2.csv&#39;</span><span class="p">,</span>
         <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1//AEROCOM_OBSDATA/PYAEROCOM/GAWTADSulphurSubset/data/monthly_so4_aero.csv&#39;</span><span class="p">,</span>
         <span class="s1">&#39;/lustre/storeA/project/aerocom/aerocom1//AEROCOM_OBSDATA/PYAEROCOM/GAWTADSulphurSubset/data/monthly_so4_precip.csv&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">station_name</span> <span class="o">==</span> <span class="s1">&#39;Algoma&#39;</span><span class="p">]</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;deposition_kgS/ha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">ReadUngridded</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>
<span class="n">ungridded</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datasets_to_read</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">,</span> <span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">)</span>

<span class="n">station</span> <span class="o">=</span> <span class="n">ungridded</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Algoma&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">)</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">unitconv_sfc_conc_bck</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">wetso4</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">station_name</span> <span class="o">==</span> <span class="s1">&#39;Algoma&#39;</span><span class="p">]</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;deposition_kgS/ha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># Converting month and year.</span>
<span class="n">tconv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">yr</span><span class="p">,</span> <span class="n">m</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:04d}</span><span class="s1">-</span><span class="si">{:02d}</span><span class="s1">-</span><span class="si">{:02d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">dates_alt</span> <span class="o">=</span> <span class="p">[</span><span class="n">tconv</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">yr</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span>
             <span class="nb">zip</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">subset</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
<span class="n">subset</span><span class="p">[</span><span class="s1">&#39;dtime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dates_alt</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">Avogadro</span>

<span class="n">mmSO4</span> <span class="o">=</span> <span class="mf">0.001</span><span class="o">*</span><span class="mf">32.065</span> <span class="o">+</span> <span class="mf">0.001</span><span class="o">*</span><span class="mf">15.999</span><span class="o">*</span><span class="mi">4</span> <span class="c1"># kg/mol</span>
<span class="n">mm_s</span> <span class="o">=</span> <span class="mf">32.065</span><span class="o">*</span><span class="mf">0.001</span> <span class="c1"># kg/mol</span>

<span class="n">nr_molecules</span> <span class="o">=</span> <span class="n">vals</span><span class="o">*</span><span class="n">Avogadro</span><span class="o">/</span><span class="n">mm_s</span>  <span class="c1">#[1]</span>
<span class="n">mass_SO4</span> <span class="o">=</span> <span class="n">nr_molecules</span><span class="o">*</span><span class="n">mmSO4</span><span class="o">/</span><span class="n">Avogadro</span> <span class="c1"># mass in kg</span>

<span class="n">days_in_month</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;dtime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">daysinmonth</span>
<span class="n">monthly_to_sec</span> <span class="o">=</span> <span class="n">days_in_month</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span>

<span class="n">mass_pr_square_m_pr_sek</span> <span class="o">=</span> <span class="p">(</span><span class="n">mass_SO4</span><span class="o">/</span><span class="p">(</span><span class="mi">10000</span><span class="o">*</span><span class="n">monthly_to_sec</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># mass_pr_square_m_pr_sekneed to update the package</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Plotting-stations-maps">
<h1>Plotting stations maps<a class="headerlink" href="#Plotting-stations-maps" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">merged_meta_sev</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot; sconcso2, sconcso4&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>  <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;sconcso4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plotting-using-a-dataset-which-contain-one-variable">
<h1>Plotting using a dataset which contain one variable<a class="headerlink" href="#Plotting-using-a-dataset-which-contain-one-variable" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Algoma&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
<span class="n">abington</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Abington&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
<span class="n">alhambra</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Alhambra&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">country</span> <span class="c1"># None</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">station_coords</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">cast_coords_to_string</span><span class="p">(</span><span class="n">station</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Help function for creating labels, usefull when plotting several stations.  &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">station</span><span class="o">.</span><span class="n">altitude</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">algoma</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">algoma</span><span class="o">.</span><span class="n">station_name</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">cast_coords_to_string</span><span class="p">(</span><span class="n">algoma</span><span class="p">))</span>
<span class="n">abington</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">abington</span><span class="o">.</span><span class="n">station_name</span><span class="p">)</span>
<span class="n">alhambra</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">alhambra</span><span class="o">.</span><span class="n">station_name</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Plotting Several Stations In One Figure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Plotting-using-a-dataset-which-contain-several-variable">
<h2>Plotting using a dataset which contain several variable<a class="headerlink" href="#Plotting-using-a-dataset-which-contain-several-variable" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged_meta_sev</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;[Algoma]&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="How-to-find-common-stations-with-another-data-set">
<h1>How to find common stations with another data set<a class="headerlink" href="#How-to-find-common-stations-with-another-data-set" title="Permalink to this headline">Â¶</a></h1>
<p>After reading one variable, shoudnât the dataset data only contain one variable. This works in the python script.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">contains_vars</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data2</span><span class="o">.</span><span class="n">contains_vars</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plotting-all-available-stations-for-the-two-variables-âsconsso2â-and-âsconsso4â">
<h1>Plotting all available stations for the two variables âsconsso2â and âsconsso4â<a class="headerlink" href="#Plotting-all-available-stations-for-the-two-variables-âsconsso2â-and-âsconsso4â" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;all variables&quot;</span><span class="p">)</span>
<span class="n">data2</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>  <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;sconcso4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge_common_meta</span><span class="p">(</span><span class="n">ignore_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;station_name&quot;</span><span class="p">,</span> <span class="s1">&#39;instrument_name&#39;</span><span class="p">,</span> <span class="s1">&#39;ts_type&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">merged</span><span class="o">.</span><span class="n">unique_station_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">unique_station_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">station_name</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Algoma&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
<span class="n">abington</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Abington&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
<span class="n">alhambra</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_station_data</span><span class="p">(</span><span class="s1">&#39;Alhambra&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="Why-does-this-need-a-imput-variable-when-algoma-only-contain-one?">
<h2>Why does this need a imput variable when algoma only contain one?<a class="headerlink" href="#Why-does-this-need-a-imput-variable-when-algoma-only-contain-one?" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">algoma</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;algoma&quot;</span><span class="p">)</span>
<span class="n">abington</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;abingtion&quot;</span><span class="p">)</span>
<span class="n">alhambra</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;alhambra&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Plotting Several Stations In One Figure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">station_coords</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get_variable_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hmm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_variable_data</span><span class="p">(</span><span class="s2">&quot;sconcso4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Below-here-is-old-code.">
<h2>Below here is old code.<a class="headerlink" href="#Below-here-is-old-code." title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hmm</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_variable_data</span><span class="p">(</span><span class="s2">&quot;sconcso2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Find-the-number-of-common-stations-that-have-both-variables">
<h2>Find the number of common stations that have both variables<a class="headerlink" href="#Find-the-number-of-common-stations-that-have-both-variables" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">find_common_stations</span><span class="p">(</span><span class="n">data2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plotting-a-regional-map-over-stations">
<h2>Plotting a regional map over stations<a class="headerlink" href="#Plotting-a-regional-map-over-stations" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">contains_vars</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Cool-function-to-implement-plot_station_coordinates-based-on-stationnames-and-of-they-are-all-in-one-region-it-filters-outs-by-itselves.">
<h2>Cool function to implement plot_station_coordinates based on stationnames and of they are all in one region it filters outs by itselves.<a class="headerlink" href="#Cool-function-to-implement-plot_station_coordinates-based-on-stationnames-and-of-they-are-all-in-one-region-it-filters-outs-by-itselves." title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="How-do-I-remove-this-print???">
<h3>How do I remove this print???<a class="headerlink" href="#How-do-I-remove-this-print???" title="Permalink to this headline">Â¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot_station_coordinates</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;sconcso2&quot;</span><span class="p">,</span>
                                   <span class="n">filter_name</span><span class="o">=</span><span class="s2">&quot;EUROPE-noMOUNTAINS&quot;</span><span class="p">,</span>
                                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="How-to-retrieve-the-units-from-the-variable??">
<h2>How to retrieve the units from the variable??<a class="headerlink" href="#How-to-retrieve-the-units-from-the-variable??" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">ReadSulphurAasEtAl</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>
<span class="n">ungridded</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ungridded</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ungridded</span><span class="o">.</span><span class="n">unique_station_names</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Is it possible to locate based on coordinates</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ungridded</span><span class="o">.</span><span class="n">latitude</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ungridded</span><span class="o">.</span><span class="n">unique_station_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">ungridded</span><span class="o">.</span><span class="n">merge_common_meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">equal</span> <span class="o">=</span> <span class="n">ungridded</span><span class="o">.</span><span class="n">merge_common_meta</span><span class="p">(</span><span class="n">ignore_keys</span> <span class="o">=</span> <span class="s2">&quot;instruments&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">equal</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">algoma2</span> <span class="o">=</span> <span class="n">ungridded</span><span class="p">[</span><span class="s2">&quot;Abington (CT15)&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># That one variable can not be stored in the same place.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyaerocom.io.readgridded</span> <span class="kn">import</span> <span class="n">ReadGridded</span>
<span class="n">gridded_reader</span> <span class="o">=</span> <span class="n">ReadGridded</span><span class="p">(</span><span class="n">data_id</span> <span class="o">=</span> <span class="s2">&quot;EMEP_rv4.1.1.T2.1_ctl&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gridded_reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Hanna-tests.">
<h2>Hanna tests.<a class="headerlink" href="#Hanna-tests." title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">_true_std</span><span class="p">():</span>
    <span class="c1"># Mesuring this: Absolute annual trend (STD) Î¼gS/m3 year</span>
    <span class="n">regions_std</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N-America&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sconcso4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span>
                                              <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.024</span><span class="p">,</span>
                                              <span class="s1">&#39;2000-2010&#39;</span><span class="p">:</span> <span class="mf">0.029</span><span class="p">,</span>
                                              <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.029</span><span class="p">},</span>

                                 <span class="s2">&quot;wetso4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980-1990&#39;</span><span class="p">:</span> <span class="mf">0.18</span><span class="p">,</span>
                                            <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.13</span><span class="p">,</span>
                                            <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
                                            <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.13</span><span class="p">,</span>
                                            <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.13</span>
                                            <span class="p">},</span>

                                 <span class="s1">&#39;sconcso2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.115</span><span class="p">,</span>
                                              <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.109</span><span class="p">,</span>
                                              <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.113</span><span class="p">,</span>
                                              <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.123</span>
                                              <span class="p">}},</span>

                   <span class="s1">&#39;Europe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sconcso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980â1990&#39;</span><span class="p">:</span> <span class="mf">0.094</span><span class="p">,</span>
                                           <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.052</span><span class="p">,</span>
                                           <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.015</span><span class="p">,</span>
                                           <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.041</span><span class="p">,</span>
                                           <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.028</span><span class="p">},</span>
                              <span class="s1">&#39;wetso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980â1990&#39;</span><span class="p">:</span> <span class="mf">0.36</span><span class="p">,</span>
                                         <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.29</span><span class="p">,</span>
                                         <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>
                                         <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.13</span><span class="p">,</span>
                                         <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.10</span>

                                         <span class="p">},</span>
                              <span class="s1">&#39;sconcso2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980â1990&#39;</span><span class="p">:</span> <span class="mf">0.168</span><span class="p">,</span>
                                           <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.275</span><span class="p">,</span>
                                           <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.085</span><span class="p">,</span>
                                           <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.054</span><span class="p">,</span>
                                           <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.036</span>
                                           <span class="p">},</span>
                              <span class="p">},</span>
                   <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sconcso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980â1990&#39;</span><span class="p">:</span> <span class="mf">3.10</span><span class="p">,</span>
                                          <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">2.11</span><span class="p">,</span>
                                          <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.69</span><span class="p">,</span>
                                          <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">2.03</span><span class="p">},</span>
                             <span class="s1">&#39;wetso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1980â1990&#39;</span><span class="p">:</span> <span class="mf">0.18</span><span class="p">,</span>
                                        <span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.37</span><span class="p">,</span>
                                        <span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.37</span><span class="p">,</span>
                                        <span class="p">},</span>
                             <span class="p">},</span>

                   <span class="s1">&#39;East-Asia&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sconcso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.034</span><span class="p">,</span>
                                              <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.037</span><span class="p">},</span>
                                 <span class="s1">&#39;wetso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;1990â2000&#39;</span><span class="p">:</span> <span class="mf">0.32</span><span class="p">,</span>
                                            <span class="s1">&#39;1990â2015&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                            <span class="s1">&#39;2000-2010&#39;</span><span class="p">:</span> <span class="mf">0.37</span><span class="p">,</span>
                                            <span class="s1">&#39;2000-2015&#39;</span><span class="p">:</span> <span class="mf">0.24</span>
                                            <span class="p">},</span>
                                 <span class="s1">&#39;sconcso2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.119</span><span class="p">,</span>
                                              <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.186</span><span class="p">}},</span>

                   <span class="s1">&#39;Africa&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wetso4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2000-2010&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                              <span class="s1">&#39;sconcso2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2000â2010&#39;</span><span class="p">:</span> <span class="mf">0.121</span><span class="p">,</span>
                                           <span class="s1">&#39;2000â2015&#39;</span><span class="p">:</span> <span class="mf">0.068</span>
                                           <span class="p">}}</span>
                   <span class="p">}</span>
    <span class="k">return</span> <span class="n">regions_std</span>


<span class="k">def</span> <span class="nf">create_region</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to create regions</span>

<span class="sd">    :param region:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &#39;US&#39;: {&#39;minLat&#39;: 22.5, &#39;maxLat&#39;: 71.0, &#39;minLon&#39;: -167, &#39;maxLon&#39;: -59.6},</span>
        <span class="s1">&#39;N-America&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">72.0</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">170.0</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">50.0</span><span class="p">},</span>
        <span class="s1">&#39;S-America&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">55.0</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">14.0</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">85.0</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">33.0</span><span class="p">},</span>
        <span class="s1">&#39;Europe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mf">34.2</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">67.2</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">28.7</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mf">69.1</span><span class="p">},</span>
        <span class="s1">&#39;East-Asia&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.62</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">59.9</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="mf">97.0</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mf">161.19</span><span class="p">},</span>
        <span class="s1">&#39;Africa&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">41.03</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">33.08</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">18.45</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mf">58.54</span><span class="p">},</span>
        <span class="s1">&#39;India&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mf">3.06</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mf">36.0</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="mf">65.92</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mf">96.0</span><span class="p">},</span>
        <span class="s1">&#39;East-US&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">95</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">75</span><span class="p">},</span>
        <span class="s1">&#39;Central-Europe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
        <span class="s1">&#39;Most-East-Asia&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mi">130</span><span class="p">},</span>
        <span class="s1">&#39;World&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mi">180</span><span class="p">},</span>
        <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;minLat&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;maxLat&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;minLon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;maxLon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zf&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;minLon&#39;</span><span class="p">],</span> <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;maxLon&#39;</span><span class="p">],</span> <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;minLat&#39;</span><span class="p">],</span> <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;maxLat&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">crop_data_to_region</span><span class="p">(</span><span class="n">ungridded</span><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;N-America&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function which crops the data into correct regions.&quot;&quot;&quot;</span>
    <span class="n">valid_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N-America&#39;</span><span class="p">,</span> <span class="s1">&#39;S-America&#39;</span><span class="p">,</span> <span class="s1">&#39;Europe&#39;</span><span class="p">,</span> <span class="s1">&#39;East-Asia&#39;</span><span class="p">,</span> <span class="s1">&#39;Africa&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">,</span> <span class="s1">&#39;East-US&#39;</span><span class="p">,</span> <span class="s1">&#39;Central-Europe&#39;</span><span class="p">,</span> <span class="s1">&#39;Most-East-Asia&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">valid_names</span><span class="p">:</span>
        <span class="n">minLon</span><span class="p">,</span> <span class="n">maxLon</span><span class="p">,</span> <span class="n">minLat</span><span class="p">,</span> <span class="n">maxLat</span> <span class="o">=</span> <span class="n">create_region</span><span class="p">(</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ungridded</span><span class="o">.</span><span class="n">filter_by_meta</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="p">(</span><span class="n">minLat</span><span class="p">,</span> <span class="n">maxLat</span><span class="p">),</span> <span class="n">longitude</span><span class="o">=</span><span class="p">(</span><span class="n">minLon</span><span class="p">,</span> <span class="n">maxLon</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is not a valid region. &quot;</span>
                         <span class="s2">&quot;Try &#39;N-America&#39;, &#39;S-America&#39;, &#39;Europe&#39;, &#39;East-Asia&#39;, &#39;Africa&#39;, &#39;India&#39;, &#39;East-US&#39;, &quot;</span>
                         <span class="s2">&quot;&#39;Central-Europe&#39;, &#39;Most-East-Asia&#39; &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">region</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">filter_by_time</span><span class="p">(</span><span class="n">data_cropped_by_region</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">):</span>

    <span class="c1">#station_list = data_dict.stats</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">data_dict</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">ReadSulphurAasEtAl</span><span class="p">(</span><span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># read all variables</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">station_name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">629</span>
<span class="c1">#assert &#39;n/a&#39; in data.data_revision not woriking</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1008552</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># TODO work on filtering</span>
<span class="n">data_so2</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="s2">&quot;sconcso2&quot;</span><span class="p">)</span>
<span class="n">data_so2</span> <span class="o">=</span> <span class="n">crop_data_to_region</span><span class="p">(</span><span class="n">data_so2</span> <span class="p">,</span> <span class="s2">&quot;Europe&quot;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">1980</span>
<span class="n">stop</span> <span class="o">=</span> <span class="mi">1990</span>
<span class="n">station_data_list</span> <span class="o">=</span> <span class="n">data_so2</span><span class="o">.</span><span class="n">to_station_data_all</span><span class="p">(</span><span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;sconcso2&quot;</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span> <span class="s2">&quot;monthly&quot;</span><span class="p">)</span>
<span class="c1">#filter_by_time(data_so2 , 1980, 1990)</span>
<span class="n">empty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">])</span>
<span class="nb">list</span> <span class="o">=</span> <span class="n">station_data_list</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">temp</span><span class="p">,</span> <span class="n">elem</span><span class="p">[</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="STD-for-1980-to-1990-so2-in-Europe-is-wrong???">
<h1>STD for 1980 to 1990 so2 in Europe is wrong???<a class="headerlink" href="#STD-for-1980-to-1990-so2-in-Europe-is-wrong???" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;sconcso2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Working-version-Model-Intercomparion">
<h1>Working version Model Intercomparion<a class="headerlink" href="#Working-version-Model-Intercomparion" title="Permalink to this headline">Â¶</a></h1>
</div>
<div class="section" id="Add-bias-rmse-calculations">
<h1>Add bias rmse calculations<a class="headerlink" href="#Add-bias-rmse-calculations" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[170]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="s1">&#39;wetso4&#39;</span>
<span class="n">OBS_network</span> <span class="o">=</span> <span class="s1">&#39;GAWTADsubsetAasEtAl&#39;</span>
<span class="n">list_model_ID</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OsloCTM3v1.01-met2010_AP3-CTRL&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5-ATRAS_AP3-CTRL&#39;</span><span class="p">]</span>
<span class="n">add_yearly</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">bias</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">region</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">ungridded_data</span>    <span class="o">=</span> <span class="n">ReadUngridded</span><span class="p">()</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">datasets_to_read</span> <span class="o">=</span> <span class="n">OBS_network</span><span class="p">,</span> <span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="n">vars_to_retrieve</span><span class="p">)</span>

<span class="c1"># TODO collocated dataobject can now done by collocated data object, much less stuff to filter by (faster).</span>

<span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">f</span>              <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
    <span class="n">ungridded_data</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">ungridded_data</span><span class="p">)</span>

<span class="n">station_names</span>     <span class="o">=</span> <span class="n">ungridded_data</span><span class="o">.</span><span class="n">station_name</span> <span class="c1"># Is this used anymore.</span>
<span class="n">list_gridded_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span> <span class="o">=</span> <span class="p">[</span><span class="n">vars_to_retrieve</span><span class="p">],</span> <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                     <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">list_model_ID</span> <span class="p">]</span>

<span class="c1"># Possible to retrieve ts type of obeservation</span>
<span class="n">list_colocate</span> <span class="o">=</span> <span class="p">[</span><span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">gridded_data</span><span class="p">,</span> <span class="n">ungridded_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">gridded_data</span> <span class="ow">in</span> <span class="n">list_gridded_data</span><span class="p">]</span>

<span class="c1"># call merged : raw, bias : Bias, rmse : RMSE</span>
<span class="k">def</span> <span class="nf">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;data_source&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;station_name&#39;</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wetso4&#39;</span><span class="p">]</span>

    <span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df2</span>

<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span> <span class="n">coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var_name&#39;</span><span class="p">,</span> <span class="s1">&#39;var_units&#39;</span><span class="p">,</span><span class="s1">&#39;ts_type_src&#39;</span><span class="p">,</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span>
                                                       <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">coloc</span> <span class="ow">in</span> <span class="n">list_colocate</span> <span class="p">]</span>
<span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fix_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">]</span>

<span class="n">seasonal_means</span> <span class="o">=</span> <span class="p">[</span><span class="n">coloc</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">coloc</span> <span class="ow">in</span> <span class="n">list_colocate</span><span class="p">]</span>
<span class="n">df_seasons</span> <span class="o">=</span> <span class="p">[</span><span class="n">fix_df</span><span class="p">(</span><span class="n">seasonal_mean</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">())</span> <span class="k">for</span> <span class="n">seasonal_mean</span> <span class="ow">in</span> <span class="n">seasonal_means</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)):</span>
    <span class="c1"># Append yearly mean</span>
    <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>       <span class="o">=</span> <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Appends seasonal averages</span>
    <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>       <span class="o">=</span> <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">df_seasons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Updates index to</span>
    <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">]])</span>

<span class="n">lala</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Merged dataframes containing diffent models.</span>
<span class="n">lala</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># Sort index</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">lala</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">lala</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span> <span class="c1"># Removes duplicates</span>
<span class="c1"># In this case the obsevations are duplicated, since they are present in both model comparison.</span>
<span class="n">df_to_heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">10</span><span class="p">][</span><span class="s1">&#39;Abington (CT15)&#39;</span><span class="p">],</span> <span class="n">num_digits</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
reader_version is outdated (value: 0.05). Current value: 0.04
Deleting outdated cache file: /home/hannas/MyPyaerocom/_cache/hannas/GAWTADsubsetAasEtAl_wetso4.pkl
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
read func
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
uses new updated version, in that case fix conversion
includes new changes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Invalid var_name time for coord None in cube. Overwriting with time
Invalid long_name None for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_sftlf_Surface_2010_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_areacella_Surface_1750_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
Failed to import file aerocom3_CAM5-ATRAS_AP3-CTRL_orog_Surface_1850_fixed.nc
Model: CAM5-ATRAS_AP3-CTRL
Error: TemporalResolutionError(&#39;Invalid frequency fixed&#39;)
/home/hannas/Desktop/pyaerocom/pyaerocom/io/iris_io.py:415: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  freq=TS_TYPE_TO_PANDAS_FREQ[ts_type])
Invalid long_name time for coord time in cube. Overwriting with Time
Invalid long_name latitude for coord lat in cube. Overwriting with Center coordinates for latitudes
Invalid long_name longitude for coord lon in cube. Overwriting with Center coordinates for longitudes
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 80, 160). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
Setting wetso4 outlier lower lim: 0.00
Setting wetso4 outlier upper lim: 10000.00
Interpolating data of shape (12, 96, 144). This may take a while.
/home/hannas/anaconda3/lib/python3.7/site-packages/numpy/ma/core.py:3174: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  dout = self.data[indx]
/home/hannas/anaconda3/lib/python3.7/site-packages/iris/analysis/_scipy_interpolate.py:290: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.
  return self.values[idx_res]
Successfully interpolated cube
/home/hannas/Desktop/pyaerocom/pyaerocom/colocation.py:461: FutureWarning: Creating a DatetimeIndex by passing range endpoints is deprecated.  Use `pandas.date_range` instead.
  time_idx = pd.DatetimeIndex(freq=freq_pd, start=start, end=stop)
/home/hannas/anaconda3/lib/python3.7/site-packages/xarray/core/nanops.py:159: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
/home/hannas/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:32: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Not instance of multiindex.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[170]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f200c03dbd0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_262_5.png" src="../../../_images/pyaerocom-tutorials_obsolete_dev_intercomparison_AasEtAl_and_2010CTRL_262_5.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MET Norway

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>